<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/interview/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/interview/_next/static/css/387024c6a2216908.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/interview/_next/static/chunks/webpack-be7d7df45533bffc.js"/><script src="/interview/_next/static/chunks/fd9d1056-6922f449a204c2cc.js" async=""></script><script src="/interview/_next/static/chunks/117-e7ecc085ce9cfab3.js" async=""></script><script src="/interview/_next/static/chunks/main-app-b06be5f3411c20c3.js" async=""></script><script src="/interview/_next/static/chunks/918-3273b83890f10546.js" async=""></script><script src="/interview/_next/static/chunks/930-3262a6c9c5acace4.js" async=""></script><script src="/interview/_next/static/chunks/app/docs/%5B...slug%5D/page-32962e9542d32755.js" async=""></script><script src="/interview/_next/static/chunks/710-dfaa11b4dff08f8e.js" async=""></script><script src="/interview/_next/static/chunks/972-011bba60ed155615.js" async=""></script><script src="/interview/_next/static/chunks/233-3e0c1d820a17eca9.js" async=""></script><script src="/interview/_next/static/chunks/app/layout-333f4adcd11f8f39.js" async=""></script><title>Frontend Interview Prep 2025 - Big Tech Interview Guide</title><meta name="description" content="Comprehensive frontend interview preparation for Big Tech companies including React, TypeScript, algorithms, and system design."/><link rel="icon" href="/favicon.ico"/><meta name="theme-color" content="#1a1a1a"/><meta property="og:title" content="Frontend Interview Prep 2025"/><meta property="og:description" content="Complete guide for frontend engineers targeting Big Tech companies"/><meta property="og:type" content="website"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><title>README - Frontend Interview Docs</title><meta name="description" content="# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa"/><meta property="og:title" content="README - Frontend Interview Docs"/><meta property="og:description" content="# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="README - Frontend Interview Docs"/><meta name="twitter:description" content="# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa"/><meta name="next-size-adjust"/><script src="/interview/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script><style data-styled="" data-styled-version="6.1.19">*{margin:0;padding:0;box-sizing:border-box;}/*!sc*/
html{font-size:16px;line-height:1.5;scroll-behavior:smooth;}/*!sc*/
body{font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;font-size:1rem;line-height:1.5;color:#1e293b;background-color:#ffffff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
h1,h2,h3,h4,h5,h6{font-weight:700;line-height:1.25;margin-bottom:0.5em;}/*!sc*/
h1{font-size:3rem;}/*!sc*/
@media (max-width: 768px){h1{font-size:2.25rem;}}/*!sc*/
h2{font-size:2.25rem;}/*!sc*/
@media (max-width: 768px){h2{font-size:1.875rem;}}/*!sc*/
h3{font-size:1.875rem;}/*!sc*/
@media (max-width: 768px){h3{font-size:1.5rem;}}/*!sc*/
h4{font-size:1.5rem;}/*!sc*/
@media (max-width: 768px){h4{font-size:1.25rem;}}/*!sc*/
h5{font-size:1.25rem;}/*!sc*/
h6{font-size:1.125rem;}/*!sc*/
p{margin-bottom:1rem;line-height:1.75;}/*!sc*/
a{color:#3b82f6;text-decoration:none;transition:color 0.15s ease;}/*!sc*/
a:hover{color:#2563eb;}/*!sc*/
a:focus{outline:2px solid #3b82f6;outline-offset:2px;}/*!sc*/
button{cursor:pointer;border:none;background:none;font-family:inherit;font-size:inherit;}/*!sc*/
button:disabled{cursor:not-allowed;opacity:0.6;}/*!sc*/
button:focus{outline:2px solid #3b82f6;outline-offset:2px;}/*!sc*/
input,textarea,select{font-family:inherit;font-size:inherit;}/*!sc*/
input:focus,textarea:focus,select:focus{outline:2px solid #3b82f6;outline-offset:2px;}/*!sc*/
img{max-width:100%;height:auto;}/*!sc*/
ul,ol{margin-bottom:1rem;padding-left:1.5rem;}/*!sc*/
li{margin-bottom:0.25rem;}/*!sc*/
blockquote{margin:1rem 0;padding:1rem;border-left:4px solid #3b82f6;background-color:#f1f5f9;font-style:italic;}/*!sc*/
code{font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;font-size:0.9em;background-color:#f1f5f9;padding:0.2em 0.4em;border-radius:0.25rem;}/*!sc*/
pre{background-color:#f1f5f9;padding:1rem;border-radius:0.5rem;overflow-x:auto;margin-bottom:1rem;}/*!sc*/
pre code{background:none;padding:0;}/*!sc*/
table{width:100%;border-collapse:collapse;margin-bottom:1rem;}/*!sc*/
th,td{padding:0.75rem;text-align:left;border-bottom:1px solid #e2e8f0;}/*!sc*/
th{font-weight:600;background-color:#f1f5f9;}/*!sc*/
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0;}/*!sc*/
.skip-link{position:absolute;top:-40px;left:6px;background:#3b82f6;color:white;padding:8px;text-decoration:none;border-radius:4px;z-index:100;}/*!sc*/
.skip-link:focus{top:6px;}/*!sc*/
::-webkit-scrollbar{width:8px;height:8px;}/*!sc*/
::-webkit-scrollbar-track{background:#f1f5f9;}/*!sc*/
::-webkit-scrollbar-thumb{background:#94a3b8;border-radius:4px;}/*!sc*/
::-webkit-scrollbar-thumb:hover{background:#64748b;}/*!sc*/
::selection{background:#3b82f6;color:white;}/*!sc*/
.focus-visible{outline:2px solid #3b82f6;outline-offset:2px;}/*!sc*/
.fade-in{opacity:0;animation:fadeIn 0.3s ease forwards;}/*!sc*/
.slide-up{transform:translateY(20px);opacity:0;animation:slideUp 0.3s ease forwards;}/*!sc*/
@keyframes fadeIn{to{opacity:1;}}/*!sc*/
@keyframes slideUp{to{transform:translateY(0);opacity:1;}}/*!sc*/
@media print{*{background:white!important;color:black!important;box-shadow:none!important;text-shadow:none!important;}a,a:visited{text-decoration:underline;}h1,h2,h3,h4,h5,h6{break-after:avoid;}pre,blockquote{border:1px solid #999;break-inside:avoid;}img{max-width:100%!important;}@page{margin:0.5in;}}/*!sc*/
data-styled.g23[id="sc-global-kxA-Ddz1"]{content:"sc-global-kxA-Ddz1,"}/*!sc*/
.eKIJjO{position:fixed;top:0;width:100%;z-index:1020;background:transparent;backdrop-filter:blur(10px);border-bottom:1px solid transparent;transition:all 0.3s ease;}/*!sc*/
data-styled.g24[id="sc-jaXbil"]{content:"eKIJjO,"}/*!sc*/
.eixvq{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;align-items:center;justify-content:space-between;height:70px;}/*!sc*/
data-styled.g25[id="sc-eqNDNG"]{content:"eixvq,"}/*!sc*/
.hudwVZ{display:flex;align-items:center;gap:0.5rem;font-size:1.5rem;font-weight:700;color:#3b82f6;text-decoration:none;cursor:pointer;}/*!sc*/
.hudwVZ:hover{color:#2563eb;}/*!sc*/
data-styled.g26[id="sc-fVHBlr"]{content:"hudwVZ,"}/*!sc*/
.gHgjnR{display:flex;align-items:center;gap:2rem;}/*!sc*/
@media (max-width: 768px){.gHgjnR{display:none;}}/*!sc*/
data-styled.g27[id="sc-gLaqbQ"]{content:"gHgjnR,"}/*!sc*/
.ejYeRD{color:#1e293b;font-weight:500;text-decoration:none;transition:color 0.15s ease;position:relative;}/*!sc*/
.ejYeRD:hover{color:#3b82f6;}/*!sc*/
.ejYeRD:after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:2px;background:#3b82f6;transition:width 0.15s ease;}/*!sc*/
.ejYeRD:hover:after{width:100%;}/*!sc*/
data-styled.g28[id="sc-ipUnzB"]{content:"ejYeRD,"}/*!sc*/
.cwUwRf{display:none;background:none;border:none;color:#1e293b;cursor:pointer;padding:0.5rem;}/*!sc*/
@media (max-width: 768px){.cwUwRf{display:block;}}/*!sc*/
data-styled.g29[id="sc-eQwNpu"]{content:"cwUwRf,"}/*!sc*/
.eotevR{display:flex;align-items:center;gap:0.5rem;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:0.5rem;padding:0.5rem 1rem;color:#64748b;font-size:0.9rem;transition:all 0.15s ease;}/*!sc*/
.eotevR:hover{background:#ffffff;border-color:#3b82f6;}/*!sc*/
data-styled.g33[id="sc-eVqvcJ"]{content:"eotevR,"}/*!sc*/
.fXFPTj{background:#1e293b;color:white;padding:3rem 0 1rem;margin-top:auto;}/*!sc*/
data-styled.g34[id="sc-bbbBoY"]{content:"fXFPTj,"}/*!sc*/
.dWUTOl{max-width:1200px;margin:0 auto;padding:0 2rem;}/*!sc*/
data-styled.g35[id="sc-cdmAjP"]{content:"dWUTOl,"}/*!sc*/
.kWeZJe{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:2rem;margin-bottom:2rem;}/*!sc*/
@media (max-width: 768px){.kWeZJe{grid-template-columns:1fr 1fr;gap:1.5rem;}}/*!sc*/
@media (max-width: 480px){.kWeZJe{grid-template-columns:1fr;}}/*!sc*/
data-styled.g36[id="sc-jytpVa"]{content:"kWeZJe,"}/*!sc*/
.hlQQbN h3{font-size:1.1rem;font-weight:600;margin-bottom:1rem;color:white;}/*!sc*/
.hlQQbN ul{list-style:none;padding:0;margin:0;}/*!sc*/
.hlQQbN li{margin-bottom:0.5rem;}/*!sc*/
.hlQQbN a{color:rgba(255, 255, 255, 0.7);text-decoration:none;transition:color 0.15s ease;}/*!sc*/
.hlQQbN a:hover{color:white;}/*!sc*/
data-styled.g37[id="sc-eknHtZ"]{content:"hlQQbN,"}/*!sc*/
.eUEOfs{display:flex;align-items:center;gap:0.5rem;font-size:1.2rem;font-weight:700;margin-bottom:1rem;color:white;}/*!sc*/
data-styled.g38[id="sc-pYNGo"]{content:"eUEOfs,"}/*!sc*/
.FTAbj{color:rgba(255, 255, 255, 0.7);line-height:1.6;margin-bottom:1rem;}/*!sc*/
data-styled.g39[id="sc-cCVJLD"]{content:"FTAbj,"}/*!sc*/
.fjvVr{display:flex;gap:1rem;}/*!sc*/
.fjvVr a{display:flex;align-items:center;justify-content:center;width:40px;height:40px;background:rgba(255, 255, 255, 0.1);border-radius:0.5rem;color:rgba(255, 255, 255, 0.7);transition:all 0.15s ease;}/*!sc*/
.fjvVr a:hover{background:rgba(255, 255, 255, 0.2);color:white;}/*!sc*/
data-styled.g40[id="sc-jYczwO"]{content:"fjvVr,"}/*!sc*/
.jkOcpo{border-top:1px solid rgba(255, 255, 255, 0.1);padding-top:2rem;display:flex;justify-content:space-between;align-items:center;}/*!sc*/
@media (max-width: 768px){.jkOcpo{flex-direction:column;gap:1rem;text-align:center;}}/*!sc*/
data-styled.g41[id="sc-dNFkOE"]{content:"jkOcpo,"}/*!sc*/
.ficqwG{color:rgba(255, 255, 255, 0.7);margin:0;font-size:0.9rem;}/*!sc*/
data-styled.g42[id="sc-fszimp"]{content:"ficqwG,"}/*!sc*/
.cAqCWV{display:flex;gap:2rem;}/*!sc*/
@media (max-width: 480px){.cAqCWV{flex-direction:column;gap:1rem;}}/*!sc*/
.cAqCWV a{color:rgba(255, 255, 255, 0.7);text-decoration:none;font-size:0.9rem;transition:color 0.15s ease;}/*!sc*/
.cAqCWV a:hover{color:white;}/*!sc*/
data-styled.g43[id="sc-etsjJW"]{content:"cAqCWV,"}/*!sc*/
.dwkWyw{color:#1e293b;line-height:1.6;}/*!sc*/
.dwkWyw h1,.dwkWyw h2,.dwkWyw h3,.dwkWyw h4,.dwkWyw h5,.dwkWyw h6{color:#1e293b;margin-top:2rem;margin-bottom:1rem;font-weight:600;}/*!sc*/
.dwkWyw h1{font-size:2rem;border-bottom:2px solid #e2e8f0;padding-bottom:0.5rem;}/*!sc*/
.dwkWyw h2{font-size:1.5rem;border-bottom:1px solid #e2e8f0;padding-bottom:0.3rem;}/*!sc*/
.dwkWyw h3{font-size:1.25rem;}/*!sc*/
.dwkWyw h4{font-size:1.1rem;}/*!sc*/
.dwkWyw p{margin-bottom:1rem;color:#64748b;}/*!sc*/
.dwkWyw a{color:#3b82f6;text-decoration:none;}/*!sc*/
.dwkWyw a:hover{text-decoration:underline;}/*!sc*/
.dwkWyw ul,.dwkWyw ol{margin-bottom:1rem;padding-left:1.5rem;}/*!sc*/
.dwkWyw ul li,.dwkWyw ol li{margin-bottom:0.5rem;color:#64748b;}/*!sc*/
.dwkWyw blockquote{border-left:4px solid #3b82f6;padding-left:1rem;margin:1rem 0;font-style:italic;color:#64748b;background:#f1f5f9;padding:1rem;border-radius:0.5rem;}/*!sc*/
.dwkWyw code{background:#f1f5f9;padding:0.2rem 0.4rem;border-radius:0.25rem;font-family:SFMono-Regular,Consolas,"Liberation Mono",Menlo,monospace;font-size:0.9em;color:#f59e0b;}/*!sc*/
.dwkWyw pre{background:#ffffff;border:1px solid #e2e8f0;border-radius:0.5rem;padding:1rem;margin:1rem 0;overflow-x:auto;}/*!sc*/
.dwkWyw pre code{background:none;padding:0;color:#1e293b;font-size:0.9rem;}/*!sc*/
.dwkWyw table{width:100%;border-collapse:collapse;margin:1rem 0;}/*!sc*/
.dwkWyw table th,.dwkWyw table td{border:1px solid #e2e8f0;padding:0.5rem;text-align:left;}/*!sc*/
.dwkWyw table th{background:#ffffff;font-weight:600;}/*!sc*/
.dwkWyw table tr:nth-child(even){background:#f1f5f9;}/*!sc*/
.dwkWyw hr{border:none;height:1px;background:#e2e8f0;margin:2rem 0;}/*!sc*/
.dwkWyw .highlight{background:#3b82f620;padding:0.2rem 0.4rem;border-radius:0.25rem;font-weight:600;}/*!sc*/
.dwkWyw .hljs{background:#ffffff;color:#1e293b;}/*!sc*/
.dwkWyw .hljs-keyword{color:#3b82f6;font-weight:600;}/*!sc*/
.dwkWyw .hljs-string{color:#10b981;}/*!sc*/
.dwkWyw .hljs-function{color:#f59e0b;}/*!sc*/
.dwkWyw .hljs-comment{color:#94a3b8;font-style:italic;}/*!sc*/
.dwkWyw .hljs-number{color:#f59e0b;}/*!sc*/
.dwkWyw .hljs-variable{color:#1e293b;}/*!sc*/
.dwkWyw .hljs-title{color:#f59e0b;font-weight:600;}/*!sc*/
data-styled.g44[id="sc-fYmhhH"]{content:"dwkWyw,"}/*!sc*/
</style></head><body class="__className_6eac61"><div style="min-height:100vh;display:flex;flex-direction:column"><nav class="sc-jaXbil eKIJjO"><div class="sc-eqNDNG eixvq"><a href="/interview"><a class="sc-fVHBlr hudwVZ"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code "><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>Frontend Interview Prep</a></a><div class="sc-gLaqbQ gHgjnR"><a href="/interview/problems"><a class="sc-ipUnzB ejYeRD">Problems</a></a><a href="/interview/learn"><a class="sc-ipUnzB ejYeRD">Learn</a></a><a href="/interview/study-guide"><a class="sc-ipUnzB ejYeRD">Study Guide</a></a><a href="/interview/system-design"><a class="sc-ipUnzB ejYeRD">System Design</a></a><a href="/interview/performance"><a class="sc-ipUnzB ejYeRD">Performance</a></a><a href="/interview/accessibility"><a class="sc-ipUnzB ejYeRD">Accessibility</a></a><a href="/interview/interview-tips"><a class="sc-ipUnzB ejYeRD">Interview Tips</a></a><button class="sc-eVqvcJ eotevR"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search "><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>Search</button></div><button class="sc-eQwNpu cwUwRf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu "><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></nav><main style="flex:1"><div style="max-width:1200px;margin:0 auto;padding:2rem;padding-top:6rem"><div style="margin-bottom:2rem"><nav style="color:#64748b;font-size:0.9rem;margin-bottom:1rem"><a href="/" style="color:#3b82f6;text-decoration:none">Home</a> &gt; <span>src &gt; content &gt; frontend &gt; security &gt; README</span></nav><h1 style="font-size:2.5rem;font-weight:800;margin-bottom:0.5rem;color:#1e293b">README</h1><div style="color:#64748b;font-size:0.9rem;margin-bottom:2rem"><span>📁 <!-- -->src/content/frontend/security/README.md</span></div></div><div class="sc-fYmhhH dwkWyw"><h1 id="security-interview-preparation" node="[object Object]">Security Interview Preparation</h1>
<h2 id="core-concepts" node="[object Object]">Core Concepts</h2>
<h3 id="frontend-security-fundamentals" node="[object Object]">Frontend Security Fundamentals</h3>
<ul>
<li><strong>Cross-Site Scripting (XSS)</strong>: Malicious scripts injected into web pages</li>
<li><strong>Cross-Site Request Forgery (CSRF)</strong>: Unauthorized actions performed on behalf of users</li>
<li><strong>Content Security Policy (CSP)</strong>: Security headers to prevent code injection</li>
<li><strong>Same-Origin Policy</strong>: Browser security mechanism for isolating resources</li>
<li><strong>Authentication &amp; Authorization</strong>: User identity verification and access control</li>
</ul>
<h3 id="security-headers" node="[object Object]">Security Headers</h3>
<ul>
<li><strong>Content-Security-Policy</strong>: Controls resource loading</li>
<li><strong>X-Frame-Options</strong>: Prevents clickjacking attacks</li>
<li><strong>X-Content-Type-Options</strong>: Prevents MIME type sniffing</li>
<li><strong>Strict-Transport-Security</strong>: Enforces HTTPS connections</li>
<li><strong>Referrer-Policy</strong>: Controls referrer information</li>
</ul>
<h2 id="advanced-topics" node="[object Object]">Advanced Topics</h2>
<h3 id="modern-security-features" node="[object Object]">Modern Security Features</h3>
<ul>
<li><strong>Subresource Integrity (SRI)</strong>: Verifies external resource integrity</li>
<li><strong>Trusted Types</strong>: Prevents DOM-based XSS</li>
<li><strong>Feature Policy</strong>: Controls browser feature usage</li>
<li><strong>Web Crypto API</strong>: Client-side cryptography</li>
<li><strong>Service Worker Security</strong>: Secure offline functionality</li>
</ul>
<h3 id="security-testing" node="[object Object]">Security Testing</h3>
<ul>
<li><strong>Static Analysis</strong>: Code scanning for vulnerabilities</li>
<li><strong>Dynamic Analysis</strong>: Runtime security testing</li>
<li><strong>Penetration Testing</strong>: Manual security assessment</li>
<li><strong>Security Headers Testing</strong>: CSP and header validation</li>
<li><strong>Dependency Scanning</strong>: Third-party vulnerability detection</li>
</ul>
<h2 id="common-interview-questions-&amp;-answers" node="[object Object]">Common Interview Questions &amp; Answers</h2>
<h3 id="security-questions" node="[object Object]">Security Questions</h3>
<p><strong>Q: What is XSS and how do you prevent it?</strong>
A: XSS (Cross-Site Scripting) allows attackers to inject malicious scripts into web pages.</p>
<p><strong>Types of XSS:</strong></p>
<ul>
<li><strong>Stored XSS</strong>: Malicious script stored in database</li>
<li><strong>Reflected XSS</strong>: Malicious script reflected in response</li>
<li><strong>DOM-based XSS</strong>: Malicious script manipulating DOM</li>
</ul>
<p><strong>Prevention Techniques:</strong></p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-comment">// 1. Input validation and sanitization</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sanitizeInput</span>(<span class="hljs-params">input</span>) {
  <span class="hljs-keyword">return</span> input
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">&#x27;&amp;amp;&#x27;</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">&#x27;&amp;lt;&#x27;</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">&#x27;&amp;gt;&#x27;</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&quot;/g</span>, <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>)
    .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&#x27;/g</span>, <span class="hljs-string">&#x27;&amp;#x27;&#x27;</span>);
}

<span class="hljs-comment">// 2. Use safe DOM methods</span>
<span class="hljs-comment">// ❌ Dangerous</span>
element.<span class="hljs-property">innerHTML</span> = userInput;

<span class="hljs-comment">// ✅ Safe</span>
element.<span class="hljs-property">textContent</span> = userInput;

<span class="hljs-comment">// 3. Use React&#x27;s built-in XSS protection</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">SafeComponent</span>(<span class="hljs-params">{ userInput }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{userInput}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>; <span class="hljs-comment">// React automatically escapes</span>
}

<span class="hljs-comment">// 4. Content Security Policy</span>
<span class="hljs-comment">// Add to HTML head</span>
&lt;meta http-equiv=<span class="hljs-string">&quot;Content-Security-Policy&quot;</span>
      content=<span class="hljs-string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;&quot;</span>&gt;
</code></pre></pre>
<p><strong>Q: What is CSRF and how do you prevent it?</strong>
A: CSRF (Cross-Site Request Forgery) tricks users into performing unwanted actions.</p>
<p><strong>Prevention Techniques:</strong></p>
<p>{% raw %}</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-comment">// 1. CSRF Tokens</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CSRFProtection</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateToken</span>();
  }

  <span class="hljs-title function_">generateToken</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> crypto
      .<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">32</span>))
      .<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>), <span class="hljs-string">&quot;&quot;</span>);
  }

  <span class="hljs-title function_">addTokenToRequest</span>(<span class="hljs-params">request</span>) {
    request.<span class="hljs-property">headers</span>[<span class="hljs-string">&quot;X-CSRF-Token&quot;</span>] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>;
    <span class="hljs-keyword">return</span> request;
  }

  <span class="hljs-title function_">validateToken</span>(<span class="hljs-params">token</span>) {
    <span class="hljs-keyword">return</span> token === <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>;
  }
}

<span class="hljs-comment">// 2. SameSite Cookies</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = <span class="hljs-string">&quot;sessionId=abc123; SameSite=Strict; Secure; HttpOnly&quot;</span>;

<span class="hljs-comment">// 3. Double Submit Cookie Pattern</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DoubleSubmitCookie</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateToken</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setCookie</span>();
  }

  <span class="hljs-title function_">setCookie</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = <span class="hljs-string">`csrf-token=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.token}</span>; SameSite=Strict; Secure`</span>;
  }

  <span class="hljs-title function_">addTokenToForm</span>(<span class="hljs-params">form</span>) {
    <span class="hljs-keyword">const</span> tokenInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;input&quot;</span>);
    tokenInput.<span class="hljs-property">type</span> = <span class="hljs-string">&quot;hidden&quot;</span>;
    tokenInput.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;csrf-token&quot;</span>;
    tokenInput.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>;
    form.<span class="hljs-title function_">appendChild</span>(tokenInput);
  }
}

<span class="hljs-comment">// 4. Custom Headers</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/api/update&quot;</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
    <span class="hljs-string">&quot;X-CSRF-Token&quot;</span>: csrfToken,
    <span class="hljs-string">&quot;X-Requested-With&quot;</span>: <span class="hljs-string">&quot;XMLHttpRequest&quot;</span>,
  },
  <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data),
});
</code></pre></pre>
<p>{% endraw %}</p>
<p><strong>Q: How do you implement Content Security Policy?</strong>
A: CSP is a security header that controls which resources can be loaded.</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-comment">// 1. Basic CSP Implementation</span>
<span class="hljs-keyword">const</span> cspHeader = {
  <span class="hljs-string">&quot;default-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
  <span class="hljs-string">&quot;script-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;&#x27;unsafe-inline&#x27;&quot;</span>, <span class="hljs-string">&quot;https://cdn.example.com&quot;</span>],
  <span class="hljs-string">&quot;style-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;&#x27;unsafe-inline&#x27;&quot;</span>, <span class="hljs-string">&quot;https://fonts.googleapis.com&quot;</span>],
  <span class="hljs-string">&quot;img-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;data:&quot;</span>, <span class="hljs-string">&quot;https:&quot;</span>],
  <span class="hljs-string">&quot;font-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;https://fonts.gstatic.com&quot;</span>],
  <span class="hljs-string">&quot;connect-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;https://api.example.com&quot;</span>],
  <span class="hljs-string">&quot;frame-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;none&#x27;&quot;</span>],
  <span class="hljs-string">&quot;object-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;none&#x27;&quot;</span>],
  <span class="hljs-string">&quot;base-uri&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
  <span class="hljs-string">&quot;form-action&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
};

<span class="hljs-comment">// 2. Dynamic CSP for different pages</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CSPManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">basePolicy</span> = {
      <span class="hljs-string">&quot;default-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
      <span class="hljs-string">&quot;script-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
      <span class="hljs-string">&quot;style-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
      <span class="hljs-string">&quot;img-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, <span class="hljs-string">&quot;data:&quot;</span>],
      <span class="hljs-string">&quot;connect-src&quot;</span>: [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>],
    };
  }

  <span class="hljs-title function_">addPolicy</span>(<span class="hljs-params">page, additionalRules</span>) {
    <span class="hljs-keyword">const</span> policy = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">basePolicy</span> };

    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(additionalRules).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (policy[key]) {
        policy[key] = [...policy[key], ...additionalRules[key]];
      } <span class="hljs-keyword">else</span> {
        policy[key] = additionalRules[key];
      }
    });

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stringifyPolicy</span>(policy);
  }

  <span class="hljs-title function_">stringifyPolicy</span>(<span class="hljs-params">policy</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(policy)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[key, values]</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${key}</span> <span class="hljs-subst">${values.join(<span class="hljs-string">&quot; &quot;</span>)}</span>`</span>)
      .<span class="hljs-title function_">join</span>(<span class="hljs-string">&quot;; &quot;</span>);
  }

  <span class="hljs-comment">// 3. Nonce-based CSP</span>
  <span class="hljs-title function_">generateNonce</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> crypto
      .<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">16</span>))
      .<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>), <span class="hljs-string">&quot;&quot;</span>);
  }

  <span class="hljs-title function_">addNonceToScript</span>(<span class="hljs-params">nonce</span>) {
    <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;script&quot;</span>);
    script.<span class="hljs-property">nonce</span> = nonce;
    script.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;console.log(&quot;Safe script&quot;);&#x27;</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
  }
}

<span class="hljs-comment">// 4. Hash-based CSP</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HashCSP</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hashes</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  }

  <span class="hljs-title function_">addScriptHash</span>(<span class="hljs-params">scriptContent</span>) {
    <span class="hljs-keyword">const</span> hash = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateHash</span>(scriptContent);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hashes</span>.<span class="hljs-title function_">add</span>(hash);
    <span class="hljs-keyword">return</span> hash;
  }

  <span class="hljs-title function_">generateHash</span>(<span class="hljs-params">content</span>) {
    <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
    <span class="hljs-keyword">const</span> data = encoder.<span class="hljs-title function_">encode</span>(content);
    <span class="hljs-keyword">return</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">digest</span>(<span class="hljs-string">&quot;SHA-256&quot;</span>, data).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">hash</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> hashArray = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(hash));
      <span class="hljs-keyword">return</span> <span class="hljs-string">`&#x27;sha256-<span class="hljs-subst">${btoa(<span class="hljs-built_in">String</span>.fromCharCode(...hashArray))}</span>&#x27;`</span>;
    });
  }

  <span class="hljs-title function_">getPolicy</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> scriptSrc = [<span class="hljs-string">&quot;&#x27;self&#x27;&quot;</span>, ...<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">hashes</span>)];
    <span class="hljs-keyword">return</span> <span class="hljs-string">`script-src <span class="hljs-subst">${scriptSrc.join(<span class="hljs-string">&quot; &quot;</span>)}</span>`</span>;
  }
}
</code></pre></pre>
<h2 id="advanced-interview-questions" node="[object Object]">Advanced Interview Questions</h2>
<p><strong>Q: How would you implement secure authentication in a frontend application?</strong>
A: Comprehensive authentication security implementation:</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureAuthManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenKey</span> = <span class="hljs-string">&#x27;auth_token&#x27;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTokenKey</span> = <span class="hljs-string">&#x27;refresh_token&#x27;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenExpiryKey</span> = <span class="hljs-string">&#x27;token_expiry&#x27;</span>;
  }

  <span class="hljs-comment">// 1. Secure token storage</span>
  <span class="hljs-title function_">storeTokens</span>(<span class="hljs-params">accessToken, refreshToken, expiresIn</span>) {
    <span class="hljs-keyword">const</span> expiryTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + (expiresIn * <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Store in memory for sensitive operations</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span> = accessToken;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span> = refreshToken;

    <span class="hljs-comment">// Store refresh token in httpOnly cookie (server-side)</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setHttpOnlyCookie</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTokenKey</span>, refreshToken);

    <span class="hljs-comment">// Store expiry time in localStorage</span>
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenExpiryKey</span>, expiryTime.<span class="hljs-title function_">toString</span>());
  }

  <span class="hljs-comment">// 2. Token validation</span>
  <span class="hljs-title function_">isTokenValid</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> expiryTime = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenExpiryKey</span>);
    <span class="hljs-keyword">if</span> (!expiryTime) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &lt; <span class="hljs-built_in">parseInt</span>(expiryTime);
  }

  <span class="hljs-comment">// 3. Automatic token refresh</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">refreshTokenIfNeeded</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isTokenValid</span>() &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/auth/refresh&#x27;</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,
          <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,
            <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.refreshToken}</span>`</span>
          }
        });

        <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
          <span class="hljs-keyword">const</span> { accessToken, expiresIn } = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">storeTokens</span>(accessToken, <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span>, expiresIn);
          <span class="hljs-keyword">return</span> accessToken;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">logout</span>();
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Token refresh failed&#x27;</span>);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">logout</span>();
        <span class="hljs-keyword">throw</span> error;
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span>;
  }

  <span class="hljs-comment">// 4. Secure logout</span>
  <span class="hljs-title function_">logout</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenExpiryKey</span>);

    <span class="hljs-comment">// Clear httpOnly cookie</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clearHttpOnlyCookie</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshTokenKey</span>);

    <span class="hljs-comment">// Redirect to login</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;/login&#x27;</span>;
  }

  <span class="hljs-comment">// 5. Secure API requests</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">makeSecureRequest</span>(<span class="hljs-params">url, options = {}</span>) {
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshTokenIfNeeded</span>();

    <span class="hljs-keyword">const</span> secureOptions = {
      ...options,
      <span class="hljs-attr">headers</span>: {
        ...options.<span class="hljs-property">headers</span>,
        <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>,
        <span class="hljs-string">&#x27;X-Requested-With&#x27;</span>: <span class="hljs-string">&#x27;XMLHttpRequest&#x27;</span>
      }
    };

    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, secureOptions);

    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">401</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">logout</span>();
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Unauthorized&#x27;</span>);
    }

    <span class="hljs-keyword">return</span> response;
  }

  <span class="hljs-comment">// 6. Password strength validation</span>
  <span class="hljs-title function_">validatePassword</span>(<span class="hljs-params">password</span>) {
    <span class="hljs-keyword">const</span> requirements = {
      <span class="hljs-attr">minLength</span>: <span class="hljs-number">8</span>,
      <span class="hljs-attr">hasUpperCase</span>: <span class="hljs-regexp">/[A-Z]/</span>,
      <span class="hljs-attr">hasLowerCase</span>: <span class="hljs-regexp">/[a-z]/</span>,
      <span class="hljs-attr">hasNumbers</span>: <span class="hljs-regexp">/\d/</span>,
      <span class="hljs-attr">hasSpecialChar</span>: <span class="hljs-regexp">/[!@#$%^&amp;*(),.?&quot;:{}|&lt;&gt;]/</span>
    };

    <span class="hljs-keyword">const</span> errors = [];

    <span class="hljs-keyword">if</span> (password.<span class="hljs-property">length</span> &lt; requirements.<span class="hljs-property">minLength</span>) {
      errors.<span class="hljs-title function_">push</span>(<span class="hljs-string">`Password must be at least <span class="hljs-subst">${requirements.minLength}</span> characters`</span>);
    }

    <span class="hljs-keyword">if</span> (!requirements.<span class="hljs-property">hasUpperCase</span>.<span class="hljs-title function_">test</span>(password)) {
      errors.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;Password must contain at least one uppercase letter&#x27;</span>);
    }

    <span class="hljs-keyword">if</span> (!requirements.<span class="hljs-property">hasLowerCase</span>.<span class="hljs-title function_">test</span>(password)) {
      errors.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;Password must contain at least one lowercase letter&#x27;</span>);
    }

    <span class="hljs-keyword">if</span> (!requirements.<span class="hljs-property">hasNumbers</span>.<span class="hljs-title function_">test</span>(password)) {
      errors.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;Password must contain at least one number&#x27;</span>);
    }

    <span class="hljs-keyword">if</span> (!requirements.<span class="hljs-property">hasSpecialChar</span>.<span class="hljs-title function_">test</span>(password)) {
      errors.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;Password must contain at least one special character&#x27;</span>);
    }

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">isValid</span>: errors.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>,
      errors
    };
  }

  <span class="hljs-comment">// 7. Rate limiting for login attempts</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxAttempts</span> = <span class="hljs-number">5</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lockoutDuration</span> = <span class="hljs-number">15</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 15 minutes</span>
  }

  <span class="hljs-title function_">checkLoginAttempts</span>(<span class="hljs-params">email</span>) {
    <span class="hljs-keyword">const</span> attempts = <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span>.<span class="hljs-title function_">get</span>(email) || { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">lastAttempt</span>: <span class="hljs-number">0</span> };

    <span class="hljs-keyword">if</span> (attempts.<span class="hljs-property">count</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxAttempts</span>) {
      <span class="hljs-keyword">const</span> timeSinceLastAttempt = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - attempts.<span class="hljs-property">lastAttempt</span>;

      <span class="hljs-keyword">if</span> (timeSinceLastAttempt &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">lockoutDuration</span>) {
        <span class="hljs-keyword">const</span> remainingTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>((<span class="hljs-variable language_">this</span>.<span class="hljs-property">lockoutDuration</span> - timeSinceLastAttempt) / <span class="hljs-number">1000</span> / <span class="hljs-number">60</span>);
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Account temporarily locked. Try again in <span class="hljs-subst">${remainingTime}</span> minutes.`</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Reset attempts after lockout period</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span>.<span class="hljs-title function_">delete</span>(email);
      }
    }
  }

  <span class="hljs-title function_">recordLoginAttempt</span>(<span class="hljs-params">email, success</span>) {
    <span class="hljs-keyword">const</span> attempts = <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span>.<span class="hljs-title function_">get</span>(email) || { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">lastAttempt</span>: <span class="hljs-number">0</span> };

    <span class="hljs-keyword">if</span> (success) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span>.<span class="hljs-title function_">delete</span>(email);
    } <span class="hljs-keyword">else</span> {
      attempts.<span class="hljs-property">count</span>++;
      attempts.<span class="hljs-property">lastAttempt</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loginAttempts</span>.<span class="hljs-title function_">set</span>(email, attempts);
    }
  }
}
</code></pre></pre>
<p><strong>Q: How do you implement secure file uploads?</strong>
A: Secure file upload implementation with validation and scanning:</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureFileUpload</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">allowedTypes</span> = [
      <span class="hljs-string">&quot;image/jpeg&quot;</span>,
      <span class="hljs-string">&quot;image/png&quot;</span>,
      <span class="hljs-string">&quot;image/gif&quot;</span>,
      <span class="hljs-string">&quot;application/pdf&quot;</span>,
    ];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxFileSize</span> = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 5MB</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxFiles</span> = <span class="hljs-number">10</span>;
  }

  <span class="hljs-comment">// 1. File type validation</span>
  <span class="hljs-title function_">validateFileType</span>(<span class="hljs-params">file</span>) {
    <span class="hljs-comment">// Check MIME type</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">allowedTypes</span>.<span class="hljs-title function_">includes</span>(file.<span class="hljs-property">type</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;File type not allowed&quot;</span>);
    }

    <span class="hljs-comment">// Check file extension</span>
    <span class="hljs-keyword">const</span> extension = file.<span class="hljs-property">name</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;.&quot;</span>).<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">toLowerCase</span>();
    <span class="hljs-keyword">const</span> allowedExtensions = [<span class="hljs-string">&quot;jpg&quot;</span>, <span class="hljs-string">&quot;jpeg&quot;</span>, <span class="hljs-string">&quot;png&quot;</span>, <span class="hljs-string">&quot;gif&quot;</span>, <span class="hljs-string">&quot;pdf&quot;</span>];

    <span class="hljs-keyword">if</span> (!allowedExtensions.<span class="hljs-title function_">includes</span>(extension)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;File extension not allowed&quot;</span>);
    }

    <span class="hljs-comment">// Check file signature (magic numbers)</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkFileSignature</span>(file);
  }

  <span class="hljs-comment">// 2. File signature validation</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">checkFileSignature</span>(<span class="hljs-params">file</span>) {
    <span class="hljs-keyword">const</span> signatures = {
      <span class="hljs-string">&quot;image/jpeg&quot;</span>: [<span class="hljs-number">0xff</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xff</span>],
      <span class="hljs-string">&quot;image/png&quot;</span>: [<span class="hljs-number">0x89</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x47</span>],
      <span class="hljs-string">&quot;image/gif&quot;</span>: [<span class="hljs-number">0x47</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>],
      <span class="hljs-string">&quot;application/pdf&quot;</span>: [<span class="hljs-number">0x25</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>],
    };

    <span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-keyword">const</span> bytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
    <span class="hljs-keyword">const</span> expectedSignature = signatures[file.<span class="hljs-property">type</span>];

    <span class="hljs-keyword">if</span> (expectedSignature) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; expectedSignature.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">if</span> (bytes[i] !== expectedSignature[i]) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Invalid file signature&quot;</span>);
        }
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-comment">// 3. File size validation</span>
  <span class="hljs-title function_">validateFileSize</span>(<span class="hljs-params">file</span>) {
    <span class="hljs-keyword">if</span> (file.<span class="hljs-property">size</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxFileSize</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
        <span class="hljs-string">`File size exceeds <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.maxFileSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>}</span>MB limit`</span>
      );
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-comment">// 4. Image processing and sanitization</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processImage</span>(<span class="hljs-params">file</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;canvas&quot;</span>);
      <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();

      img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// Resize image if too large</span>
        <span class="hljs-keyword">const</span> maxWidth = <span class="hljs-number">1920</span>;
        <span class="hljs-keyword">const</span> maxHeight = <span class="hljs-number">1080</span>;

        <span class="hljs-keyword">let</span> { width, height } = img;

        <span class="hljs-keyword">if</span> (width &gt; maxWidth || height &gt; maxHeight) {
          <span class="hljs-keyword">const</span> ratio = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(maxWidth / width, maxHeight / height);
          width *= ratio;
          height *= ratio;
        }

        canvas.<span class="hljs-property">width</span> = width;
        canvas.<span class="hljs-property">height</span> = height;

        <span class="hljs-comment">// Draw image to canvas (removes any embedded scripts)</span>
        ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);

        <span class="hljs-comment">// Convert to blob</span>
        canvas.<span class="hljs-title function_">toBlob</span>(resolve, <span class="hljs-string">&quot;image/jpeg&quot;</span>, <span class="hljs-number">0.8</span>);
      };

      img.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Invalid image file&quot;</span>));
      img.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(file);
    });
  }

  <span class="hljs-comment">// 5. Secure upload with progress</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">uploadFile</span>(<span class="hljs-params">file, onProgress</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validate file</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateFileType</span>(file);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateFileSize</span>(file);

      <span class="hljs-comment">// Process file if it&#x27;s an image</span>
      <span class="hljs-keyword">let</span> processedFile = file;
      <span class="hljs-keyword">if</span> (file.<span class="hljs-property">type</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;image/&quot;</span>)) {
        processedFile = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processImage</span>(file);
      }

      <span class="hljs-comment">// Generate secure filename</span>
      <span class="hljs-keyword">const</span> secureFilename = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateSecureFilename</span>(file.<span class="hljs-property">name</span>);

      <span class="hljs-comment">// Create FormData</span>
      <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&quot;file&quot;</span>, processedFile, secureFilename);
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">&quot;timestamp&quot;</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>());

      <span class="hljs-comment">// Upload with progress</span>
      <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        xhr.<span class="hljs-property">upload</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;progress&quot;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (event.<span class="hljs-property">lengthComputable</span>) {
            <span class="hljs-keyword">const</span> progress = (event.<span class="hljs-property">loaded</span> / event.<span class="hljs-property">total</span>) * <span class="hljs-number">100</span>;
            onProgress?.(progress);
          }
        });

        xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>));
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Upload failed&quot;</span>));
          }
        });

        xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Upload failed&quot;</span>));
        });

        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;/api/upload&quot;</span>);
        xhr.<span class="hljs-title function_">send</span>(formData);
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-comment">// 6. Generate secure filename</span>
  <span class="hljs-title function_">generateSecureFilename</span>(<span class="hljs-params">originalName</span>) {
    <span class="hljs-keyword">const</span> extension = originalName.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;.&quot;</span>).<span class="hljs-title function_">pop</span>();
    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> randomString = crypto
      .<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">8</span>))
      .<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>), <span class="hljs-string">&quot;&quot;</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${timestamp}</span>_<span class="hljs-subst">${randomString}</span>.<span class="hljs-subst">${extension}</span>`</span>;
  }

  <span class="hljs-comment">// 7. Multiple file upload with validation</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">uploadMultipleFiles</span>(<span class="hljs-params">files, onProgress</span>) {
    <span class="hljs-keyword">const</span> validFiles = [];
    <span class="hljs-keyword">const</span> errors = [];

    <span class="hljs-comment">// Validate all files first</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateFileType</span>(files[i]);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateFileSize</span>(files[i]);
        validFiles.<span class="hljs-title function_">push</span>(files[i]);
      } <span class="hljs-keyword">catch</span> (error) {
        errors.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">file</span>: files[i].<span class="hljs-property">name</span>, <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> });
      }
    }

    <span class="hljs-keyword">if</span> (validFiles.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;No valid files to upload&quot;</span>);
    }

    <span class="hljs-comment">// Upload valid files</span>
    <span class="hljs-keyword">const</span> uploadPromises = validFiles.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">file, index</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">uploadFile</span>(file, <span class="hljs-function">(<span class="hljs-params">progress</span>) =&gt;</span> {
        onProgress?.(index, progress);
      });
    });

    <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>(uploadPromises);

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">successful</span>: results
        .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-string">&quot;fulfilled&quot;</span>)
        .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.<span class="hljs-property">value</span>),
      <span class="hljs-attr">failed</span>: results
        .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-string">&quot;rejected&quot;</span>)
        .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.<span class="hljs-property">reason</span>),
      <span class="hljs-attr">validationErrors</span>: errors,
    };
  }
}
</code></pre></pre>
<h2 id="practical-problems-&amp;-solutions" node="[object Object]">Practical Problems &amp; Solutions</h2>
<h3 id="problem-1:-implement-secure-session-management" node="[object Object]">Problem 1: Implement Secure Session Management</h3>
<p><strong>Challenge</strong>: Create a secure session management system with automatic cleanup and security features.</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureSessionManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessionTimeout</span> = <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 30 minutes</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSessionsPerUser</span> = <span class="hljs-number">5</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cleanupInterval</span> = <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 5 minutes</span>

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startCleanupTimer</span>();
  }

  <span class="hljs-title function_">createSession</span>(<span class="hljs-params">userId, userAgent, ipAddress</span>) {
    <span class="hljs-comment">// Check existing sessions for user</span>
    <span class="hljs-keyword">const</span> userSessions = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserSessions</span>(userId);

    <span class="hljs-keyword">if</span> (userSessions.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSessionsPerUser</span>) {
      <span class="hljs-comment">// Remove oldest session</span>
      <span class="hljs-keyword">const</span> oldestSession = userSessions.<span class="hljs-title function_">sort</span>(
        <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">createdAt</span> - b.<span class="hljs-property">createdAt</span>
      )[<span class="hljs-number">0</span>];
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeSession</span>(oldestSession.<span class="hljs-property">id</span>);
    }

    <span class="hljs-keyword">const</span> session = {
      <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateSessionId</span>(),
      userId,
      userAgent,
      ipAddress,
      <span class="hljs-attr">createdAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">lastActivity</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span>,
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">set</span>(session.<span class="hljs-property">id</span>, session);
    <span class="hljs-keyword">return</span> session;
  }

  <span class="hljs-title function_">validateSession</span>(<span class="hljs-params">sessionId, userAgent, ipAddress</span>) {
    <span class="hljs-keyword">const</span> session = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">get</span>(sessionId);

    <span class="hljs-keyword">if</span> (!session || !session.<span class="hljs-property">isActive</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// Check session timeout</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - session.<span class="hljs-property">lastActivity</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessionTimeout</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeSession</span>(sessionId);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// Check for suspicious activity</span>
    <span class="hljs-keyword">if</span> (session.<span class="hljs-property">userAgent</span> !== userAgent || session.<span class="hljs-property">ipAddress</span> !== ipAddress) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flagSuspiciousActivity</span>(session);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// Update last activity</span>
    session.<span class="hljs-property">lastActivity</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-title function_">removeSession</span>(<span class="hljs-params">sessionId</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">delete</span>(sessionId);
  }

  <span class="hljs-title function_">getUserSessions</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">values</span>()).<span class="hljs-title function_">filter</span>(
      <span class="hljs-function">(<span class="hljs-params">session</span>) =&gt;</span> session.<span class="hljs-property">userId</span> === userId
    );
  }

  <span class="hljs-title function_">generateSessionId</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> crypto
      .<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">32</span>))
      .<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;0&quot;</span>), <span class="hljs-string">&quot;&quot;</span>);
  }

  <span class="hljs-title function_">flagSuspiciousActivity</span>(<span class="hljs-params">session</span>) {
    session.<span class="hljs-property">isActive</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// Log suspicious activity</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&quot;Suspicious session activity detected:&quot;</span>, session);
  }

  <span class="hljs-title function_">startCleanupTimer</span>(<span class="hljs-params"></span>) {
    <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupExpiredSessions</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">cleanupInterval</span>);
  }

  <span class="hljs-title function_">cleanupExpiredSessions</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [sessionId, session] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">entries</span>()) {
      <span class="hljs-keyword">if</span> (now - session.<span class="hljs-property">lastActivity</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessionTimeout</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeSession</span>(sessionId);
      }
    }
  }

  <span class="hljs-title function_">getSessionStats</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> totalSessions = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-property">size</span>;
    <span class="hljs-keyword">const</span> activeSessions = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">values</span>()).<span class="hljs-title function_">filter</span>(
      <span class="hljs-function">(<span class="hljs-params">session</span>) =&gt;</span> session.<span class="hljs-property">isActive</span>
    ).<span class="hljs-property">length</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">total</span>: totalSessions,
      <span class="hljs-attr">active</span>: activeSessions,
      <span class="hljs-attr">expired</span>: totalSessions - activeSessions,
    };
  }
}
</code></pre></pre>
<h3 id="problem-2:-implement-secure-data-encryption" node="[object Object]">Problem 2: Implement Secure Data Encryption</h3>
<p><strong>Challenge</strong>: Create a client-side encryption system for sensitive data.</p>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecureDataEncryption</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">algorithm</span> = <span class="hljs-string">&quot;AES-GCM&quot;</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyLength</span> = <span class="hljs-number">256</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">generateKey</span>(<span class="hljs-params">password, salt</span>) {
    <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
    <span class="hljs-keyword">const</span> keyMaterial = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">importKey</span>(
      <span class="hljs-string">&quot;raw&quot;</span>,
      encoder.<span class="hljs-title function_">encode</span>(password),
      <span class="hljs-string">&quot;PBKDF2&quot;</span>,
      <span class="hljs-literal">false</span>,
      [<span class="hljs-string">&quot;deriveBits&quot;</span>, <span class="hljs-string">&quot;deriveKey&quot;</span>]
    );

    <span class="hljs-keyword">return</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">deriveKey</span>(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;PBKDF2&quot;</span>,
        <span class="hljs-attr">salt</span>: encoder.<span class="hljs-title function_">encode</span>(salt),
        <span class="hljs-attr">iterations</span>: <span class="hljs-number">100000</span>,
        <span class="hljs-attr">hash</span>: <span class="hljs-string">&quot;SHA-256&quot;</span>,
      },
      keyMaterial,
      { <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">algorithm</span>, <span class="hljs-attr">length</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">keyLength</span> },
      <span class="hljs-literal">false</span>,
      [<span class="hljs-string">&quot;encrypt&quot;</span>, <span class="hljs-string">&quot;decrypt&quot;</span>]
    );
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">data, password</span>) {
    <span class="hljs-keyword">const</span> salt = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">16</span>));
    <span class="hljs-keyword">const</span> iv = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">12</span>));

    <span class="hljs-keyword">const</span> key = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(password, salt);
    <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
    <span class="hljs-keyword">const</span> encodedData = encoder.<span class="hljs-title function_">encode</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));

    <span class="hljs-keyword">const</span> encryptedData = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">encrypt</span>(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">algorithm</span>,
        <span class="hljs-attr">iv</span>: iv,
      },
      key,
      encodedData
    );

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">data</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(encryptedData)),
      <span class="hljs-attr">salt</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(salt),
      <span class="hljs-attr">iv</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iv),
    };
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">encryptedData, password</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(password, encryptedData.<span class="hljs-property">salt</span>);

    <span class="hljs-keyword">const</span> decryptedData = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">decrypt</span>(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">algorithm</span>,
        <span class="hljs-attr">iv</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(encryptedData.<span class="hljs-property">iv</span>),
      },
      key,
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(encryptedData.<span class="hljs-property">data</span>)
    );

    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(decoder.<span class="hljs-title function_">decode</span>(decryptedData));
  }

  <span class="hljs-comment">// Secure storage with encryption</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">secureStore</span>(<span class="hljs-params">key, data, password</span>) {
    <span class="hljs-keyword">const</span> encrypted = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">encrypt</span>(data, password);
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(encrypted));
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">secureRetrieve</span>(<span class="hljs-params">key, password</span>) {
    <span class="hljs-keyword">const</span> encrypted = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key));
    <span class="hljs-keyword">if</span> (!encrypted) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">decrypt</span>(encrypted, password);
  }

  <span class="hljs-comment">// Secure communication</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">encryptForTransmission</span>(<span class="hljs-params">data, publicKey</span>) {
    <span class="hljs-comment">// Generate a random AES key for data encryption</span>
    <span class="hljs-keyword">const</span> aesKey = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">generateKey</span>(
      { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;AES-GCM&quot;</span>, <span class="hljs-attr">length</span>: <span class="hljs-number">256</span> },
      <span class="hljs-literal">true</span>,
      [<span class="hljs-string">&quot;encrypt&quot;</span>]
    );

    <span class="hljs-comment">// Encrypt data with AES key</span>
    <span class="hljs-keyword">const</span> iv = crypto.<span class="hljs-title function_">getRandomValues</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">12</span>));
    <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
    <span class="hljs-keyword">const</span> encodedData = encoder.<span class="hljs-title function_">encode</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));

    <span class="hljs-keyword">const</span> encryptedData = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">encrypt</span>(
      { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;AES-GCM&quot;</span>, <span class="hljs-attr">iv</span>: iv },
      aesKey,
      encodedData
    );

    <span class="hljs-comment">// Export AES key and encrypt it with public key</span>
    <span class="hljs-keyword">const</span> exportedAesKey = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">exportKey</span>(<span class="hljs-string">&quot;raw&quot;</span>, aesKey);

    <span class="hljs-keyword">const</span> encryptedKey = <span class="hljs-keyword">await</span> crypto.<span class="hljs-property">subtle</span>.<span class="hljs-title function_">encrypt</span>(
      { <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;RSA-OAEP&quot;</span> },
      publicKey,
      exportedAesKey
    );

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">encryptedData</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(encryptedData)),
      <span class="hljs-attr">encryptedKey</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(encryptedKey)),
      <span class="hljs-attr">iv</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iv),
    };
  }
}
</code></pre></pre>
<h2 id="security-best-practices" node="[object Object]">Security Best Practices</h2>
<h3 id="input-validation" node="[object Object]">Input Validation</h3>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">InputValidator</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">validateEmail</span>(<span class="hljs-params">email</span>) {
    <span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;
    <span class="hljs-keyword">return</span> emailRegex.<span class="hljs-title function_">test</span>(email) &amp;&amp; email.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">254</span>;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">validatePassword</span>(<span class="hljs-params">password</span>) {
    <span class="hljs-keyword">return</span> (
      password.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">8</span> &amp;&amp;
      <span class="hljs-regexp">/[A-Z]/</span>.<span class="hljs-title function_">test</span>(password) &amp;&amp;
      <span class="hljs-regexp">/[a-z]/</span>.<span class="hljs-title function_">test</span>(password) &amp;&amp;
      <span class="hljs-regexp">/\d/</span>.<span class="hljs-title function_">test</span>(password) &amp;&amp;
      <span class="hljs-regexp">/[!@#$%^&amp;*]/</span>.<span class="hljs-title function_">test</span>(password)
    );
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">sanitizeHTML</span>(<span class="hljs-params">input</span>) {
    <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);
    div.<span class="hljs-property">textContent</span> = input;
    <span class="hljs-keyword">return</span> div.<span class="hljs-property">innerHTML</span>;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">validateURL</span>(<span class="hljs-params">url</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> parsed = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url);
      <span class="hljs-keyword">return</span> [<span class="hljs-string">&quot;http:&quot;</span>, <span class="hljs-string">&quot;https:&quot;</span>].<span class="hljs-title function_">includes</span>(parsed.<span class="hljs-property">protocol</span>);
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
}
</code></pre></pre>
<h3 id="security-headers-implementation" node="[object Object]">Security Headers Implementation</h3>
<pre><pre><code class="hljs hljs language-javascript"><span class="hljs-comment">// Security headers middleware (server-side)</span>
<span class="hljs-keyword">const</span> securityHeaders = {
  <span class="hljs-string">&quot;Content-Security-Policy&quot;</span>:
    <span class="hljs-string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;;&quot;</span>,
  <span class="hljs-string">&quot;X-Frame-Options&quot;</span>: <span class="hljs-string">&quot;DENY&quot;</span>,
  <span class="hljs-string">&quot;X-Content-Type-Options&quot;</span>: <span class="hljs-string">&quot;nosniff&quot;</span>,
  <span class="hljs-string">&quot;Strict-Transport-Security&quot;</span>: <span class="hljs-string">&quot;max-age=31536000; includeSubDomains&quot;</span>,
  <span class="hljs-string">&quot;Referrer-Policy&quot;</span>: <span class="hljs-string">&quot;strict-origin-when-cross-origin&quot;</span>,
  <span class="hljs-string">&quot;Permissions-Policy&quot;</span>: <span class="hljs-string">&quot;geolocation=(), microphone=(), camera=()&quot;</span>,
};

<span class="hljs-comment">// Client-side security checks</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityChecker</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">checkSecurityHeaders</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> requiredHeaders = [
      <span class="hljs-string">&quot;content-security-policy&quot;</span>,
      <span class="hljs-string">&quot;x-frame-options&quot;</span>,
      <span class="hljs-string">&quot;x-content-type-options&quot;</span>,
    ];

    <span class="hljs-keyword">const</span> missingHeaders = [];

    requiredHeaders.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">header</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`meta[http-equiv=&quot;<span class="hljs-subst">${header}</span>&quot;]`</span>)) {
        missingHeaders.<span class="hljs-title function_">push</span>(header);
      }
    });

    <span class="hljs-keyword">if</span> (missingHeaders.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&quot;Missing security headers:&quot;</span>, missingHeaders);
    }
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">checkHTTPS</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">if</span> (location.<span class="hljs-property">protocol</span> !== <span class="hljs-string">&quot;https:&quot;</span> &amp;&amp; location.<span class="hljs-property">hostname</span> !== <span class="hljs-string">&quot;localhost&quot;</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&quot;Application should be served over HTTPS&quot;</span>);
    }
  }
}
</code></pre></pre>
<h2 id="resources" node="[object Object]">Resources</h2>
<h3 id="documentation" node="[object Object]">Documentation</h3>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer" node="[object Object]">OWASP Top 10</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer" node="[object Object]">Content Security Policy</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API" target="_blank" rel="noopener noreferrer" node="[object Object]">Web Crypto API</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" target="_blank" rel="noopener noreferrer" node="[object Object]">Security Headers</a></li>
</ul>
<h3 id="tools" node="[object Object]">Tools</h3>
<ul>
<li><a href="https://owasp.org/www-project-zap/" target="_blank" rel="noopener noreferrer" node="[object Object]">OWASP ZAP</a> - Security testing</li>
<li><a href="https://securityheaders.com/" target="_blank" rel="noopener noreferrer" node="[object Object]">Security Headers</a> - Header analysis</li>
<li><a href="https://csp-evaluator.withgoogle.com/" target="_blank" rel="noopener noreferrer" node="[object Object]">CSP Evaluator</a> - CSP validation</li>
<li><a href="https://snyk.io/" target="_blank" rel="noopener noreferrer" node="[object Object]">Snyk</a> - Vulnerability scanning</li>
</ul>
<h3 id="practice-platforms" node="[object Object]">Practice Platforms</h3>
<ul>
<li><a href="https://owasp.org/www-project-juice-shop/" target="_blank" rel="noopener noreferrer" node="[object Object]">OWASP Juice Shop</a> - Security training</li>
<li><a href="https://portswigger.net/web-security" target="_blank" rel="noopener noreferrer" node="[object Object]">PortSwigger Web Security Academy</a></li>
<li><a href="https://hackerone.com/" target="_blank" rel="noopener noreferrer" node="[object Object]">HackerOne</a> - Bug bounty programs</li>
</ul>
<hr/>
<p><em>This guide covers essential security concepts for frontend interviews, including practical problems and advanced techniques commonly asked at Big Tech companies.</em></p></div></div></main><footer class="sc-bbbBoY fXFPTj"><div class="sc-cdmAjP dWUTOl"><div class="sc-jytpVa kWeZJe"><div class="sc-eknHtZ hlQQbN"><div class="sc-pYNGo eUEOfs"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code "><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>Frontend Interview Prep</div><p class="sc-cCVJLD FTAbj">Comprehensive interview preparation for frontend engineers targeting Big Tech companies.</p><div class="sc-jYczwO fjvVr"><a href="https://github.com" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><a href="https://twitter.com" aria-label="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-twitter "><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a><a href="https://linkedin.com" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin "><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="mailto:contact@example.com" aria-label="Email"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail "><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg></a></div></div><div class="sc-eknHtZ hlQQbN"><h3>Study Materials</h3><ul><li><a href="/algorithms">Algorithms</a></li><li><a href="/react">React &amp; Frontend</a></li><li><a href="/system-design">System Design</a></li><li><a href="/typescript">TypeScript</a></li><li><a href="/performance">Performance</a></li></ul></div><div class="sc-eknHtZ hlQQbN"><h3>Companies</h3><ul><li><a href="/google">Google</a></li><li><a href="/meta">Meta</a></li><li><a href="/amazon">Amazon</a></li><li><a href="/microsoft">Microsoft</a></li><li><a href="/apple">Apple</a></li></ul></div><div class="sc-eknHtZ hlQQbN"><h3>Resources</h3><ul><li><a href="/interview-tips">Interview Tips</a></li><li><a href="/coding-challenges">Coding Challenges</a></li><li><a href="/mock-interviews">Mock Interviews</a></li><li><a href="/blog">Blog</a></li><li><a href="/faq">FAQ</a></li></ul></div></div><div class="sc-dNFkOE jkOcpo"><p class="sc-fszimp ficqwG">© 2025 Frontend Interview Prep. All rights reserved.</p><div class="sc-etsjJW cAqCWV"><a href="/privacy">Privacy Policy</a><a href="/terms">Terms of Service</a><a href="/contact">Contact</a></div></div></div></footer></div><script src="/interview/_next/static/chunks/webpack-be7d7df45533bffc.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/interview/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/interview/_next/static/css/387024c6a2216908.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[2846,[],\"\"]\n5:I[5907,[\"918\",\"static/chunks/918-3273b83890f10546.js\",\"930\",\"static/chunks/930-3262a6c9c5acace4.js\",\"687\",\"static/chunks/app/docs/%5B...slug%5D/page-32962e9542d32755.js\"],\"default\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[2,[\"918\",\"static/chunks/918-3273b83890f10546.js\",\"710\",\"static/chunks/710-dfaa11b4dff08f8e.js\",\"972\",\"static/chunks/972-011bba60ed155615.js\",\"233\",\"static/chunks/233-3e0c1d820a17eca9.js\",\"185\",\"static/chunks/app/layout-333f4adcd11f8f39.js\"],\"default\",1]\nc:I[1060,[],\"\"]\n6:T6609,"])</script><script>self.__next_f.push([1,"# Security Interview Preparation\n\n## Core Concepts\n\n### Frontend Security Fundamentals\n\n- **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pages\n- **Cross-Site Request Forgery (CSRF)**: Unauthorized actions performed on behalf of users\n- **Content Security Policy (CSP)**: Security headers to prevent code injection\n- **Same-Origin Policy**: Browser security mechanism for isolating resources\n- **Authentication \u0026 Authorization**: User identity verification and access control\n\n### Security Headers\n\n- **Content-Security-Policy**: Controls resource loading\n- **X-Frame-Options**: Prevents clickjacking attacks\n- **X-Content-Type-Options**: Prevents MIME type sniffing\n- **Strict-Transport-Security**: Enforces HTTPS connections\n- **Referrer-Policy**: Controls referrer information\n\n## Advanced Topics\n\n### Modern Security Features\n\n- **Subresource Integrity (SRI)**: Verifies external resource integrity\n- **Trusted Types**: Prevents DOM-based XSS\n- **Feature Policy**: Controls browser feature usage\n- **Web Crypto API**: Client-side cryptography\n- **Service Worker Security**: Secure offline functionality\n\n### Security Testing\n\n- **Static Analysis**: Code scanning for vulnerabilities\n- **Dynamic Analysis**: Runtime security testing\n- **Penetration Testing**: Manual security assessment\n- **Security Headers Testing**: CSP and header validation\n- **Dependency Scanning**: Third-party vulnerability detection\n\n## Common Interview Questions \u0026 Answers\n\n### Security Questions\n\n**Q: What is XSS and how do you prevent it?**\nA: XSS (Cross-Site Scripting) allows attackers to inject malicious scripts into web pages.\n\n**Types of XSS:**\n\n- **Stored XSS**: Malicious script stored in database\n- **Reflected XSS**: Malicious script reflected in response\n- **DOM-based XSS**: Malicious script manipulating DOM\n\n**Prevention Techniques:**\n\n```javascript\n// 1. Input validation and sanitization\nfunction sanitizeInput(input) {\n  return input\n    .replace(/\u0026/g, '\u0026amp;')\n    .replace(/\u003c/g, '\u0026lt;')\n    .replace(/\u003e/g, '\u0026gt;')\n    .replace(/\"/g, '\u0026quot;')\n    .replace(/'/g, '\u0026#x27;');\n}\n\n// 2. Use safe DOM methods\n// ❌ Dangerous\nelement.innerHTML = userInput;\n\n// ✅ Safe\nelement.textContent = userInput;\n\n// 3. Use React's built-in XSS protection\nfunction SafeComponent({ userInput }) {\n  return \u003cdiv\u003e{userInput}\u003c/div\u003e; // React automatically escapes\n}\n\n// 4. Content Security Policy\n// Add to HTML head\n\u003cmeta http-equiv=\"Content-Security-Policy\"\n      content=\"default-src 'self'; script-src 'self' 'unsafe-inline'\"\u003e\n```\n\n**Q: What is CSRF and how do you prevent it?**\nA: CSRF (Cross-Site Request Forgery) tricks users into performing unwanted actions.\n\n**Prevention Techniques:**\n\n{% raw %}\n```javascript\n// 1. CSRF Tokens\nclass CSRFProtection {\n  constructor() {\n    this.token = this.generateToken();\n  }\n\n  generateToken() {\n    return crypto\n      .getRandomValues(new Uint8Array(32))\n      .reduce((acc, val) =\u003e acc + val.toString(16).padStart(2, \"0\"), \"\");\n  }\n\n  addTokenToRequest(request) {\n    request.headers[\"X-CSRF-Token\"] = this.token;\n    return request;\n  }\n\n  validateToken(token) {\n    return token === this.token;\n  }\n}\n\n// 2. SameSite Cookies\ndocument.cookie = \"sessionId=abc123; SameSite=Strict; Secure; HttpOnly\";\n\n// 3. Double Submit Cookie Pattern\nclass DoubleSubmitCookie {\n  constructor() {\n    this.token = this.generateToken();\n    this.setCookie();\n  }\n\n  setCookie() {\n    document.cookie = `csrf-token=${this.token}; SameSite=Strict; Secure`;\n  }\n\n  addTokenToForm(form) {\n    const tokenInput = document.createElement(\"input\");\n    tokenInput.type = \"hidden\";\n    tokenInput.name = \"csrf-token\";\n    tokenInput.value = this.token;\n    form.appendChild(tokenInput);\n  }\n}\n\n// 4. Custom Headers\nfetch(\"/api/update\", {\n  method: \"POST\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"X-CSRF-Token\": csrfToken,\n    \"X-Requested-With\": \"XMLHttpRequest\",\n  },\n  body: JSON.stringify(data),\n});\n```\n{% endraw %}\n\n**Q: How do you implement Content Security Policy?**\nA: CSP is a security header that controls which resources can be loaded.\n\n```javascript\n// 1. Basic CSP Implementation\nconst cspHeader = {\n  \"default-src\": [\"'self'\"],\n  \"script-src\": [\"'self'\", \"'unsafe-inline'\", \"https://cdn.example.com\"],\n  \"style-src\": [\"'self'\", \"'unsafe-inline'\", \"https://fonts.googleapis.com\"],\n  \"img-src\": [\"'self'\", \"data:\", \"https:\"],\n  \"font-src\": [\"'self'\", \"https://fonts.gstatic.com\"],\n  \"connect-src\": [\"'self'\", \"https://api.example.com\"],\n  \"frame-src\": [\"'none'\"],\n  \"object-src\": [\"'none'\"],\n  \"base-uri\": [\"'self'\"],\n  \"form-action\": [\"'self'\"],\n};\n\n// 2. Dynamic CSP for different pages\nclass CSPManager {\n  constructor() {\n    this.basePolicy = {\n      \"default-src\": [\"'self'\"],\n      \"script-src\": [\"'self'\"],\n      \"style-src\": [\"'self'\"],\n      \"img-src\": [\"'self'\", \"data:\"],\n      \"connect-src\": [\"'self'\"],\n    };\n  }\n\n  addPolicy(page, additionalRules) {\n    const policy = { ...this.basePolicy };\n\n    Object.keys(additionalRules).forEach((key) =\u003e {\n      if (policy[key]) {\n        policy[key] = [...policy[key], ...additionalRules[key]];\n      } else {\n        policy[key] = additionalRules[key];\n      }\n    });\n\n    return this.stringifyPolicy(policy);\n  }\n\n  stringifyPolicy(policy) {\n    return Object.entries(policy)\n      .map(([key, values]) =\u003e `${key} ${values.join(\" \")}`)\n      .join(\"; \");\n  }\n\n  // 3. Nonce-based CSP\n  generateNonce() {\n    return crypto\n      .getRandomValues(new Uint8Array(16))\n      .reduce((acc, val) =\u003e acc + val.toString(16).padStart(2, \"0\"), \"\");\n  }\n\n  addNonceToScript(nonce) {\n    const script = document.createElement(\"script\");\n    script.nonce = nonce;\n    script.textContent = 'console.log(\"Safe script\");';\n    document.head.appendChild(script);\n  }\n}\n\n// 4. Hash-based CSP\nclass HashCSP {\n  constructor() {\n    this.hashes = new Set();\n  }\n\n  addScriptHash(scriptContent) {\n    const hash = this.generateHash(scriptContent);\n    this.hashes.add(hash);\n    return hash;\n  }\n\n  generateHash(content) {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(content);\n    return crypto.subtle.digest(\"SHA-256\", data).then((hash) =\u003e {\n      const hashArray = Array.from(new Uint8Array(hash));\n      return `'sha256-${btoa(String.fromCharCode(...hashArray))}'`;\n    });\n  }\n\n  getPolicy() {\n    const scriptSrc = [\"'self'\", ...Array.from(this.hashes)];\n    return `script-src ${scriptSrc.join(\" \")}`;\n  }\n}\n```\n\n## Advanced Interview Questions\n\n**Q: How would you implement secure authentication in a frontend application?**\nA: Comprehensive authentication security implementation:\n\n```javascript\nclass SecureAuthManager {\n  constructor() {\n    this.tokenKey = 'auth_token';\n    this.refreshTokenKey = 'refresh_token';\n    this.tokenExpiryKey = 'token_expiry';\n  }\n\n  // 1. Secure token storage\n  storeTokens(accessToken, refreshToken, expiresIn) {\n    const expiryTime = Date.now() + (expiresIn * 1000);\n\n    // Store in memory for sensitive operations\n    this.accessToken = accessToken;\n    this.refreshToken = refreshToken;\n\n    // Store refresh token in httpOnly cookie (server-side)\n    this.setHttpOnlyCookie(this.refreshTokenKey, refreshToken);\n\n    // Store expiry time in localStorage\n    localStorage.setItem(this.tokenExpiryKey, expiryTime.toString());\n  }\n\n  // 2. Token validation\n  isTokenValid() {\n    const expiryTime = localStorage.getItem(this.tokenExpiryKey);\n    if (!expiryTime) return false;\n\n    return Date.now() \u003c parseInt(expiryTime);\n  }\n\n  // 3. Automatic token refresh\n  async refreshTokenIfNeeded() {\n    if (!this.isTokenValid() \u0026\u0026 this.refreshToken) {\n      try {\n        const response = await fetch('/api/auth/refresh', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${this.refreshToken}`\n          }\n        });\n\n        if (response.ok) {\n          const { accessToken, expiresIn } = await response.json();\n          this.storeTokens(accessToken, this.refreshToken, expiresIn);\n          return accessToken;\n        } else {\n          this.logout();\n          throw new Error('Token refresh failed');\n        }\n      } catch (error) {\n        this.logout();\n        throw error;\n      }\n    }\n\n    return this.accessToken;\n  }\n\n  // 4. Secure logout\n  logout() {\n    this.accessToken = null;\n    this.refreshToken = null;\n    localStorage.removeItem(this.tokenExpiryKey);\n\n    // Clear httpOnly cookie\n    this.clearHttpOnlyCookie(this.refreshTokenKey);\n\n    // Redirect to login\n    window.location.href = '/login';\n  }\n\n  // 5. Secure API requests\n  async makeSecureRequest(url, options = {}) {\n    const token = await this.refreshTokenIfNeeded();\n\n    const secureOptions = {\n      ...options,\n      headers: {\n        ...options.headers,\n        'Authorization': `Bearer ${token}`,\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    };\n\n    const response = await fetch(url, secureOptions);\n\n    if (response.status === 401) {\n      this.logout();\n      throw new Error('Unauthorized');\n    }\n\n    return response;\n  }\n\n  // 6. Password strength validation\n  validatePassword(password) {\n    const requirements = {\n      minLength: 8,\n      hasUpperCase: /[A-Z]/,\n      hasLowerCase: /[a-z]/,\n      hasNumbers: /\\d/,\n      hasSpecialChar: /[!@#$%^\u0026*(),.?\":{}|\u003c\u003e]/\n    };\n\n    const errors = [];\n\n    if (password.length \u003c requirements.minLength) {\n      errors.push(`Password must be at least ${requirements.minLength} characters`);\n    }\n\n    if (!requirements.hasUpperCase.test(password)) {\n      errors.push('Password must contain at least one uppercase letter');\n    }\n\n    if (!requirements.hasLowerCase.test(password)) {\n      errors.push('Password must contain at least one lowercase letter');\n    }\n\n    if (!requirements.hasNumbers.test(password)) {\n      errors.push('Password must contain at least one number');\n    }\n\n    if (!requirements.hasSpecialChar.test(password)) {\n      errors.push('Password must contain at least one special character');\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors\n    };\n  }\n\n  // 7. Rate limiting for login attempts\n  constructor() {\n    this.loginAttempts = new Map();\n    this.maxAttempts = 5;\n    this.lockoutDuration = 15 * 60 * 1000; // 15 minutes\n  }\n\n  checkLoginAttempts(email) {\n    const attempts = this.loginAttempts.get(email) || { count: 0, lastAttempt: 0 };\n\n    if (attempts.count \u003e= this.maxAttempts) {\n      const timeSinceLastAttempt = Date.now() - attempts.lastAttempt;\n\n      if (timeSinceLastAttempt \u003c this.lockoutDuration) {\n        const remainingTime = Math.ceil((this.lockoutDuration - timeSinceLastAttempt) / 1000 / 60);\n        throw new Error(`Account temporarily locked. Try again in ${remainingTime} minutes.`);\n      } else {\n        // Reset attempts after lockout period\n        this.loginAttempts.delete(email);\n      }\n    }\n  }\n\n  recordLoginAttempt(email, success) {\n    const attempts = this.loginAttempts.get(email) || { count: 0, lastAttempt: 0 };\n\n    if (success) {\n      this.loginAttempts.delete(email);\n    } else {\n      attempts.count++;\n      attempts.lastAttempt = Date.now();\n      this.loginAttempts.set(email, attempts);\n    }\n  }\n}\n```\n\n**Q: How do you implement secure file uploads?**\nA: Secure file upload implementation with validation and scanning:\n\n```javascript\nclass SecureFileUpload {\n  constructor() {\n    this.allowedTypes = [\n      \"image/jpeg\",\n      \"image/png\",\n      \"image/gif\",\n      \"application/pdf\",\n    ];\n    this.maxFileSize = 5 * 1024 * 1024; // 5MB\n    this.maxFiles = 10;\n  }\n\n  // 1. File type validation\n  validateFileType(file) {\n    // Check MIME type\n    if (!this.allowedTypes.includes(file.type)) {\n      throw new Error(\"File type not allowed\");\n    }\n\n    // Check file extension\n    const extension = file.name.split(\".\").pop().toLowerCase();\n    const allowedExtensions = [\"jpg\", \"jpeg\", \"png\", \"gif\", \"pdf\"];\n\n    if (!allowedExtensions.includes(extension)) {\n      throw new Error(\"File extension not allowed\");\n    }\n\n    // Check file signature (magic numbers)\n    return this.checkFileSignature(file);\n  }\n\n  // 2. File signature validation\n  async checkFileSignature(file) {\n    const signatures = {\n      \"image/jpeg\": [0xff, 0xd8, 0xff],\n      \"image/png\": [0x89, 0x50, 0x4e, 0x47],\n      \"image/gif\": [0x47, 0x49, 0x46],\n      \"application/pdf\": [0x25, 0x50, 0x44, 0x46],\n    };\n\n    const buffer = await file.arrayBuffer();\n    const bytes = new Uint8Array(buffer);\n    const expectedSignature = signatures[file.type];\n\n    if (expectedSignature) {\n      for (let i = 0; i \u003c expectedSignature.length; i++) {\n        if (bytes[i] !== expectedSignature[i]) {\n          throw new Error(\"Invalid file signature\");\n        }\n      }\n    }\n\n    return true;\n  }\n\n  // 3. File size validation\n  validateFileSize(file) {\n    if (file.size \u003e this.maxFileSize) {\n      throw new Error(\n        `File size exceeds ${this.maxFileSize / 1024 / 1024}MB limit`\n      );\n    }\n    return true;\n  }\n\n  // 4. Image processing and sanitization\n  async processImage(file) {\n    return new Promise((resolve, reject) =\u003e {\n      const canvas = document.createElement(\"canvas\");\n      const ctx = canvas.getContext(\"2d\");\n      const img = new Image();\n\n      img.onload = () =\u003e {\n        // Resize image if too large\n        const maxWidth = 1920;\n        const maxHeight = 1080;\n\n        let { width, height } = img;\n\n        if (width \u003e maxWidth || height \u003e maxHeight) {\n          const ratio = Math.min(maxWidth / width, maxHeight / height);\n          width *= ratio;\n          height *= ratio;\n        }\n\n        canvas.width = width;\n        canvas.height = height;\n\n        // Draw image to canvas (removes any embedded scripts)\n        ctx.drawImage(img, 0, 0, width, height);\n\n        // Convert to blob\n        canvas.toBlob(resolve, \"image/jpeg\", 0.8);\n      };\n\n      img.onerror = () =\u003e reject(new Error(\"Invalid image file\"));\n      img.src = URL.createObjectURL(file);\n    });\n  }\n\n  // 5. Secure upload with progress\n  async uploadFile(file, onProgress) {\n    try {\n      // Validate file\n      this.validateFileType(file);\n      this.validateFileSize(file);\n\n      // Process file if it's an image\n      let processedFile = file;\n      if (file.type.startsWith(\"image/\")) {\n        processedFile = await this.processImage(file);\n      }\n\n      // Generate secure filename\n      const secureFilename = this.generateSecureFilename(file.name);\n\n      // Create FormData\n      const formData = new FormData();\n      formData.append(\"file\", processedFile, secureFilename);\n      formData.append(\"timestamp\", Date.now().toString());\n\n      // Upload with progress\n      const xhr = new XMLHttpRequest();\n\n      return new Promise((resolve, reject) =\u003e {\n        xhr.upload.addEventListener(\"progress\", (event) =\u003e {\n          if (event.lengthComputable) {\n            const progress = (event.loaded / event.total) * 100;\n            onProgress?.(progress);\n          }\n        });\n\n        xhr.addEventListener(\"load\", () =\u003e {\n          if (xhr.status === 200) {\n            resolve(JSON.parse(xhr.responseText));\n          } else {\n            reject(new Error(\"Upload failed\"));\n          }\n        });\n\n        xhr.addEventListener(\"error\", () =\u003e {\n          reject(new Error(\"Upload failed\"));\n        });\n\n        xhr.open(\"POST\", \"/api/upload\");\n        xhr.send(formData);\n      });\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  // 6. Generate secure filename\n  generateSecureFilename(originalName) {\n    const extension = originalName.split(\".\").pop();\n    const timestamp = Date.now();\n    const randomString = crypto\n      .getRandomValues(new Uint8Array(8))\n      .reduce((acc, val) =\u003e acc + val.toString(16).padStart(2, \"0\"), \"\");\n\n    return `${timestamp}_${randomString}.${extension}`;\n  }\n\n  // 7. Multiple file upload with validation\n  async uploadMultipleFiles(files, onProgress) {\n    const validFiles = [];\n    const errors = [];\n\n    // Validate all files first\n    for (let i = 0; i \u003c files.length; i++) {\n      try {\n        this.validateFileType(files[i]);\n        this.validateFileSize(files[i]);\n        validFiles.push(files[i]);\n      } catch (error) {\n        errors.push({ file: files[i].name, error: error.message });\n      }\n    }\n\n    if (validFiles.length === 0) {\n      throw new Error(\"No valid files to upload\");\n    }\n\n    // Upload valid files\n    const uploadPromises = validFiles.map((file, index) =\u003e {\n      return this.uploadFile(file, (progress) =\u003e {\n        onProgress?.(index, progress);\n      });\n    });\n\n    const results = await Promise.allSettled(uploadPromises);\n\n    return {\n      successful: results\n        .filter((r) =\u003e r.status === \"fulfilled\")\n        .map((r) =\u003e r.value),\n      failed: results\n        .filter((r) =\u003e r.status === \"rejected\")\n        .map((r) =\u003e r.reason),\n      validationErrors: errors,\n    };\n  }\n}\n```\n\n## Practical Problems \u0026 Solutions\n\n### Problem 1: Implement Secure Session Management\n\n**Challenge**: Create a secure session management system with automatic cleanup and security features.\n\n```javascript\nclass SecureSessionManager {\n  constructor() {\n    this.sessions = new Map();\n    this.sessionTimeout = 30 * 60 * 1000; // 30 minutes\n    this.maxSessionsPerUser = 5;\n    this.cleanupInterval = 5 * 60 * 1000; // 5 minutes\n\n    this.startCleanupTimer();\n  }\n\n  createSession(userId, userAgent, ipAddress) {\n    // Check existing sessions for user\n    const userSessions = this.getUserSessions(userId);\n\n    if (userSessions.length \u003e= this.maxSessionsPerUser) {\n      // Remove oldest session\n      const oldestSession = userSessions.sort(\n        (a, b) =\u003e a.createdAt - b.createdAt\n      )[0];\n      this.removeSession(oldestSession.id);\n    }\n\n    const session = {\n      id: this.generateSessionId(),\n      userId,\n      userAgent,\n      ipAddress,\n      createdAt: Date.now(),\n      lastActivity: Date.now(),\n      isActive: true,\n    };\n\n    this.sessions.set(session.id, session);\n    return session;\n  }\n\n  validateSession(sessionId, userAgent, ipAddress) {\n    const session = this.sessions.get(sessionId);\n\n    if (!session || !session.isActive) {\n      return false;\n    }\n\n    // Check session timeout\n    if (Date.now() - session.lastActivity \u003e this.sessionTimeout) {\n      this.removeSession(sessionId);\n      return false;\n    }\n\n    // Check for suspicious activity\n    if (session.userAgent !== userAgent || session.ipAddress !== ipAddress) {\n      this.flagSuspiciousActivity(session);\n      return false;\n    }\n\n    // Update last activity\n    session.lastActivity = Date.now();\n    return true;\n  }\n\n  removeSession(sessionId) {\n    this.sessions.delete(sessionId);\n  }\n\n  getUserSessions(userId) {\n    return Array.from(this.sessions.values()).filter(\n      (session) =\u003e session.userId === userId\n    );\n  }\n\n  generateSessionId() {\n    return crypto\n      .getRandomValues(new Uint8Array(32))\n      .reduce((acc, val) =\u003e acc + val.toString(16).padStart(2, \"0\"), \"\");\n  }\n\n  flagSuspiciousActivity(session) {\n    session.isActive = false;\n    // Log suspicious activity\n    console.warn(\"Suspicious session activity detected:\", session);\n  }\n\n  startCleanupTimer() {\n    setInterval(() =\u003e {\n      this.cleanupExpiredSessions();\n    }, this.cleanupInterval);\n  }\n\n  cleanupExpiredSessions() {\n    const now = Date.now();\n\n    for (const [sessionId, session] of this.sessions.entries()) {\n      if (now - session.lastActivity \u003e this.sessionTimeout) {\n        this.removeSession(sessionId);\n      }\n    }\n  }\n\n  getSessionStats() {\n    const totalSessions = this.sessions.size;\n    const activeSessions = Array.from(this.sessions.values()).filter(\n      (session) =\u003e session.isActive\n    ).length;\n\n    return {\n      total: totalSessions,\n      active: activeSessions,\n      expired: totalSessions - activeSessions,\n    };\n  }\n}\n```\n\n### Problem 2: Implement Secure Data Encryption\n\n**Challenge**: Create a client-side encryption system for sensitive data.\n\n```javascript\nclass SecureDataEncryption {\n  constructor() {\n    this.algorithm = \"AES-GCM\";\n    this.keyLength = 256;\n  }\n\n  async generateKey(password, salt) {\n    const encoder = new TextEncoder();\n    const keyMaterial = await crypto.subtle.importKey(\n      \"raw\",\n      encoder.encode(password),\n      \"PBKDF2\",\n      false,\n      [\"deriveBits\", \"deriveKey\"]\n    );\n\n    return crypto.subtle.deriveKey(\n      {\n        name: \"PBKDF2\",\n        salt: encoder.encode(salt),\n        iterations: 100000,\n        hash: \"SHA-256\",\n      },\n      keyMaterial,\n      { name: this.algorithm, length: this.keyLength },\n      false,\n      [\"encrypt\", \"decrypt\"]\n    );\n  }\n\n  async encrypt(data, password) {\n    const salt = crypto.getRandomValues(new Uint8Array(16));\n    const iv = crypto.getRandomValues(new Uint8Array(12));\n\n    const key = await this.generateKey(password, salt);\n    const encoder = new TextEncoder();\n    const encodedData = encoder.encode(JSON.stringify(data));\n\n    const encryptedData = await crypto.subtle.encrypt(\n      {\n        name: this.algorithm,\n        iv: iv,\n      },\n      key,\n      encodedData\n    );\n\n    return {\n      data: Array.from(new Uint8Array(encryptedData)),\n      salt: Array.from(salt),\n      iv: Array.from(iv),\n    };\n  }\n\n  async decrypt(encryptedData, password) {\n    const key = await this.generateKey(password, encryptedData.salt);\n\n    const decryptedData = await crypto.subtle.decrypt(\n      {\n        name: this.algorithm,\n        iv: new Uint8Array(encryptedData.iv),\n      },\n      key,\n      new Uint8Array(encryptedData.data)\n    );\n\n    const decoder = new TextDecoder();\n    return JSON.parse(decoder.decode(decryptedData));\n  }\n\n  // Secure storage with encryption\n  async secureStore(key, data, password) {\n    const encrypted = await this.encrypt(data, password);\n    localStorage.setItem(key, JSON.stringify(encrypted));\n  }\n\n  async secureRetrieve(key, password) {\n    const encrypted = JSON.parse(localStorage.getItem(key));\n    if (!encrypted) return null;\n\n    return await this.decrypt(encrypted, password);\n  }\n\n  // Secure communication\n  async encryptForTransmission(data, publicKey) {\n    // Generate a random AES key for data encryption\n    const aesKey = await crypto.subtle.generateKey(\n      { name: \"AES-GCM\", length: 256 },\n      true,\n      [\"encrypt\"]\n    );\n\n    // Encrypt data with AES key\n    const iv = crypto.getRandomValues(new Uint8Array(12));\n    const encoder = new TextEncoder();\n    const encodedData = encoder.encode(JSON.stringify(data));\n\n    const encryptedData = await crypto.subtle.encrypt(\n      { name: \"AES-GCM\", iv: iv },\n      aesKey,\n      encodedData\n    );\n\n    // Export AES key and encrypt it with public key\n    const exportedAesKey = await crypto.subtle.exportKey(\"raw\", aesKey);\n\n    const encryptedKey = await crypto.subtle.encrypt(\n      { name: \"RSA-OAEP\" },\n      publicKey,\n      exportedAesKey\n    );\n\n    return {\n      encryptedData: Array.from(new Uint8Array(encryptedData)),\n      encryptedKey: Array.from(new Uint8Array(encryptedKey)),\n      iv: Array.from(iv),\n    };\n  }\n}\n```\n\n## Security Best Practices\n\n### Input Validation\n\n```javascript\nclass InputValidator {\n  static validateEmail(email) {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email) \u0026\u0026 email.length \u003c= 254;\n  }\n\n  static validatePassword(password) {\n    return (\n      password.length \u003e= 8 \u0026\u0026\n      /[A-Z]/.test(password) \u0026\u0026\n      /[a-z]/.test(password) \u0026\u0026\n      /\\d/.test(password) \u0026\u0026\n      /[!@#$%^\u0026*]/.test(password)\n    );\n  }\n\n  static sanitizeHTML(input) {\n    const div = document.createElement(\"div\");\n    div.textContent = input;\n    return div.innerHTML;\n  }\n\n  static validateURL(url) {\n    try {\n      const parsed = new URL(url);\n      return [\"http:\", \"https:\"].includes(parsed.protocol);\n    } catch {\n      return false;\n    }\n  }\n}\n```\n\n### Security Headers Implementation\n\n```javascript\n// Security headers middleware (server-side)\nconst securityHeaders = {\n  \"Content-Security-Policy\":\n    \"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';\",\n  \"X-Frame-Options\": \"DENY\",\n  \"X-Content-Type-Options\": \"nosniff\",\n  \"Strict-Transport-Security\": \"max-age=31536000; includeSubDomains\",\n  \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n  \"Permissions-Policy\": \"geolocation=(), microphone=(), camera=()\",\n};\n\n// Client-side security checks\nclass SecurityChecker {\n  static checkSecurityHeaders() {\n    const requiredHeaders = [\n      \"content-security-policy\",\n      \"x-frame-options\",\n      \"x-content-type-options\",\n    ];\n\n    const missingHeaders = [];\n\n    requiredHeaders.forEach((header) =\u003e {\n      if (!document.head.querySelector(`meta[http-equiv=\"${header}\"]`)) {\n        missingHeaders.push(header);\n      }\n    });\n\n    if (missingHeaders.length \u003e 0) {\n      console.warn(\"Missing security headers:\", missingHeaders);\n    }\n  }\n\n  static checkHTTPS() {\n    if (location.protocol !== \"https:\" \u0026\u0026 location.hostname !== \"localhost\") {\n      console.error(\"Application should be served over HTTPS\");\n    }\n  }\n}\n```\n\n## Resources\n\n### Documentation\n\n- [OWASP Top 10](https://owasp.org/www-project-top-ten/)\n- [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)\n- [Web Crypto API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API)\n- [Security Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)\n\n### Tools\n\n- [OWASP ZAP](https://owasp.org/www-project-zap/) - Security testing\n- [Security Headers](https://securityheaders.com/) - Header analysis\n- [CSP Evaluator](https://csp-evaluator.withgoogle.com/) - CSP validation\n- [Snyk](https://snyk.io/) - Vulnerability scanning\n\n### Practice Platforms\n\n- [OWASP Juice Shop](https://owasp.org/www-project-juice-shop/) - Security training\n- [PortSwigger Web Security Academy](https://portswigger.net/web-security)\n- [HackerOne](https://hackerone.com/) - Bug bounty programs\n\n---\n\n_This guide covers essential security concepts for frontend interviews, including practical problems and advanced techniques commonly asked at Big Tech companies._\n"])</script><script>self.__next_f.push([1,"8:[\"slug\",\"src/content/frontend/security/README\",\"c\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L3\",null,{\"buildId\":\"7uJ7BVaXJTiEOD9iYDv3n\",\"assetPrefix\":\"/interview\",\"urlParts\":[\"\",\"docs\",\"src\",\"content\",\"frontend\",\"security\",\"README\"],\"initialTree\":[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"src/content/frontend/security/README\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"src\\\",\\\"content\\\",\\\"frontend\\\",\\\"security\\\",\\\"README\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"docs\",{\"children\":[[\"slug\",\"src/content/frontend/security/README\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",[\"$\",\"div\",null,{\"style\":{\"maxWidth\":\"1200px\",\"margin\":\"0 auto\",\"padding\":\"2rem\",\"paddingTop\":\"6rem\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"marginBottom\":\"2rem\"},\"children\":[[\"$\",\"nav\",null,{\"style\":{\"color\":\"#64748b\",\"fontSize\":\"0.9rem\",\"marginBottom\":\"1rem\"},\"children\":[[\"$\",\"a\",null,{\"href\":\"/\",\"style\":{\"color\":\"#3b82f6\",\"textDecoration\":\"none\"},\"children\":\"Home\"}],\" \u003e \",[\"$\",\"span\",null,{\"children\":\"src \u003e content \u003e frontend \u003e security \u003e README\"}]]}],[\"$\",\"h1\",null,{\"style\":{\"fontSize\":\"2.5rem\",\"fontWeight\":\"800\",\"marginBottom\":\"0.5rem\",\"color\":\"#1e293b\"},\"children\":\"README\"}],[\"$\",\"div\",null,{\"style\":{\"color\":\"#64748b\",\"fontSize\":\"0.9rem\",\"marginBottom\":\"2rem\"},\"children\":[[\"$\",\"span\",null,{\"children\":[\"📁 \",\"src/content/frontend/security/README.md\"]}],\"$undefined\",\"$undefined\"]}]]}],[\"$\",\"$L5\",null,{\"content\":\"$6\"}]]}],null],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"docs\",\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"docs\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/interview/_next/static/css/387024c6a2216908.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$La\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}],\"params\":{}}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"README - Frontend Interview Docs\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"README - Frontend Interview Docs\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"README - Frontend Interview Docs\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"# Security Interview Preparation  ## Core Concepts  ### Frontend Security Fundamentals  - **Cross-Site Scripting (XSS)**: Malicious scripts injected into web pa\"}],[\"$\",\"meta\",\"10\",{\"name\":\"next-size-adjust\"}]]\n4:null\n"])</script></body></html>