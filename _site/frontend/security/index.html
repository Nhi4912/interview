<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Interview Preparation | Frontend Interview Preparation Guide</title>
    <meta name="description" content="Comprehensive frontend interview materials for Big Tech companies">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>
    <!-- Navigation -->
    <header>
        <nav class="container">
            <div class="logo">Frontend Interview Hub</div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="#progress">Progress</a></li>
                <li><a href="#knowledge">Knowledge</a></li>
                <li><a href="https://github.com/nee/interview">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <div class="content-container">
    
        <nav class="breadcrumb">
            <ol>
                <li><a href="/">Home</a></li>
                
                
                
                    
                
                    
                        
                        
                            <li><a href="/frontend/">Frontend</a></li>
                        
                    
                
                    
                        
                        
                            <li class="active">Security interview preparation</li>
                        
                    
                
            </ol>
        </nav>
    
    
    <article class="content">
        
            <header class="content-header">
                <h1 class="content-title">Security Interview Preparation</h1>
                
                
            </header>
        
        
        <div class="content-body">
            <h1 id="security-interview-preparation">Security Interview Preparation</h1>

<h2 id="core-concepts">Core Concepts</h2>

<h3 id="frontend-security-fundamentals">Frontend Security Fundamentals</h3>

<ul>
  <li><strong>Cross-Site Scripting (XSS)</strong>: Malicious scripts injected into web pages</li>
  <li><strong>Cross-Site Request Forgery (CSRF)</strong>: Unauthorized actions performed on behalf of users</li>
  <li><strong>Content Security Policy (CSP)</strong>: Security headers to prevent code injection</li>
  <li><strong>Same-Origin Policy</strong>: Browser security mechanism for isolating resources</li>
  <li><strong>Authentication &amp; Authorization</strong>: User identity verification and access control</li>
</ul>

<h3 id="security-headers">Security Headers</h3>

<ul>
  <li><strong>Content-Security-Policy</strong>: Controls resource loading</li>
  <li><strong>X-Frame-Options</strong>: Prevents clickjacking attacks</li>
  <li><strong>X-Content-Type-Options</strong>: Prevents MIME type sniffing</li>
  <li><strong>Strict-Transport-Security</strong>: Enforces HTTPS connections</li>
  <li><strong>Referrer-Policy</strong>: Controls referrer information</li>
</ul>

<h2 id="advanced-topics">Advanced Topics</h2>

<h3 id="modern-security-features">Modern Security Features</h3>

<ul>
  <li><strong>Subresource Integrity (SRI)</strong>: Verifies external resource integrity</li>
  <li><strong>Trusted Types</strong>: Prevents DOM-based XSS</li>
  <li><strong>Feature Policy</strong>: Controls browser feature usage</li>
  <li><strong>Web Crypto API</strong>: Client-side cryptography</li>
  <li><strong>Service Worker Security</strong>: Secure offline functionality</li>
</ul>

<h3 id="security-testing">Security Testing</h3>

<ul>
  <li><strong>Static Analysis</strong>: Code scanning for vulnerabilities</li>
  <li><strong>Dynamic Analysis</strong>: Runtime security testing</li>
  <li><strong>Penetration Testing</strong>: Manual security assessment</li>
  <li><strong>Security Headers Testing</strong>: CSP and header validation</li>
  <li><strong>Dependency Scanning</strong>: Third-party vulnerability detection</li>
</ul>

<h2 id="common-interview-questions--answers">Common Interview Questions &amp; Answers</h2>

<h3 id="security-questions">Security Questions</h3>

<p><strong>Q: What is XSS and how do you prevent it?</strong>
A: XSS (Cross-Site Scripting) allows attackers to inject malicious scripts into web pages.</p>

<p><strong>Types of XSS:</strong></p>

<ul>
  <li><strong>Stored XSS</strong>: Malicious script stored in database</li>
  <li><strong>Reflected XSS</strong>: Malicious script reflected in response</li>
  <li><strong>DOM-based XSS</strong>: Malicious script manipulating DOM</li>
</ul>

<p><strong>Prevention Techniques:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="c1">// 1. Input validation and sanitization</span>
<span class="kd">function</span> <span class="nx">sanitizeInput</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">input</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;amp;</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;lt;</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;gt;</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/"/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;quot;</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/'/g</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&amp;#x27;</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 2. Use safe DOM methods</span>
<span class="c1">// ❌ Dangerous</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">userInput</span><span class="p">;</span>

<span class="c1">// ✅ Safe</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">userInput</span><span class="p">;</span>

<span class="c1">// 3. Use React's built-in XSS protection</span>
<span class="kd">function</span> <span class="nx">SafeComponent</span><span class="p">({</span> <span class="nx">userInput</span> <span class="p">})</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">userInput</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div&gt;; /</span><span class="o">/</span> <span class="nx">React</span> <span class="nx">automatically</span> <span class="nx">escapes</span>
<span class="p">}</span>

<span class="c1">// 4. Content Security Policy</span>
<span class="c1">// Add to HTML head</span>
<span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="dl">"</span><span class="s2">Content-Security-Policy</span><span class="dl">"</span>
      <span class="nx">content</span><span class="o">=</span><span class="dl">"</span><span class="s2">default-src 'self'; script-src 'self' 'unsafe-inline'</span><span class="dl">"</span><span class="o">&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Q: What is CSRF and how do you prevent it?</strong>
A: CSRF (Cross-Site Request Forgery) tricks users into performing unwanted actions.</p>

<p><strong>Prevention Techniques:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre><span class="c1">// 1. CSRF Tokens</span>
<span class="kd">class</span> <span class="nx">CSRFProtection</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateToken</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">generateToken</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">crypto</span>
      <span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">val</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">),</span> <span class="dl">""</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">addTokenToRequest</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">"</span><span class="s2">X-CSRF-Token</span><span class="dl">"</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">request</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">validateToken</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">token</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 2. SameSite Cookies</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">sessionId=abc123; SameSite=Strict; Secure; HttpOnly</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 3. Double Submit Cookie Pattern</span>
<span class="kd">class</span> <span class="nx">DoubleSubmitCookie</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateToken</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setCookie</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">setCookie</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="s2">`csrf-token=</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">}</span><span class="s2">; SameSite=Strict; Secure`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">addTokenToForm</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">tokenInput</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">input</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">tokenInput</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">hidden</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">tokenInput</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">csrf-token</span><span class="dl">"</span><span class="p">;</span>
    <span class="nx">tokenInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
    <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tokenInput</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 4. Custom Headers</span>
<span class="nx">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/update</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">X-CSRF-Token</span><span class="dl">"</span><span class="p">:</span> <span class="nx">csrfToken</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">X-Requested-With</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">XMLHttpRequest</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Q: How do you implement Content Security Policy?</strong>
A: CSP is a security header that controls which resources can be loaded.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
</pre></td><td class="rouge-code"><pre><span class="c1">// 1. Basic CSP Implementation</span>
<span class="kd">const</span> <span class="nx">cspHeader</span> <span class="o">=</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">default-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">script-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">'unsafe-inline'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://cdn.example.com</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">style-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">'unsafe-inline'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://fonts.googleapis.com</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">img-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">data:</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https:</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">font-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://fonts.gstatic.com</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">connect-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https://api.example.com</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">frame-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'none'</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">object-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'none'</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">base-uri</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
  <span class="dl">"</span><span class="s2">form-action</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
<span class="p">};</span>

<span class="c1">// 2. Dynamic CSP for different pages</span>
<span class="kd">class</span> <span class="nx">CSPManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">basePolicy</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">default-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">script-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">style-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">img-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">data:</span><span class="dl">"</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">connect-src</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">],</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">addPolicy</span><span class="p">(</span><span class="nx">page</span><span class="p">,</span> <span class="nx">additionalRules</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">policy</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">basePolicy</span> <span class="p">};</span>

    <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">additionalRules</span><span class="p">).</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">key</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">policy</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">policy</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[...</span><span class="nx">policy</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span> <span class="p">...</span><span class="nx">additionalRules</span><span class="p">[</span><span class="nx">key</span><span class="p">]];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">policy</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">additionalRules</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stringifyPolicy</span><span class="p">(</span><span class="nx">policy</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">stringifyPolicy</span><span class="p">(</span><span class="nx">policy</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">policy</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">map</span><span class="p">(([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">values</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="s2">`</span><span class="p">${</span><span class="nx">key</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">values</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">)}</span><span class="s2">`</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">; </span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// 3. Nonce-based CSP</span>
  <span class="nx">generateNonce</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">crypto</span>
      <span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">val</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">),</span> <span class="dl">""</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">addNonceToScript</span><span class="p">(</span><span class="nx">nonce</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">script</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">nonce</span> <span class="o">=</span> <span class="nx">nonce</span><span class="p">;</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">console.log("Safe script");</span><span class="dl">'</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 4. Hash-based CSP</span>
<span class="kd">class</span> <span class="nx">HashCSP</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hashes</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">addScriptHash</span><span class="p">(</span><span class="nx">scriptContent</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateHash</span><span class="p">(</span><span class="nx">scriptContent</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hashes</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">hash</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">generateHash</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">SHA-256</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">hash</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">hashArray</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">hash</span><span class="p">));</span>
      <span class="k">return</span> <span class="s2">`'sha256-</span><span class="p">${</span><span class="nx">btoa</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(...</span><span class="nx">hashArray</span><span class="p">))}</span><span class="s2">'`</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">getPolicy</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">scriptSrc</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">'self'</span><span class="dl">"</span><span class="p">,</span> <span class="p">...</span><span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hashes</span><span class="p">)];</span>
    <span class="k">return</span> <span class="s2">`script-src </span><span class="p">${</span><span class="nx">scriptSrc</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="advanced-interview-questions">Advanced Interview Questions</h2>

<p><strong>Q: How would you implement secure authentication in a frontend application?</strong>
A: Comprehensive authentication security implementation:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">SecureAuthManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tokenKey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">auth_token</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">refreshTokenKey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">refresh_token</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiryKey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">token_expiry</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 1. Secure token storage</span>
  <span class="nx">storeTokens</span><span class="p">(</span><span class="nx">accessToken</span><span class="p">,</span> <span class="nx">refreshToken</span><span class="p">,</span> <span class="nx">expiresIn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">expiryTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">expiresIn</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>

    <span class="c1">// Store in memory for sensitive operations</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">accessToken</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span> <span class="o">=</span> <span class="nx">refreshToken</span><span class="p">;</span>

    <span class="c1">// Store refresh token in httpOnly cookie (server-side)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setHttpOnlyCookie</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refreshTokenKey</span><span class="p">,</span> <span class="nx">refreshToken</span><span class="p">);</span>

    <span class="c1">// Store expiry time in localStorage</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiryKey</span><span class="p">,</span> <span class="nx">expiryTime</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="c1">// 2. Token validation</span>
  <span class="nx">isTokenValid</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">expiryTime</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiryKey</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">expiryTime</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

    <span class="k">return</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">expiryTime</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// 3. Automatic token refresh</span>
  <span class="k">async</span> <span class="nx">refreshTokenIfNeeded</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isTokenValid</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api/auth/refresh</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">}</span><span class="s2">`</span>
          <span class="p">}</span>
        <span class="p">});</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="p">{</span> <span class="nx">accessToken</span><span class="p">,</span> <span class="nx">expiresIn</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">storeTokens</span><span class="p">(</span><span class="nx">accessToken</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">,</span> <span class="nx">expiresIn</span><span class="p">);</span>
          <span class="k">return</span> <span class="nx">accessToken</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">logout</span><span class="p">();</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Token refresh failed</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">logout</span><span class="p">();</span>
        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 4. Secure logout</span>
  <span class="nx">logout</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiryKey</span><span class="p">);</span>

    <span class="c1">// Clear httpOnly cookie</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">clearHttpOnlyCookie</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refreshTokenKey</span><span class="p">);</span>

    <span class="c1">// Redirect to login</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/login</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 5. Secure API requests</span>
  <span class="k">async</span> <span class="nx">makeSecureRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshTokenIfNeeded</span><span class="p">();</span>

    <span class="kd">const</span> <span class="nx">secureOptions</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">...</span><span class="nx">options</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">token</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">X-Requested-With</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">XMLHttpRequest</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">secureOptions</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">logout</span><span class="p">();</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Unauthorized</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 6. Password strength validation</span>
  <span class="nx">validatePassword</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">requirements</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">minLength</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="na">hasUpperCase</span><span class="p">:</span> <span class="sr">/</span><span class="se">[</span><span class="sr">A-Z</span><span class="se">]</span><span class="sr">/</span><span class="p">,</span>
      <span class="na">hasLowerCase</span><span class="p">:</span> <span class="sr">/</span><span class="se">[</span><span class="sr">a-z</span><span class="se">]</span><span class="sr">/</span><span class="p">,</span>
      <span class="na">hasNumbers</span><span class="p">:</span> <span class="sr">/</span><span class="se">\d</span><span class="sr">/</span><span class="p">,</span>
      <span class="na">hasSpecialChar</span><span class="p">:</span> <span class="sr">/</span><span class="se">[</span><span class="sr">!@#$%^&amp;*(),.?":{}|&lt;&gt;</span><span class="se">]</span><span class="sr">/</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">errors</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">requirements</span><span class="p">.</span><span class="nx">minLength</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`Password must be at least </span><span class="p">${</span><span class="nx">requirements</span><span class="p">.</span><span class="nx">minLength</span><span class="p">}</span><span class="s2"> characters`</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">requirements</span><span class="p">.</span><span class="nx">hasUpperCase</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password must contain at least one uppercase letter</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">requirements</span><span class="p">.</span><span class="nx">hasLowerCase</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password must contain at least one lowercase letter</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">requirements</span><span class="p">.</span><span class="nx">hasNumbers</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password must contain at least one number</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">requirements</span><span class="p">.</span><span class="nx">hasSpecialChar</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password must contain at least one special character</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">isValid</span><span class="p">:</span> <span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">errors</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// 7. Rate limiting for login attempts</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maxAttempts</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lockoutDuration</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">// 15 minutes</span>
  <span class="p">}</span>

  <span class="nx">checkLoginAttempts</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">attempts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="o">||</span> <span class="p">{</span> <span class="na">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">lastAttempt</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">attempts</span><span class="p">.</span><span class="nx">count</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxAttempts</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">timeSinceLastAttempt</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">attempts</span><span class="p">.</span><span class="nx">lastAttempt</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">timeSinceLastAttempt</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">lockoutDuration</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">remainingTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">lockoutDuration</span> <span class="o">-</span> <span class="nx">timeSinceLastAttempt</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">60</span><span class="p">);</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Account temporarily locked. Try again in </span><span class="p">${</span><span class="nx">remainingTime</span><span class="p">}</span><span class="s2"> minutes.`</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Reset attempts after lockout period</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">recordLoginAttempt</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">attempts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="o">||</span> <span class="p">{</span> <span class="na">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">lastAttempt</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">attempts</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
      <span class="nx">attempts</span><span class="p">.</span><span class="nx">lastAttempt</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loginAttempts</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">attempts</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Q: How do you implement secure file uploads?</strong>
A: Secure file upload implementation with validation and scanning:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">SecureFileUpload</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allowedTypes</span> <span class="o">=</span> <span class="p">[</span>
      <span class="dl">"</span><span class="s2">image/jpeg</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">image/png</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">image/gif</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">application/pdf</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span> <span class="c1">// 5MB</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maxFiles</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 1. File type validation</span>
  <span class="nx">validateFileType</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Check MIME type</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">allowedTypes</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">File type not allowed</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Check file extension</span>
    <span class="kd">const</span> <span class="nx">extension</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">).</span><span class="nx">pop</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">allowedExtensions</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">jpg</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">jpeg</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">png</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">gif</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">pdf</span><span class="dl">"</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">allowedExtensions</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">extension</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">File extension not allowed</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Check file signature (magic numbers)</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkFileSignature</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// 2. File signature validation</span>
  <span class="k">async</span> <span class="nx">checkFileSignature</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">signatures</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">image/jpeg</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">image/png</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">image/gif</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">],</span>
      <span class="dl">"</span><span class="s2">application/pdf</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">],</span>
    <span class="p">};</span>

    <span class="kd">const</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">file</span><span class="p">.</span><span class="nx">arrayBuffer</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">expectedSignature</span> <span class="o">=</span> <span class="nx">signatures</span><span class="p">[</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">expectedSignature</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">expectedSignature</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">expectedSignature</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Invalid file signature</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 3. File size validation</span>
  <span class="nx">validateFileSize</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">size</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span>
        <span class="s2">`File size exceeds </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">maxFileSize</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">}</span><span class="s2">MB limit`</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 4. Image processing and sanitization</span>
  <span class="k">async</span> <span class="nx">processImage</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">canvas</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="dl">"</span><span class="s2">2d</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span>

      <span class="nx">img</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// Resize image if too large</span>
        <span class="kd">const</span> <span class="nx">maxWidth</span> <span class="o">=</span> <span class="mi">1920</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">maxHeight</span> <span class="o">=</span> <span class="mi">1080</span><span class="p">;</span>

        <span class="kd">let</span> <span class="p">{</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">img</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">width</span> <span class="o">&gt;</span> <span class="nx">maxWidth</span> <span class="o">||</span> <span class="nx">height</span> <span class="o">&gt;</span> <span class="nx">maxHeight</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">ratio</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">maxWidth</span> <span class="o">/</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">maxHeight</span> <span class="o">/</span> <span class="nx">height</span><span class="p">);</span>
          <span class="nx">width</span> <span class="o">*=</span> <span class="nx">ratio</span><span class="p">;</span>
          <span class="nx">height</span> <span class="o">*=</span> <span class="nx">ratio</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
        <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>

        <span class="c1">// Draw image to canvas (removes any embedded scripts)</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">);</span>

        <span class="c1">// Convert to blob</span>
        <span class="nx">canvas</span><span class="p">.</span><span class="nx">toBlob</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="dl">"</span><span class="s2">image/jpeg</span><span class="dl">"</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="nx">img</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Invalid image file</span><span class="dl">"</span><span class="p">));</span>
      <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// 5. Secure upload with progress</span>
  <span class="k">async</span> <span class="nx">uploadFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">// Validate file</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">validateFileType</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">validateFileSize</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>

      <span class="c1">// Process file if it's an image</span>
      <span class="kd">let</span> <span class="nx">processedFile</span> <span class="o">=</span> <span class="nx">file</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">image/</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">processedFile</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">processImage</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="c1">// Generate secure filename</span>
      <span class="kd">const</span> <span class="nx">secureFilename</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateSecureFilename</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

      <span class="c1">// Create FormData</span>
      <span class="kd">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
      <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">file</span><span class="dl">"</span><span class="p">,</span> <span class="nx">processedFile</span><span class="p">,</span> <span class="nx">secureFilename</span><span class="p">);</span>
      <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">timestamp</span><span class="dl">"</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toString</span><span class="p">());</span>

      <span class="c1">// Upload with progress</span>
      <span class="kd">const</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

      <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">progress</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">lengthComputable</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">progress</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">event</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">;</span>
            <span class="nx">onProgress</span><span class="p">?.(</span><span class="nx">progress</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">xhr</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">load</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">));</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Upload failed</span><span class="dl">"</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">xhr</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Upload failed</span><span class="dl">"</span><span class="p">));</span>
        <span class="p">});</span>

        <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">/api/upload</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">formData</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// 6. Generate secure filename</span>
  <span class="nx">generateSecureFilename</span><span class="p">(</span><span class="nx">originalName</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">extension</span> <span class="o">=</span> <span class="nx">originalName</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">).</span><span class="nx">pop</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">randomString</span> <span class="o">=</span> <span class="nx">crypto</span>
      <span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">val</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">),</span> <span class="dl">""</span><span class="p">);</span>

    <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="nx">timestamp</span><span class="p">}</span><span class="s2">_</span><span class="p">${</span><span class="nx">randomString</span><span class="p">}</span><span class="s2">.</span><span class="p">${</span><span class="nx">extension</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 7. Multiple file upload with validation</span>
  <span class="k">async</span> <span class="nx">uploadMultipleFiles</span><span class="p">(</span><span class="nx">files</span><span class="p">,</span> <span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">validFiles</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">errors</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="c1">// Validate all files first</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">validateFileType</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">validateFileSize</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="nx">validFiles</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">file</span><span class="p">:</span> <span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">,</span> <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">validFiles</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">No valid files to upload</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Upload valid files</span>
    <span class="kd">const</span> <span class="nx">uploadPromises</span> <span class="o">=</span> <span class="nx">validFiles</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">file</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="p">(</span><span class="nx">progress</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">onProgress</span><span class="p">?.(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">progress</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">uploadPromises</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">successful</span><span class="p">:</span> <span class="nx">results</span>
        <span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">fulfilled</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">value</span><span class="p">),</span>
      <span class="na">failed</span><span class="p">:</span> <span class="nx">results</span>
        <span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">rejected</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">reason</span><span class="p">),</span>
      <span class="na">validationErrors</span><span class="p">:</span> <span class="nx">errors</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="practical-problems--solutions">Practical Problems &amp; Solutions</h2>

<h3 id="problem-1-implement-secure-session-management">Problem 1: Implement Secure Session Management</h3>

<p><strong>Challenge</strong>: Create a secure session management system with automatic cleanup and security features.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">SecureSessionManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sessionTimeout</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">// 30 minutes</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maxSessionsPerUser</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cleanupInterval</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">;</span> <span class="c1">// 5 minutes</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">startCleanupTimer</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">createSession</span><span class="p">(</span><span class="nx">userId</span><span class="p">,</span> <span class="nx">userAgent</span><span class="p">,</span> <span class="nx">ipAddress</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Check existing sessions for user</span>
    <span class="kd">const</span> <span class="nx">userSessions</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUserSessions</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">userSessions</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxSessionsPerUser</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Remove oldest session</span>
      <span class="kd">const</span> <span class="nx">oldestSession</span> <span class="o">=</span> <span class="nx">userSessions</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span>
        <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">createdAt</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">createdAt</span>
      <span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">removeSession</span><span class="p">(</span><span class="nx">oldestSession</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateSessionId</span><span class="p">(),</span>
      <span class="nx">userId</span><span class="p">,</span>
      <span class="nx">userAgent</span><span class="p">,</span>
      <span class="nx">ipAddress</span><span class="p">,</span>
      <span class="na">createdAt</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
      <span class="na">lastActivity</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
      <span class="na">isActive</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">session</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">session</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">validateSession</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">,</span> <span class="nx">userAgent</span><span class="p">,</span> <span class="nx">ipAddress</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">session</span> <span class="o">||</span> <span class="o">!</span><span class="nx">session</span><span class="p">.</span><span class="nx">isActive</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Check session timeout</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">session</span><span class="p">.</span><span class="nx">lastActivity</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">sessionTimeout</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">removeSession</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Check for suspicious activity</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">userAgent</span> <span class="o">!==</span> <span class="nx">userAgent</span> <span class="o">||</span> <span class="nx">session</span><span class="p">.</span><span class="nx">ipAddress</span> <span class="o">!==</span> <span class="nx">ipAddress</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">flagSuspiciousActivity</span><span class="p">(</span><span class="nx">session</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Update last activity</span>
    <span class="nx">session</span><span class="p">.</span><span class="nx">lastActivity</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">removeSession</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">getUserSessions</span><span class="p">(</span><span class="nx">userId</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="nx">values</span><span class="p">()).</span><span class="nx">filter</span><span class="p">(</span>
      <span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userId</span> <span class="o">===</span> <span class="nx">userId</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">generateSessionId</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">crypto</span>
      <span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">acc</span> <span class="o">+</span> <span class="nx">val</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">padStart</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">),</span> <span class="dl">""</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">flagSuspiciousActivity</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">session</span><span class="p">.</span><span class="nx">isActive</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="c1">// Log suspicious activity</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">"</span><span class="s2">Suspicious session activity detected:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">session</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">startCleanupTimer</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">cleanupExpiredSessions</span><span class="p">();</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">cleanupInterval</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">cleanupExpiredSessions</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">sessionId</span><span class="p">,</span> <span class="nx">session</span><span class="p">]</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">now</span> <span class="o">-</span> <span class="nx">session</span><span class="p">.</span><span class="nx">lastActivity</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">sessionTimeout</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">removeSession</span><span class="p">(</span><span class="nx">sessionId</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">getSessionStats</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">totalSessions</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">activeSessions</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sessions</span><span class="p">.</span><span class="nx">values</span><span class="p">()).</span><span class="nx">filter</span><span class="p">(</span>
      <span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">session</span><span class="p">.</span><span class="nx">isActive</span>
    <span class="p">).</span><span class="nx">length</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">total</span><span class="p">:</span> <span class="nx">totalSessions</span><span class="p">,</span>
      <span class="na">active</span><span class="p">:</span> <span class="nx">activeSessions</span><span class="p">,</span>
      <span class="na">expired</span><span class="p">:</span> <span class="nx">totalSessions</span> <span class="o">-</span> <span class="nx">activeSessions</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="problem-2-implement-secure-data-encryption">Problem 2: Implement Secure Data Encryption</h3>

<p><strong>Challenge</strong>: Create a client-side encryption system for sensitive data.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">SecureDataEncryption</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">algorithm</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">AES-GCM</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">keyLength</span> <span class="o">=</span> <span class="mi">256</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">generateKey</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">keyMaterial</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">importKey</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">raw</span><span class="dl">"</span><span class="p">,</span>
      <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">password</span><span class="p">),</span>
      <span class="dl">"</span><span class="s2">PBKDF2</span><span class="dl">"</span><span class="p">,</span>
      <span class="kc">false</span><span class="p">,</span>
      <span class="p">[</span><span class="dl">"</span><span class="s2">deriveBits</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">deriveKey</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">);</span>

    <span class="k">return</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">deriveKey</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">PBKDF2</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">salt</span><span class="p">:</span> <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">salt</span><span class="p">),</span>
        <span class="na">iterations</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
        <span class="na">hash</span><span class="p">:</span> <span class="dl">"</span><span class="s2">SHA-256</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="nx">keyMaterial</span><span class="p">,</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">algorithm</span><span class="p">,</span> <span class="na">length</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">keyLength</span> <span class="p">},</span>
      <span class="kc">false</span><span class="p">,</span>
      <span class="p">[</span><span class="dl">"</span><span class="s2">encrypt</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">decrypt</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">encrypt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">iv</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>

    <span class="kd">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateKey</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">encodedData</span> <span class="o">=</span> <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>

    <span class="kd">const</span> <span class="nx">encryptedData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">algorithm</span><span class="p">,</span>
        <span class="na">iv</span><span class="p">:</span> <span class="nx">iv</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="nx">key</span><span class="p">,</span>
      <span class="nx">encodedData</span>
    <span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">data</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">)),</span>
      <span class="na">salt</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">salt</span><span class="p">),</span>
      <span class="na">iv</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">iv</span><span class="p">),</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">decrypt</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateKey</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">encryptedData</span><span class="p">.</span><span class="nx">salt</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">decryptedData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">algorithm</span><span class="p">,</span>
        <span class="na">iv</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">iv</span><span class="p">),</span>
      <span class="p">},</span>
      <span class="nx">key</span><span class="p">,</span>
      <span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
    <span class="p">);</span>

    <span class="kd">const</span> <span class="nx">decoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextDecoder</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">decoder</span><span class="p">.</span><span class="nx">decode</span><span class="p">(</span><span class="nx">decryptedData</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="c1">// Secure storage with encryption</span>
  <span class="k">async</span> <span class="nx">secureStore</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">secureRetrieve</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">key</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">encrypted</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">return</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Secure communication</span>
  <span class="k">async</span> <span class="nx">encryptForTransmission</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">publicKey</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Generate a random AES key for data encryption</span>
    <span class="kd">const</span> <span class="nx">aesKey</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">generateKey</span><span class="p">(</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AES-GCM</span><span class="dl">"</span><span class="p">,</span> <span class="na">length</span><span class="p">:</span> <span class="mi">256</span> <span class="p">},</span>
      <span class="kc">true</span><span class="p">,</span>
      <span class="p">[</span><span class="dl">"</span><span class="s2">encrypt</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">);</span>

    <span class="c1">// Encrypt data with AES key</span>
    <span class="kd">const</span> <span class="nx">iv</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">getRandomValues</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">encodedData</span> <span class="o">=</span> <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>

    <span class="kd">const</span> <span class="nx">encryptedData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AES-GCM</span><span class="dl">"</span><span class="p">,</span> <span class="na">iv</span><span class="p">:</span> <span class="nx">iv</span> <span class="p">},</span>
      <span class="nx">aesKey</span><span class="p">,</span>
      <span class="nx">encodedData</span>
    <span class="p">);</span>

    <span class="c1">// Export AES key and encrypt it with public key</span>
    <span class="kd">const</span> <span class="nx">exportedAesKey</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">exportKey</span><span class="p">(</span><span class="dl">"</span><span class="s2">raw</span><span class="dl">"</span><span class="p">,</span> <span class="nx">aesKey</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">encryptedKey</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">RSA-OAEP</span><span class="dl">"</span> <span class="p">},</span>
      <span class="nx">publicKey</span><span class="p">,</span>
      <span class="nx">exportedAesKey</span>
    <span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="na">encryptedData</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">)),</span>
      <span class="na">encryptedKey</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Uint8Array</span><span class="p">(</span><span class="nx">encryptedKey</span><span class="p">)),</span>
      <span class="na">iv</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">iv</span><span class="p">),</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="security-best-practices">Security Best Practices</h2>

<h3 id="input-validation">Input Validation</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">InputValidator</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="nx">validateEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">emailRegex</span> <span class="o">=</span> <span class="sr">/^</span><span class="se">[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+@</span><span class="se">[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+</span><span class="se">\.[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+$/</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">emailRegex</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">email</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">254</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="nx">validatePassword</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span>
      <span class="sr">/</span><span class="se">[</span><span class="sr">A-Z</span><span class="se">]</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="sr">/</span><span class="se">[</span><span class="sr">a-z</span><span class="se">]</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="sr">/</span><span class="se">\d</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
      <span class="sr">/</span><span class="se">[</span><span class="sr">!@#$%^&amp;*</span><span class="se">]</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="nx">sanitizeHTML</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">div</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">input</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="nx">validateURL</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">parsed</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
      <span class="k">return</span> <span class="p">[</span><span class="dl">"</span><span class="s2">http:</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">https:</span><span class="dl">"</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">parsed</span><span class="p">.</span><span class="nx">protocol</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="security-headers-implementation">Security Headers Implementation</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="c1">// Security headers middleware (server-side)</span>
<span class="kd">const</span> <span class="nx">securityHeaders</span> <span class="o">=</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">Content-Security-Policy</span><span class="dl">"</span><span class="p">:</span>
    <span class="dl">"</span><span class="s2">default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">X-Frame-Options</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DENY</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">X-Content-Type-Options</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">nosniff</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Strict-Transport-Security</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">max-age=31536000; includeSubDomains</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Referrer-Policy</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">strict-origin-when-cross-origin</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Permissions-Policy</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">geolocation=(), microphone=(), camera=()</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>

<span class="c1">// Client-side security checks</span>
<span class="kd">class</span> <span class="nx">SecurityChecker</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="nx">checkSecurityHeaders</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">requiredHeaders</span> <span class="o">=</span> <span class="p">[</span>
      <span class="dl">"</span><span class="s2">content-security-policy</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">x-frame-options</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">x-content-type-options</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="kd">const</span> <span class="nx">missingHeaders</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="nx">requiredHeaders</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">header</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">`meta[http-equiv="</span><span class="p">${</span><span class="nx">header</span><span class="p">}</span><span class="s2">"]`</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">missingHeaders</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">header</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">missingHeaders</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">"</span><span class="s2">Missing security headers:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">missingHeaders</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="nx">checkHTTPS</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">https:</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">location</span><span class="p">.</span><span class="nx">hostname</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">localhost</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Application should be served over HTTPS</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="resources">Resources</h2>

<h3 id="documentation">Documentation</h3>

<ul>
  <li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy</a></li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API">Web Crypto API</a></li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">Security Headers</a></li>
</ul>

<h3 id="tools">Tools</h3>

<ul>
  <li><a href="https://owasp.org/www-project-zap/">OWASP ZAP</a> - Security testing</li>
  <li><a href="https://securityheaders.com/">Security Headers</a> - Header analysis</li>
  <li><a href="https://csp-evaluator.withgoogle.com/">CSP Evaluator</a> - CSP validation</li>
  <li><a href="https://snyk.io/">Snyk</a> - Vulnerability scanning</li>
</ul>

<h3 id="practice-platforms">Practice Platforms</h3>

<ul>
  <li><a href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop</a> - Security training</li>
  <li><a href="https://portswigger.net/web-security">PortSwigger Web Security Academy</a></li>
  <li><a href="https://hackerone.com/">HackerOne</a> - Bug bounty programs</li>
</ul>

<hr />

<p><em>This guide covers essential security concepts for frontend interviews, including practical problems and advanced techniques commonly asked at Big Tech companies.</em></p>

        </div>
    </article>
</div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Study Resources</h3>
                    <p>Comprehensive collection of frontend interview questions, coding challenges, and system design problems.</p>
                </div>
                <div class="footer-section">
                    <h3>Progress Tracking</h3>
                    <p>Monitor your learning journey with detailed progress indicators and completion status.</p>
                </div>
                <div class="footer-section">
                    <h3>Big Tech Ready</h3>
                    <p>Curated content specifically designed for interviews at Google, Meta, Amazon, Apple, and Netflix.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Frontend Interview Hub. Built for aspiring frontend engineers.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/assets/js/main.js"></script>
</body>
</html>