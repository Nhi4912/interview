<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Memory Management and Performance Optimization | Frontend Interview Preparation Guide</title>
    <meta name="description" content="Advanced techniques for JavaScript memory management, performance optimization, and debugging in modern web applications">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>
    <!-- Navigation -->
    <header>
        <nav class="container">
            <div class="logo">Frontend Interview Hub</div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="#progress">Progress</a></li>
                <li><a href="#knowledge">Knowledge</a></li>
                <li><a href="https://github.com/nee/interview">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <div class="content-container">
    
        <nav class="breadcrumb">
            <ol>
                <li><a href="/">Home</a></li>
                
                
                
                    
                
                    
                        
                        
                            <li><a href="/frontend/">Frontend</a></li>
                        
                    
                
                    
                        
                        
                            <li><a href="/frontend/advanced/">Advanced</a></li>
                        
                    
                
                    
                        
                        
                            <li class="active">Javascript memory management and performance optimization</li>
                        
                    
                
            </ol>
        </nav>
    
    
    <article class="content">
        
            <header class="content-header">
                <h1 class="content-title">JavaScript Memory Management and Performance Optimization</h1>
                
                    <p class="content-description">Advanced techniques for JavaScript memory management, performance optimization, and debugging in modern web applications</p>
                
                
            </header>
        
        
        <div class="content-body">
            <h1 id="modern-javascript-memory-management-and-performance-optimization">Modern JavaScript Memory Management and Performance Optimization</h1>

<h2 id="-overview">üéØ Overview</h2>

<p>Memory management and performance optimization are critical topics in frontend interviews at big tech companies. This guide covers advanced concepts from garbage collection to micro-optimizations, enabling you to demonstrate deep JavaScript knowledge.</p>

<h2 id="-javascript-memory-model">üß† JavaScript Memory Model</h2>

<h3 id="1-memory-allocation-and-management">1. Memory Allocation and Management</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
</pre></td><td class="rouge-code"><pre><span class="c1">// Memory allocation visualization</span>
<span class="kd">class</span> <span class="nx">MemoryAnalyzer</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gcCycles</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// Simulate memory allocation tracking</span>
  <span class="nx">trackAllocation</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">reference</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">allocation</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">id</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">(),</span>
      <span class="nx">type</span><span class="p">,</span>
      <span class="nx">size</span><span class="p">,</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
      <span class="nx">reference</span><span class="p">,</span>
      <span class="na">alive</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">allocation</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span> <span class="o">+=</span> <span class="nx">size</span><span class="p">;</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üì¶ Allocated </span><span class="p">${</span><span class="nx">size</span><span class="p">}</span><span class="s2"> bytes for </span><span class="p">${</span><span class="nx">type</span><span class="p">}</span><span class="s2"> (Total: </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span><span class="p">}</span><span class="s2"> bytes)`</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// Simulate garbage collection</span>
  <span class="nx">simulateGC</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üóëÔ∏è  Starting garbage collection...</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">beforeSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">collected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="c1">// Mark and sweep simulation</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">markPhase</span><span class="p">();</span>
    <span class="nx">collected</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sweepPhase</span><span class="p">();</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">gcCycles</span><span class="o">++</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">afterSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span><span class="p">;</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`‚úÖ GC completed: Collected </span><span class="p">${</span><span class="nx">collected</span><span class="p">}</span><span class="s2"> bytes (</span><span class="p">${</span><span class="nx">beforeSize</span><span class="p">}</span><span class="s2"> ‚Üí </span><span class="p">${</span><span class="nx">afterSize</span><span class="p">}</span><span class="s2">)`</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">beforeSize</span><span class="p">,</span>
      <span class="nx">afterSize</span><span class="p">,</span>
      <span class="nx">collected</span><span class="p">,</span>
      <span class="na">gcCycles</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gcCycles</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="nx">markPhase</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üîç Mark phase: Identifying reachable objects...</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// Simulate marking reachable objects</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">allocation</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// Check if object is still referenced</span>
      <span class="kd">const</span> <span class="nx">isReachable</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">isObjectReachable</span><span class="p">(</span><span class="nx">allocation</span><span class="p">);</span>
      <span class="nx">allocation</span><span class="p">.</span><span class="nx">marked</span> <span class="o">=</span> <span class="nx">isReachable</span><span class="p">;</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isReachable</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`  üìç Marked for collection: </span><span class="p">${</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">type</span><span class="p">}</span><span class="s2"> (</span><span class="p">${</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">size</span><span class="p">}</span><span class="s2"> bytes)`</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="nx">sweepPhase</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ Sweep phase: Deallocating unreachable objects...</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">collected</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">id</span><span class="p">,</span> <span class="nx">allocation</span><span class="p">]</span> <span class="k">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">marked</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">collected</span> <span class="o">+=</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span> <span class="o">-=</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`  üóëÔ∏è  Collected: </span><span class="p">${</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">type</span><span class="p">}</span><span class="s2"> (</span><span class="p">${</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">size</span><span class="p">}</span><span class="s2"> bytes)`</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">collected</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">isObjectReachable</span><span class="p">(</span><span class="nx">allocation</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Simplified reachability check</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">reference</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">// Check if reference still exists</span>
      <span class="k">return</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">reference</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">reference</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Memory leak detection</span>
  <span class="nx">detectMemoryLeaks</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üîç Scanning for potential memory leaks...</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">leaks</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">allocation</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">age</span> <span class="o">=</span> <span class="nx">now</span> <span class="o">-</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">;</span>
      
      <span class="c1">// Objects alive for more than 30 seconds might be leaks</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">age</span> <span class="o">&gt;</span> <span class="mi">30000</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">leaks</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
          <span class="nx">id</span><span class="p">,</span>
          <span class="na">type</span><span class="p">:</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
          <span class="na">age</span><span class="p">:</span> <span class="s2">`</span><span class="p">${(</span><span class="nx">age</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span><span class="s2">s`</span><span class="p">,</span>
          <span class="na">size</span><span class="p">:</span> <span class="nx">allocation</span><span class="p">.</span><span class="nx">size</span>
        <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">});</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">leaks</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">‚ö†Ô∏è  Potential memory leaks detected:</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">table</span><span class="p">(</span><span class="nx">leaks</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">‚úÖ No memory leaks detected</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">leaks</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// Memory pressure simulation</span>
  <span class="nx">simulateMemoryPressure</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìä Memory pressure analysis:</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">pressure</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">totalAllocated</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span><span class="p">,</span>
      <span class="na">allocationCount</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
      <span class="na">averageObjectSize</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">allocations</span><span class="p">.</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">gcCycles</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">gcCycles</span><span class="p">,</span>
      <span class="na">pressure</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculatePressure</span><span class="p">()</span>
    <span class="p">};</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">table</span><span class="p">(</span><span class="nx">pressure</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">pressure</span><span class="p">.</span><span class="nx">pressure</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">‚ö†Ô∏è  High memory pressure! Consider optimizing allocations.</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">suggestOptimizations</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">pressure</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">calculatePressure</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Simplified pressure calculation</span>
    <span class="kd">const</span> <span class="nx">maxMemory</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span> <span class="c1">// 100MB limit</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">totalAllocated</span> <span class="o">/</span> <span class="nx">maxMemory</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">suggestOptimizations</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üí° Memory optimization suggestions:</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">  - Use object pooling for frequently created objects</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">  - Implement weak references for caches</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">  - Remove event listeners when no longer needed</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">  - Use streaming for large data processing</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">  - Consider lazy loading for non-critical resources</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage example</span>
<span class="kd">const</span> <span class="nx">memoryAnalyzer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MemoryAnalyzer</span><span class="p">();</span>

<span class="c1">// Simulate different allocation patterns</span>
<span class="kd">const</span> <span class="nx">objRef</span> <span class="o">=</span> <span class="p">{</span> <span class="na">data</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">};</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">trackAllocation</span><span class="p">(</span><span class="dl">'</span><span class="s1">Array</span><span class="dl">'</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="nx">objRef</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">funcRef</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="dl">'</span><span class="s1">example</span><span class="dl">'</span><span class="p">;</span> <span class="p">};</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">trackAllocation</span><span class="p">(</span><span class="dl">'</span><span class="s1">Function</span><span class="dl">'</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">funcRef</span><span class="p">);</span>

<span class="c1">// Simulate memory leak</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">trackAllocation</span><span class="p">(</span><span class="dl">'</span><span class="s1">LeakyObject</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="p">{</span> <span class="na">circular</span><span class="p">:</span> <span class="nx">objRef</span> <span class="p">});</span>

<span class="c1">// Run analysis</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">simulateGC</span><span class="p">();</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">detectMemoryLeaks</span><span class="p">();</span>
<span class="nx">memoryAnalyzer</span><span class="p">.</span><span class="nx">simulateMemoryPressure</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="2-memory-leak-prevention-patterns">2. Memory Leak Prevention Patterns</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
</pre></td><td class="rouge-code"><pre><span class="c1">// Common memory leak patterns and solutions</span>
<span class="kd">class</span> <span class="nx">MemoryLeakPrevention</span> <span class="p">{</span>
  
  <span class="c1">// 1. Event Listener Cleanup</span>
  <span class="kd">static</span> <span class="nx">createSafeEventHandler</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="nx">SafeEventHandler</span> <span class="p">{</span>
      <span class="kd">constructor</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">abortController</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AbortController</span><span class="p">();</span>
      <span class="p">}</span>
      
      <span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
        <span class="c1">// Use AbortController for automatic cleanup</span>
        <span class="kd">const</span> <span class="nx">safeOptions</span> <span class="o">=</span> <span class="p">{</span>
          <span class="p">...</span><span class="nx">options</span><span class="p">,</span>
          <span class="na">signal</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">abortController</span><span class="p">.</span><span class="nx">signal</span>
        <span class="p">};</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="nx">safeOptions</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
        
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`‚úÖ Added event listener: </span><span class="p">${</span><span class="nx">event</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">handler</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üóëÔ∏è  Removed event listener: </span><span class="p">${</span><span class="nx">event</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Clean up all event listeners at once</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">abortController</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ All event listeners cleaned up</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">SafeEventHandler</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// 2. WeakMap/WeakSet for Caching</span>
  <span class="kd">static</span> <span class="nx">createWeakCache</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">class</span> <span class="nx">WeakCache</span> <span class="p">{</span>
      <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">WeakMap</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">metadata</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span> <span class="c1">// For debugging only</span>
      <span class="p">}</span>
      
      <span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">key</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">key</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">WeakMap keys must be objects</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">timestamp</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span>
          <span class="na">accessed</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">});</span>
        
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìù Cached value with weak reference</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">meta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">meta</span><span class="p">.</span><span class="nx">accessed</span><span class="o">++</span><span class="p">;</span>
            <span class="nx">meta</span><span class="p">.</span><span class="nx">lastAccessed</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="c1">// Note: WeakMap doesn't have size/forEach, so this is for demonstration</span>
      <span class="nx">getStats</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
          <span class="na">metadataEntries</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
          <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Actual cache size unknown (WeakMap limitation)</span><span class="dl">'</span>
        <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="c1">// 3. Closure Memory Management</span>
  <span class="kd">static</span> <span class="nx">createSafeClosures</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Bad: Creates memory leak</span>
    <span class="kd">function</span> <span class="nx">createLeakyClosures</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">hugeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">);</span>
      
      <span class="k">return</span> <span class="p">{</span>
        <span class="c1">// This closure holds reference to entire hugeData</span>
        <span class="na">getFirst</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">hugeData</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="c1">// This too</span>
        <span class="na">getLast</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">hugeData</span><span class="p">[</span><span class="nx">hugeData</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
      <span class="p">};</span>
    <span class="p">}</span>
    
    <span class="c1">// Good: Extracts needed data</span>
    <span class="kd">function</span> <span class="nx">createSafeClosures</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">hugeData</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">);</span>
      
      <span class="c1">// Extract only what's needed</span>
      <span class="kd">const</span> <span class="nx">firstItem</span> <span class="o">=</span> <span class="nx">hugeData</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="kd">const</span> <span class="nx">lastItem</span> <span class="o">=</span> <span class="nx">hugeData</span><span class="p">[</span><span class="nx">hugeData</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
      
      <span class="c1">// hugeData can now be garbage collected</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">getFirst</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">firstItem</span><span class="p">,</span>
        <span class="na">getLast</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">lastItem</span>
      <span class="p">};</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span> <span class="nx">createLeakyClosures</span><span class="p">,</span> <span class="nx">createSafeClosures</span> <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="c1">// 4. Timer Cleanup</span>
  <span class="kd">static</span> <span class="nx">createSafeTimer</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">class</span> <span class="nx">SafeTimer</span> <span class="p">{</span>
      <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intervals</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
      <span class="p">}</span>
      
      <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">timerId</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">callback</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
        <span class="p">},</span> <span class="nx">delay</span><span class="p">);</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">timerId</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">setInterval</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">interval</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">intervalId</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">interval</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intervals</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">intervalId</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">intervalId</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timerId</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalId</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalId</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intervals</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">intervalId</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">clearAll</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Clean up all timers and intervals</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">id</span> <span class="o">=&gt;</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intervals</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">id</span> <span class="o">=&gt;</span> <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">intervals</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
        
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ All timers and intervals cleared</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="c1">// 5. DOM Reference Management</span>
  <span class="kd">static</span> <span class="nx">createSafeDOMManager</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">class</span> <span class="nx">SafeDOMManager</span> <span class="p">{</span>
      <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">elements</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">WeakSet</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
      <span class="p">}</span>
      
      <span class="nx">createElement</span><span class="p">(</span><span class="nx">tag</span><span class="p">,</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">tag</span><span class="p">);</span>
        <span class="nx">parent</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">elements</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
        
        <span class="c1">// Add cleanup on removal</span>
        <span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MutationObserver</span><span class="p">((</span><span class="nx">mutations</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">mutations</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">mutation</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">mutation</span><span class="p">.</span><span class="nx">removedNodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">node</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="o">===</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">cleanup</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
              <span class="p">}</span>
            <span class="p">});</span>
          <span class="p">});</span>
        <span class="p">});</span>
        
        <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="p">{</span> <span class="na">childList</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">cleanup</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Remove all event listeners</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ Element cleaned up</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">observer</span> <span class="o">=&gt;</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">());</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ DOM manager destroyed</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="-performance-optimization-techniques">‚ö° Performance Optimization Techniques</h2>

<h3 id="1-object-pooling">1. Object Pooling</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre></td><td class="rouge-code"><pre><span class="c1">// Object pooling for performance optimization</span>
<span class="kd">class</span> <span class="nx">ObjectPool</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">createFn</span><span class="p">,</span> <span class="nx">resetFn</span><span class="p">,</span> <span class="nx">initialSize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">createFn</span> <span class="o">=</span> <span class="nx">createFn</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resetFn</span> <span class="o">=</span> <span class="nx">resetFn</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pool</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
    
    <span class="c1">// Pre-populate pool</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">initialSize</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">createFn</span><span class="p">());</span>
    <span class="p">}</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üèä‚Äç‚ôÇÔ∏è Object pool initialized with </span><span class="p">${</span><span class="nx">initialSize</span><span class="p">}</span><span class="s2"> objects`</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">acquire</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">obj</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`‚ôªÔ∏è  Reused object from pool (</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2"> remaining)`</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createFn</span><span class="p">();</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üÜï Created new object (pool exhausted)</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">release</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">‚ö†Ô∏è  Attempted to release object not from this pool</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resetFn</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üîÑ Object returned to pool (</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2"> available)`</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">getStats</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">poolSize</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">activeObjects</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
      <span class="na">totalCreated</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">pool</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">activeObjects</span><span class="p">.</span><span class="nx">size</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Example: Vector3 object pool for 3D graphics</span>
<span class="kd">class</span> <span class="nx">Vector3Pool</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="nx">instance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  
  <span class="kd">static</span> <span class="nx">getInstance</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ObjectPool</span><span class="p">(</span>
        <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">Vector3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="nx">vector</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">vector</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="mi">50</span> <span class="c1">// Initial pool size</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">instance</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Vector3</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="kd">set</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">add</span><span class="p">(</span><span class="nx">other</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">other</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">other</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">z</span> <span class="o">+=</span> <span class="nx">other</span><span class="p">.</span><span class="nx">z</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="kd">static</span> <span class="nx">create</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">().</span><span class="nx">acquire</span><span class="p">().</span><span class="kd">set</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">().</span><span class="nx">release</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage example</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üéÆ Vector3 pooling demonstration:</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">vectors</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">vector</span> <span class="o">=</span> <span class="nx">Vector3</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">);</span>
  <span class="nx">vectors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">vector</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Pool stats after creation:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">().</span><span class="nx">getStats</span><span class="p">());</span>

<span class="c1">// Release vectors back to pool</span>
<span class="nx">vectors</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">vector</span> <span class="o">=&gt;</span> <span class="nx">vector</span><span class="p">.</span><span class="nx">destroy</span><span class="p">());</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Pool stats after release:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">Vector3Pool</span><span class="p">.</span><span class="nx">getInstance</span><span class="p">().</span><span class="nx">getStats</span><span class="p">());</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="2-lazy-loading-and-code-splitting">2. Lazy Loading and Code Splitting</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
</pre></td><td class="rouge-code"><pre><span class="c1">// Advanced lazy loading implementation</span>
<span class="kd">class</span> <span class="nx">LazyLoader</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="c1">// Lazy load modules with caching</span>
  <span class="k">async</span> <span class="nx">loadModule</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span>
      <span class="nx">timeout</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
      <span class="nx">retries</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
      <span class="nx">preload</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
    
    <span class="c1">// Check cache first</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üìã Module loaded from cache: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">// Check if already loading</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`‚è≥ Module already loading: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üì¶ Loading module: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">loadPromise</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadWithRetry</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">,</span> <span class="nx">retries</span><span class="p">,</span> <span class="nx">timeout</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">,</span> <span class="nx">loadPromise</span><span class="p">);</span>
    
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">module</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">loadPromise</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">,</span> <span class="nx">module</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">);</span>
      
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`‚úÖ Module loaded successfully: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">module</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">`‚ùå Failed to load module: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
      <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">async</span> <span class="nx">loadWithRetry</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">,</span> <span class="nx">retries</span><span class="p">,</span> <span class="nx">timeout</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">attempt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">attempt</span> <span class="o">&lt;=</span> <span class="nx">retries</span><span class="p">;</span> <span class="nx">attempt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AbortController</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">timeoutId</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">abort</span><span class="p">(),</span> <span class="nx">timeout</span><span class="p">);</span>
        
        <span class="c1">// Dynamic import with timeout</span>
        <span class="kd">const</span> <span class="nx">module</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
          <span class="k">import</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">),</span>
          <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">controller</span><span class="p">.</span><span class="nx">signal</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">abort</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Module load timeout: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">));</span>
            <span class="p">});</span>
          <span class="p">})</span>
        <span class="p">]);</span>
        
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutId</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">module</span><span class="p">;</span>
        
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">`‚ö†Ô∏è  Attempt </span><span class="p">${</span><span class="nx">attempt</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">retries</span><span class="p">}</span><span class="s2"> failed for </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">:`</span><span class="p">,</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">attempt</span> <span class="o">===</span> <span class="nx">retries</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1">// Exponential backoff</span>
        <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nx">attempt</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Preload modules based on user interaction</span>
  <span class="nx">setupPreloading</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Preload on hover</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseover</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">preloadPath</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">preload</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">preloadPath</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">preloadPath</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üöÄ Preloading on hover: </span><span class="p">${</span><span class="nx">preloadPath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loadModule</span><span class="p">(</span><span class="nx">preloadPath</span><span class="p">).</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{});</span> <span class="c1">// Silent fail for preloads</span>
      <span class="p">}</span>
    <span class="p">});</span>
    
    <span class="c1">// Preload on intersection (for viewport visibility)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupIntersectionPreloading</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="nx">setupIntersectionPreloading</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IntersectionObserver</span><span class="p">((</span><span class="nx">entries</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">entries</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">entry</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isIntersecting</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">preloadPath</span> <span class="o">=</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">preloadOnVisible</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">preloadPath</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">preloadPath</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üëÅÔ∏è  Preloading on visibility: </span><span class="p">${</span><span class="nx">preloadPath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">loadModule</span><span class="p">(</span><span class="nx">preloadPath</span><span class="p">).</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{});</span>
            <span class="nx">observer</span><span class="p">.</span><span class="nx">unobserve</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">},</span> <span class="p">{</span> <span class="na">threshold</span><span class="p">:</span> <span class="mf">0.1</span> <span class="p">});</span>
    
    <span class="c1">// Observe elements with preload attributes</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-preload-on-visible]</span><span class="dl">'</span><span class="p">).</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">el</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// Intelligent prefetching based on user behavior</span>
  <span class="nx">setupIntelligentPrefetching</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userBehavior</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">clickPatterns</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">(),</span>
      <span class="na">navigationHistory</span><span class="p">:</span> <span class="p">[],</span>
      <span class="na">preferences</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">()</span>
    <span class="p">};</span>
    
    <span class="c1">// Track user navigation patterns</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="dl">'</span><span class="s1">a[href]</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">link</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">href</span><span class="dl">'</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">userBehavior</span><span class="p">.</span><span class="nx">clickPatterns</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">href</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">userBehavior</span><span class="p">.</span><span class="nx">clickPatterns</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">href</span><span class="p">,</span> <span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        
        <span class="c1">// Prefetch frequently visited pages</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">modulePath</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModuleForRoute</span><span class="p">(</span><span class="nx">href</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">modulePath</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üß† Intelligent prefetch: </span><span class="p">${</span><span class="nx">modulePath</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">loadModule</span><span class="p">(</span><span class="nx">modulePath</span><span class="p">).</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{});</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="nx">userBehavior</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">getModuleForRoute</span><span class="p">(</span><span class="nx">route</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Map routes to modules (simplified)</span>
    <span class="kd">const</span> <span class="nx">routeMap</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">/dashboard</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./modules/dashboard.js</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">/profile</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./modules/profile.js</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">/settings</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./modules/settings.js</span><span class="dl">'</span>
    <span class="p">};</span>
    
    <span class="k">return</span> <span class="nx">routeMap</span><span class="p">[</span><span class="nx">route</span><span class="p">];</span>
  <span class="p">}</span>
  
  <span class="c1">// Memory management for cache</span>
  <span class="nx">limitCacheSize</span><span class="p">(</span><span class="nx">maxSize</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">size</span> <span class="o">&gt;</span> <span class="nx">maxSize</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">entries</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">entries</span><span class="p">());</span>
      <span class="kd">const</span> <span class="nx">toRemove</span> <span class="o">=</span> <span class="nx">entries</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">size</span> <span class="o">-</span> <span class="nx">maxSize</span><span class="p">);</span>
      
      <span class="nx">toRemove</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(([</span><span class="nx">key</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üóëÔ∏è  Removed from cache: </span><span class="p">${</span><span class="nx">key</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">getStats</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">cacheSize</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
      <span class="na">currentlyLoading</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
      <span class="na">cachedModules</span><span class="p">:</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">keys</span><span class="p">())</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">observer</span> <span class="o">=&gt;</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cache</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loading</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage example</span>
<span class="kd">const</span> <span class="nx">lazyLoader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LazyLoader</span><span class="p">();</span>
<span class="nx">lazyLoader</span><span class="p">.</span><span class="nx">setupPreloading</span><span class="p">();</span>
<span class="nx">lazyLoader</span><span class="p">.</span><span class="nx">setupIntelligentPrefetching</span><span class="p">();</span>

<span class="c1">// Example of lazy loading a component</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">loadDashboard</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">dashboardModule</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">lazyLoader</span><span class="p">.</span><span class="nx">loadModule</span><span class="p">(</span><span class="dl">'</span><span class="s1">./dashboard.js</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">Dashboard</span> <span class="o">=</span> <span class="nx">dashboardModule</span><span class="p">.</span><span class="k">default</span><span class="p">;</span>
    
    <span class="c1">// Render dashboard</span>
    <span class="kd">const</span> <span class="nx">dashboardInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dashboard</span><span class="p">();</span>
    <span class="nx">dashboardInstance</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
    
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Failed to load dashboard:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="3-virtual-scrolling-implementation">3. Virtual Scrolling Implementation</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
</pre></td><td class="rouge-code"><pre><span class="c1">// High-performance virtual scrolling</span>
<span class="kd">class</span> <span class="nx">VirtualScrollList</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nx">container</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">itemHeight</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="na">bufferSize</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="na">itemRenderer</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="na">estimateHeight</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="p">...</span><span class="nx">options</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">containerHeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">visibleItems</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">elementPool</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupContainer</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupScrollHandler</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">measureContainer</span><span class="p">();</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìú Virtual scroll list initialized</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">setupContainer</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">overflow</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">auto</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">relative</span><span class="dl">'</span><span class="p">;</span>
    
    <span class="c1">// Create scrollable content</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollContent</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollContent</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">relative</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollContent</span><span class="p">);</span>
    
    <span class="c1">// Create viewport for visible items</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">absolute</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">100%</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollContent</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">setupScrollHandler</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">ticking</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">scroll</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ticking</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">requestAnimationFrame</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">handleScroll</span><span class="p">();</span>
          <span class="nx">ticking</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="nx">ticking</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="nx">measureContainer</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">containerHeight</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">setData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">updateScrollHeight</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">updateVisibleItems</span><span class="p">();</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üìä Virtual scroll data set: </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2"> items`</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">updateScrollHeight</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">totalHeight</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollContent</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">totalHeight</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">handleScroll</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">updateVisibleItems</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="nx">updateVisibleItems</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">startIndex</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">endIndex</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
      <span class="nx">startIndex</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">containerHeight</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">),</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="p">);</span>
    
    <span class="c1">// Add buffer</span>
    <span class="kd">const</span> <span class="nx">bufferedStart</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">startIndex</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">bufferSize</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">bufferedEnd</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">endIndex</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">bufferSize</span><span class="p">);</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">renderVisibleItems</span><span class="p">(</span><span class="nx">bufferedStart</span><span class="p">,</span> <span class="nx">bufferedEnd</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">renderVisibleItems</span><span class="p">(</span><span class="nx">startIndex</span><span class="p">,</span> <span class="nx">endIndex</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Performance measurement</span>
    <span class="kd">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="c1">// Clear existing items</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">clearViewport</span><span class="p">();</span>
    
    <span class="c1">// Render visible items</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">startIndex</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">endIndex</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">renderItem</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">const</span> <span class="nx">renderTime</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">renderTime</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// More than one frame</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">`‚ö†Ô∏è  Slow render: </span><span class="p">${</span><span class="nx">renderTime</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span><span class="s2">ms for </span><span class="p">${</span><span class="nx">endIndex</span> <span class="o">-</span> <span class="nx">startIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2"> items`</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">renderItem</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    
    <span class="c1">// Get element from pool or create new</span>
    <span class="kd">let</span> <span class="nx">element</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getElementFromPool</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">element</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createElement</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="c1">// Position element</span>
    <span class="kd">const</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">absolute</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">top</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">right</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">}</span><span class="s2">px`</span><span class="p">;</span>
    
    <span class="c1">// Render content</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemRenderer</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemRenderer</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">createElement</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">boxSizing</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">border-box</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">padding</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">8px 16px</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">borderBottom</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">1px solid #eee</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">getElementFromPool</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">elementPool</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="nx">returnElementToPool</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Clean element</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">elementPool</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">clearViewport</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Return elements to pool</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">viewport</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">returnElementToPool</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="c1">// Performance monitoring</span>
  <span class="nx">getPerformanceStats</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">dataSize</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">renderedElements</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span>
      <span class="na">poolSize</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">elementPool</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">containerHeight</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">containerHeight</span><span class="p">,</span>
      <span class="na">scrollTop</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">,</span>
      <span class="na">itemHeight</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="c1">// Scroll to specific item</span>
  <span class="nx">scrollToItem</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">targetScrollTop</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">targetScrollTop</span><span class="p">;</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`üìç Scrolled to item </span><span class="p">${</span><span class="nx">index</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// Dynamic height estimation (for variable height items)</span>
  <span class="nx">estimateItemHeight</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">estimateHeight</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemHeight</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// Create temporary element to measure</span>
    <span class="kd">const</span> <span class="nx">tempElement</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createElement</span><span class="p">();</span>
    <span class="nx">tempElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hidden</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">tempElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">absolute</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">tempElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-9999px</span><span class="dl">'</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemRenderer</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">itemRenderer</span><span class="p">(</span><span class="nx">tempElement</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="nx">index</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tempElement</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">tempElement</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">tempElement</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="nx">height</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">clearViewport</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">elementPool</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderedElements</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üßπ Virtual scroll list destroyed</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage example with performance monitoring</span>
<span class="kd">function</span> <span class="nx">createVirtualScrollDemo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">virtual-scroll-container</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">virtualList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VirtualScrollList</span><span class="p">(</span><span class="nx">container</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">itemHeight</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="na">bufferSize</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="na">itemRenderer</span><span class="p">:</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">`
        &lt;div style="display: flex; align-items: center; height: 100%;"&gt;
          &lt;div style="width: 40px; height: 40px; background: #007bff; border-radius: 50%; margin-right: 12px;"&gt;&lt;/div&gt;
          &lt;div&gt;
            &lt;div style="font-weight: bold;"&gt;</span><span class="p">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">&lt;/div&gt;
            &lt;div style="color: #666; font-size: 14px;"&gt;</span><span class="p">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">email</span><span class="p">}</span><span class="s2">&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      `</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>
  
  <span class="c1">// Generate large dataset</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">({</span> <span class="na">length</span><span class="p">:</span> <span class="mi">100000</span> <span class="p">},</span> <span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
    <span class="na">id</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="s2">`User </span><span class="p">${</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="s2">`user</span><span class="p">${</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">@example.com`</span>
  <span class="p">}));</span>
  
  <span class="nx">virtualList</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  
  <span class="c1">// Performance monitoring</span>
  <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">stats</span> <span class="o">=</span> <span class="nx">virtualList</span><span class="p">.</span><span class="nx">getPerformanceStats</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìä Virtual scroll stats:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">stats</span><span class="p">);</span>
  <span class="p">},</span> <span class="mi">5000</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="nx">virtualList</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="-performance-monitoring-and-debugging">üîç Performance Monitoring and Debugging</h2>

<h3 id="1-advanced-performance-profiling">1. Advanced Performance Profiling</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
</pre></td><td class="rouge-code"><pre><span class="c1">// Comprehensive performance profiler</span>
<span class="kd">class</span> <span class="nx">PerformanceProfiler</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isRecording</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">startProfiling</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isRecording</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setupObservers</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">markStart</span><span class="p">(</span><span class="dl">'</span><span class="s1">total-profiling</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üéØ Performance profiling started</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">stopProfiling</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">isRecording</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">markEnd</span><span class="p">(</span><span class="dl">'</span><span class="s1">total-profiling</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">disconnectObservers</span><span class="p">();</span>
    
    <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateReport</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìä Performance profiling completed</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="nx">report</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">setupObservers</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Long task observer</span>
    <span class="kd">const</span> <span class="nx">longTaskObserver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceObserver</span><span class="p">((</span><span class="nx">list</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">list</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">recordLongTask</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">longTaskObserver</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span> <span class="na">entryTypes</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">longtask</span><span class="dl">'</span><span class="p">]</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">longTaskObserver</span><span class="p">);</span>
    
    <span class="c1">// Layout shift observer</span>
    <span class="kd">const</span> <span class="nx">layoutShiftObserver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceObserver</span><span class="p">((</span><span class="nx">list</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">list</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">entry</span><span class="p">.</span><span class="nx">hadRecentInput</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">recordLayoutShift</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">layoutShiftObserver</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span> <span class="na">entryTypes</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">layout-shift</span><span class="dl">'</span><span class="p">]</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">layoutShiftObserver</span><span class="p">);</span>
    
    <span class="c1">// Paint observer</span>
    <span class="kd">const</span> <span class="nx">paintObserver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceObserver</span><span class="p">((</span><span class="nx">list</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">list</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">recordPaintTiming</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">paintObserver</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span> <span class="na">entryTypes</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">paint</span><span class="dl">'</span><span class="p">]</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">paintObserver</span><span class="p">);</span>
    
    <span class="c1">// Navigation observer</span>
    <span class="kd">const</span> <span class="nx">navigationObserver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceObserver</span><span class="p">((</span><span class="nx">list</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entry</span> <span class="k">of</span> <span class="nx">list</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">recordNavigationTiming</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">navigationObserver</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span> <span class="na">entryTypes</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">navigation</span><span class="dl">'</span><span class="p">]</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">navigationObserver</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">disconnectObservers</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">observer</span> <span class="o">=&gt;</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="c1">// Mark and measure API</span>
  <span class="nx">markStart</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">performance</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">-start`</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">markers</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">name</span><span class="p">,</span> <span class="na">start</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="p">});</span>
  <span class="p">}</span>
  
  <span class="nx">markEnd</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">performance</span><span class="p">.</span><span class="nx">mark</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">-end`</span><span class="p">);</span>
    <span class="nx">performance</span><span class="p">.</span><span class="nx">measure</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="s2">`</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">-start`</span><span class="p">,</span> <span class="s2">`</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">-end`</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">markers</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">name</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">marker</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">marker</span><span class="p">.</span><span class="nx">end</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="nx">marker</span><span class="p">.</span><span class="nx">duration</span> <span class="o">=</span> <span class="nx">marker</span><span class="p">.</span><span class="nx">end</span> <span class="o">-</span> <span class="nx">marker</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// Time function execution</span>
  <span class="nx">timeFunction</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">anonymous</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">markStart</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
      
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="k">instanceof</span> <span class="nb">Promise</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="k">finally</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">markEnd</span><span class="p">(</span><span class="nx">name</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">markEnd</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
          <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">markEnd</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="c1">// Record different types of performance events</span>
  <span class="nx">recordLongTask</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">longTask</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">longtask</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">startTime</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">startTime</span><span class="p">,</span>
      <span class="na">duration</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">duration</span><span class="p">,</span>
      <span class="na">attribution</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">attribution</span> <span class="p">?</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">attribution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">longTasks</span><span class="dl">'</span><span class="p">,</span> <span class="nx">longTask</span><span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">duration</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">`‚ö†Ô∏è  Very long task detected: </span><span class="p">${</span><span class="nx">entry</span><span class="p">.</span><span class="nx">duration</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)}</span><span class="s2">ms`</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">recordLayoutShift</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">layoutShift</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">layout-shift</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="na">startTime</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">startTime</span><span class="p">,</span>
      <span class="na">sources</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">sources</span><span class="p">?.</span><span class="nx">map</span><span class="p">(</span><span class="nx">source</span> <span class="o">=&gt;</span> <span class="p">({</span>
        <span class="na">node</span><span class="p">:</span> <span class="nx">source</span><span class="p">.</span><span class="nx">node</span><span class="p">,</span>
        <span class="na">previousRect</span><span class="p">:</span> <span class="nx">source</span><span class="p">.</span><span class="nx">previousRect</span><span class="p">,</span>
        <span class="na">currentRect</span><span class="p">:</span> <span class="nx">source</span><span class="p">.</span><span class="nx">currentRect</span>
      <span class="p">}))</span> <span class="o">||</span> <span class="p">[]</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">layoutShifts</span><span class="dl">'</span><span class="p">,</span> <span class="nx">layoutShift</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">recordPaintTiming</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">paintTiming</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">paint</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
      <span class="na">startTime</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">startTime</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">paintTimings</span><span class="dl">'</span><span class="p">,</span> <span class="nx">paintTiming</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">recordNavigationTiming</span><span class="p">(</span><span class="nx">entry</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">navigation</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">navigation</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">domContentLoaded</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">domContentLoadedEventEnd</span> <span class="o">-</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">domContentLoadedEventStart</span><span class="p">,</span>
      <span class="na">loadComplete</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">loadEventEnd</span> <span class="o">-</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">loadEventStart</span><span class="p">,</span>
      <span class="na">domInteractive</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">domInteractive</span> <span class="o">-</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">fetchStart</span><span class="p">,</span>
      <span class="na">firstByte</span><span class="p">:</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">responseStart</span> <span class="o">-</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">requestStart</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">navigation</span><span class="dl">'</span><span class="p">,</span> <span class="nx">navigation</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">addMeasurement</span><span class="p">(</span><span class="nx">category</span><span class="p">,</span> <span class="nx">measurement</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">category</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">category</span><span class="p">,</span> <span class="p">[]);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">category</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="nx">measurement</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// Memory profiling</span>
  <span class="nx">profileMemory</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">‚ö†Ô∏è  Performance.memory not available</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">const</span> <span class="nx">memory</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">used</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">usedJSHeapSize</span><span class="p">,</span>
      <span class="na">total</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">totalJSHeapSize</span><span class="p">,</span>
      <span class="na">limit</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">jsHeapSizeLimit</span><span class="p">,</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
    <span class="p">};</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">memory</span><span class="dl">'</span><span class="p">,</span> <span class="nx">memory</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">memory</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c1">// Frame rate monitoring</span>
  <span class="nx">startFrameRateMonitoring</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">frameCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">lastTime</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="kd">const</span> <span class="nx">measureFrame</span> <span class="o">=</span> <span class="p">(</span><span class="nx">currentTime</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">frameCount</span><span class="o">++</span><span class="p">;</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">currentTime</span> <span class="o">-</span> <span class="nx">lastTime</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">fps</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nx">frameCount</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nx">currentTime</span> <span class="o">-</span> <span class="nx">lastTime</span><span class="p">));</span>
        
        <span class="k">this</span><span class="p">.</span><span class="nx">addMeasurement</span><span class="p">(</span><span class="dl">'</span><span class="s1">frameRate</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
          <span class="nx">fps</span><span class="p">,</span>
          <span class="na">timestamp</span><span class="p">:</span> <span class="nx">currentTime</span>
        <span class="p">});</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">fps</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">`‚ö†Ô∏è  Low frame rate detected: </span><span class="p">${</span><span class="nx">fps</span><span class="p">}</span><span class="s2"> FPS`</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="nx">frameCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">lastTime</span> <span class="o">=</span> <span class="nx">currentTime</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isRecording</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">measureFrame</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">measureFrame</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// Generate comprehensive report</span>
  <span class="nx">generateReport</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">summary</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateSummary</span><span class="p">(),</span>
      <span class="na">markers</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">markers</span><span class="p">,</span>
      <span class="na">longTasks</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">longTasks</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[],</span>
      <span class="na">layoutShifts</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">layoutShifts</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[],</span>
      <span class="na">paintTimings</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">paintTimings</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[],</span>
      <span class="na">memory</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">memory</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[],</span>
      <span class="na">frameRate</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">frameRate</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[],</span>
      <span class="na">recommendations</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateRecommendations</span><span class="p">()</span>
    <span class="p">};</span>
    
    <span class="k">return</span> <span class="nx">report</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">generateSummary</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">longTasks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">longTasks</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">layoutShifts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">layoutShifts</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">memory</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">memory</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">frameRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">measurements</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">frameRate</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">totalLongTasks</span><span class="p">:</span> <span class="nx">longTasks</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">maxTaskDuration</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">longTasks</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">t</span> <span class="o">=&gt;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">duration</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
      <span class="na">totalLayoutShiftScore</span><span class="p">:</span> <span class="nx">layoutShifts</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">shift</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">shift</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="na">averageMemoryUsage</span><span class="p">:</span> <span class="nx">memory</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> 
        <span class="p">?</span> <span class="nx">memory</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">m</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">used</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="nx">memory</span><span class="p">.</span><span class="nx">length</span> 
        <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">averageFPS</span><span class="p">:</span> <span class="nx">frameRate</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> 
        <span class="p">?</span> <span class="nx">frameRate</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">sum</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">f</span><span class="p">.</span><span class="nx">fps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="nx">frameRate</span><span class="p">.</span><span class="nx">length</span> 
        <span class="p">:</span> <span class="mi">0</span>
    <span class="p">};</span>
  <span class="p">}</span>
  
  <span class="nx">generateRecommendations</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">recommendations</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">summary</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateSummary</span><span class="p">();</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">summary</span><span class="p">.</span><span class="nx">totalLongTasks</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">recommendations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">performance</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">severity</span><span class="p">:</span> <span class="dl">'</span><span class="s1">high</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">High number of long tasks detected. Consider code splitting or optimizing heavy operations.</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">metric</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">summary</span><span class="p">.</span><span class="nx">totalLongTasks</span><span class="p">}</span><span class="s2"> long tasks`</span>
      <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">summary</span><span class="p">.</span><span class="nx">totalLayoutShiftScore</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">recommendations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">layout</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">severity</span><span class="p">:</span> <span class="dl">'</span><span class="s1">medium</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Cumulative Layout Shift score is high. Reserve space for dynamic content.</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">metric</span><span class="p">:</span> <span class="s2">`CLS: </span><span class="p">${</span><span class="nx">summary</span><span class="p">.</span><span class="nx">totalLayoutShiftScore</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">3</span><span class="p">)}</span><span class="s2">`</span>
      <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">summary</span><span class="p">.</span><span class="nx">averageFPS</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">recommendations</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">rendering</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">severity</span><span class="p">:</span> <span class="dl">'</span><span class="s1">high</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Low frame rate detected. Optimize animations and reduce main thread work.</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">metric</span><span class="p">:</span> <span class="s2">`Average FPS: </span><span class="p">${</span><span class="nx">summary</span><span class="p">.</span><span class="nx">averageFPS</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span><span class="s2">`</span>
      <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">recommendations</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="nx">exportReport</span><span class="p">(</span><span class="nx">format</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">json</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">generateReport</span><span class="p">();</span>
    
    <span class="k">switch</span> <span class="p">(</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">json</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">report</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">csv</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">convertToCSV</span><span class="p">(</span><span class="nx">report</span><span class="p">);</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">report</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="nx">convertToCSV</span><span class="p">(</span><span class="nx">report</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Simplified CSV conversion</span>
    <span class="kd">const</span> <span class="nx">lines</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">Category,Value,Timestamp</span><span class="dl">'</span><span class="p">];</span>
    
    <span class="nx">report</span><span class="p">.</span><span class="nx">longTasks</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">task</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">lines</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`Long Task,</span><span class="p">${</span><span class="nx">task</span><span class="p">.</span><span class="nx">duration</span><span class="p">}</span><span class="s2">,</span><span class="p">${</span><span class="nx">task</span><span class="p">.</span><span class="nx">startTime</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="nx">report</span><span class="p">.</span><span class="nx">layoutShifts</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">shift</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">lines</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`Layout Shift,</span><span class="p">${</span><span class="nx">shift</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="s2">,</span><span class="p">${</span><span class="nx">shift</span><span class="p">.</span><span class="nx">startTime</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage example</span>
<span class="kd">const</span> <span class="nx">profiler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceProfiler</span><span class="p">();</span>

<span class="c1">// Start profiling</span>
<span class="nx">profiler</span><span class="p">.</span><span class="nx">startProfiling</span><span class="p">();</span>
<span class="nx">profiler</span><span class="p">.</span><span class="nx">startFrameRateMonitoring</span><span class="p">();</span>

<span class="c1">// Profile specific functions</span>
<span class="kd">const</span> <span class="nx">optimizedFunction</span> <span class="o">=</span> <span class="nx">profiler</span><span class="p">.</span><span class="nx">timeFunction</span><span class="p">(</span><span class="kd">function</span> <span class="nx">expensiveOperation</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Simulate expensive work</span>
  <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">},</span> <span class="dl">'</span><span class="s1">expensive-operation</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Run profiled function</span>
<span class="nx">optimizedFunction</span><span class="p">();</span>

<span class="c1">// Take memory snapshots</span>
<span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">profiler</span><span class="p">.</span><span class="nx">profileMemory</span><span class="p">();</span>
<span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

<span class="c1">// Stop profiling after 10 seconds</span>
<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">report</span> <span class="o">=</span> <span class="nx">profiler</span><span class="p">.</span><span class="nx">stopProfiling</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìä Performance Report:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">report</span><span class="p">);</span>
  
  <span class="c1">// Export report</span>
  <span class="kd">const</span> <span class="nx">jsonReport</span> <span class="o">=</span> <span class="nx">profiler</span><span class="p">.</span><span class="nx">exportReport</span><span class="p">(</span><span class="dl">'</span><span class="s1">json</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">üìÑ JSON Report generated</span><span class="dl">'</span><span class="p">);</span>
  
<span class="p">},</span> <span class="mi">10000</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This comprehensive guide covers advanced JavaScript memory management and performance optimization techniques essential for frontend interviews at big tech companies. The practical examples demonstrate real-world application of these concepts and provide tools for performance debugging and optimization.</p>

        </div>
    </article>
</div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Study Resources</h3>
                    <p>Comprehensive collection of frontend interview questions, coding challenges, and system design problems.</p>
                </div>
                <div class="footer-section">
                    <h3>Progress Tracking</h3>
                    <p>Monitor your learning journey with detailed progress indicators and completion status.</p>
                </div>
                <div class="footer-section">
                    <h3>Big Tech Ready</h3>
                    <p>Curated content specifically designed for interviews at Google, Meta, Amazon, Apple, and Netflix.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Frontend Interview Hub. Built for aspiring frontend engineers.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/assets/js/main.js"></script>
</body>
</html>