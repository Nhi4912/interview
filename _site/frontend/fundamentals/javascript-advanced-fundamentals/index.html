<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Advanced Fundamentals | Frontend Interview Preparation Guide</title>
    <meta name="description" content="Comprehensive frontend interview materials for Big Tech companies">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>
    <!-- Navigation -->
    <header>
        <nav class="container">
            <div class="logo">Frontend Interview Hub</div>
            <button class="mobile-menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
                <span aria-hidden="true">☰</span>
            </button>
            <ul class="nav-links" role="navigation" aria-label="Main navigation">
                <li><a href="/">Home</a></li>
                <li><a href="#progress">Progress</a></li>
                <li><a href="#knowledge">Knowledge</a></li>
                <li><a href="https://github.com/nee/interview" target="_blank" rel="noopener">GitHub</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <div class="content-container">
    
        <nav class="breadcrumb">
            <ol>
                <li><a href="/">Home</a></li>
                
                
                
                    
                
                    
                        
                        
                            <li><a href="/frontend/">Frontend</a></li>
                        
                    
                
                    
                        
                        
                            <li><a href="/frontend/fundamentals/">Fundamentals</a></li>
                        
                    
                
                    
                        
                        
                            <li class="active">Javascript advanced fundamentals</li>
                        
                    
                
            </ol>
        </nav>
    
    
    <article class="content">
        
            <header class="content-header">
                <h1 class="content-title">JavaScript Advanced Fundamentals</h1>
                
                
            </header>
        
        
        <div class="content-body">
            <h1 id="javascript-advanced-fundamentals">JavaScript Advanced Fundamentals</h1>

<h2 id="overview">Overview</h2>
<p>Deep understanding of JavaScript fundamentals is crucial for frontend interviews. This guide covers advanced concepts that separate junior from senior developers.</p>

<hr />

<h2 id="memory-management--garbage-collection">Memory Management &amp; Garbage Collection</h2>

<h3 id="understanding-memory-lifecycle"><strong>Understanding Memory Lifecycle</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
</pre></td><td class="rouge-code"><pre><span class="c1">// Memory allocation patterns and optimization</span>
<span class="kd">class</span> <span class="nx">MemoryOptimizedDataStructure</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Use typed arrays for better memory efficiency</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">ArrayBuffer</span><span class="p">(</span><span class="mi">1024</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Int32Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">stringPool</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span> <span class="c1">// String interning</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">objectPool</span> <span class="o">=</span> <span class="p">[];</span> <span class="c1">// Object pooling</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">weakRefs</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">WeakMap</span><span class="p">();</span> <span class="c1">// Prevent memory leaks</span>
  <span class="p">}</span>

  <span class="c1">// Object pooling to reduce garbage collection pressure</span>
  <span class="nx">createObject</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">objectPool</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span> <span class="na">timestamp</span><span class="p">:</span> <span class="kc">null</span> <span class="p">};</span>
    <span class="p">}</span>
    
    <span class="nx">obj</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">recycleObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Clear references before pooling</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">objectPool</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// String interning to reduce memory usage</span>
  <span class="nx">internString</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">stringPool</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">str</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">stringPool</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">stringPool</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">str</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// WeakMap usage to prevent memory leaks</span>
  <span class="nx">associateMetadata</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">weakRefs</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">);</span>
    <span class="c1">// When obj is garbage collected, metadata is automatically removed</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Demonstrating memory leaks and how to prevent them</span>
<span class="kd">class</span> <span class="nx">MemoryLeakExamples</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">timers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// ❌ Memory leak: Forgotten event listener</span>
  <span class="nx">addEventListenerBad</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">myButton</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="c1">// Listener never removed, creates memory leak</span>
  <span class="p">}</span>

  <span class="c1">// ✅ Proper cleanup</span>
  <span class="nx">addEventListenerGood</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">myButton</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">boundHandler</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    
    <span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="nx">boundHandler</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span> <span class="na">element</span><span class="p">:</span> <span class="nx">button</span><span class="p">,</span> <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="na">handler</span><span class="p">:</span> <span class="nx">boundHandler</span> <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// ❌ Memory leak: Forgotten timer</span>
  <span class="nx">startTimerBad</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timer running...</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="c1">// Timer never cleared</span>
  <span class="p">}</span>

  <span class="c1">// ✅ Proper timer management</span>
  <span class="nx">startTimerGood</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">timerId</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timer running...</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">timerId</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// ❌ Memory leak: Circular references</span>
  <span class="nx">createCircularReferenceBad</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">const</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="p">{};</span>
    
    <span class="nx">obj1</span><span class="p">.</span><span class="nx">ref</span> <span class="o">=</span> <span class="nx">obj2</span><span class="p">;</span>
    <span class="nx">obj2</span><span class="p">.</span><span class="nx">ref</span> <span class="o">=</span> <span class="nx">obj1</span><span class="p">;</span> <span class="c1">// Circular reference</span>
    
    <span class="k">return</span> <span class="p">{</span> <span class="nx">obj1</span><span class="p">,</span> <span class="nx">obj2</span> <span class="p">};</span> <span class="c1">// Both objects cannot be garbage collected</span>
  <span class="p">}</span>

  <span class="c1">// ✅ Using WeakMap to break cycles</span>
  <span class="nx">createCircularReferenceGood</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">const</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="kd">const</span> <span class="nx">refs</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">WeakMap</span><span class="p">();</span>
    
    <span class="nx">refs</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">obj1</span><span class="p">,</span> <span class="nx">obj2</span><span class="p">);</span>
    <span class="nx">refs</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">obj2</span><span class="p">,</span> <span class="nx">obj1</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="p">{</span> <span class="nx">obj1</span><span class="p">,</span> <span class="nx">obj2</span><span class="p">,</span> <span class="na">getRefs</span><span class="p">:</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">refs</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Cleanup method</span>
  <span class="nx">cleanup</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Remove all event listeners</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(({</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">element</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listeners</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>

    <span class="c1">// Clear all timers</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">timerId</span> <span class="o">=&gt;</span> <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timerId</span><span class="p">));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">timers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>

    <span class="c1">// Disconnect all observers</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">observer</span> <span class="o">=&gt;</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">observers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">handleClick</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Button clicked</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="understanding-garbage-collection"><strong>Understanding Garbage Collection</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre></td><td class="rouge-code"><pre><span class="c1">// Demonstrating GC behavior and optimization</span>
<span class="kd">class</span> <span class="nx">GarbageCollectionDemo</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">largeObjects</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">generation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Force garbage collection (for demonstration in Node.js)</span>
  <span class="nx">forceGC</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">global</span><span class="p">.</span><span class="nx">gc</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">global</span><span class="p">.</span><span class="nx">gc</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Monitor memory usage</span>
  <span class="nx">getMemoryUsage</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">used</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">usedJSHeapSize</span><span class="p">,</span>
        <span class="na">total</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">totalJSHeapSize</span><span class="p">,</span>
        <span class="na">limit</span><span class="p">:</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">jsHeapSizeLimit</span>
      <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Demonstrate generational GC behavior</span>
  <span class="nx">demonstrateGenerationalGC</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">beforeMemory</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMemoryUsage</span><span class="p">();</span>
    
    <span class="c1">// Create young generation objects (likely to be collected quickly)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">temp</span> <span class="o">=</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">100</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">};</span>
      <span class="c1">// These objects become eligible for collection immediately</span>
    <span class="p">}</span>
    
    <span class="c1">// Create older generation objects (survive longer)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">largeObjects</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span>
        <span class="na">generation</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">generation</span><span class="p">,</span>
        <span class="na">data</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span>
        <span class="na">created</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span>
      <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">generation</span><span class="o">++</span><span class="p">;</span>
    
    <span class="kd">const</span> <span class="nx">afterMemory</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getMemoryUsage</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">before</span><span class="p">:</span> <span class="nx">beforeMemory</span><span class="p">,</span>
      <span class="na">after</span><span class="p">:</span> <span class="nx">afterMemory</span><span class="p">,</span>
      <span class="na">difference</span><span class="p">:</span> <span class="nx">afterMemory</span> <span class="p">?</span> <span class="nx">afterMemory</span><span class="p">.</span><span class="nx">used</span> <span class="o">-</span> <span class="nx">beforeMemory</span><span class="p">.</span><span class="nx">used</span> <span class="p">:</span> <span class="kc">null</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Optimize for mark-and-sweep collector</span>
  <span class="nx">optimizeForMarkSweep</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Remove circular references</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">largeObjects</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">obj</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>
    
    <span class="c1">// Clear arrays efficiently</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">largeObjects</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Better than this.largeObjects = []</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="execution-context--scope-chain">Execution Context &amp; Scope Chain</h2>

<h3 id="advanced-scope-and-closure-patterns"><strong>Advanced Scope and Closure Patterns</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
</pre></td><td class="rouge-code"><pre><span class="c1">// Understanding execution context and scope chain</span>
<span class="kd">class</span> <span class="nx">ExecutionContextDemo</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">globalVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">global</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Demonstrating scope chain resolution</span>
  <span class="nx">demonstrateScopeChain</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">outerVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">outer</span><span class="dl">'</span><span class="p">;</span>
    
    <span class="kd">function</span> <span class="nx">outerFunction</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">middleVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">middle</span><span class="dl">'</span><span class="p">;</span>
      
      <span class="kd">function</span> <span class="nx">innerFunction</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">innerVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">inner</span><span class="dl">'</span><span class="p">;</span>
        
        <span class="c1">// Scope chain: innerFunction -&gt; outerFunction -&gt; global</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">innerVar</span><span class="p">);</span>   <span class="c1">// Found in current scope</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">middleVar</span><span class="p">);</span>  <span class="c1">// Found in outer function scope</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">outerVar</span><span class="p">);</span>   <span class="c1">// Found in function scope</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">globalVar</span><span class="p">);</span> <span class="c1">// Found in global scope (if bound)</span>
        
        <span class="c1">// Demonstrate lexical scoping</span>
        <span class="k">return</span> <span class="kd">function</span> <span class="nx">deepestFunction</span><span class="p">()</span> <span class="p">{</span>
          <span class="c1">// Still has access to all outer scopes</span>
          <span class="k">return</span> <span class="p">{</span> <span class="nx">innerVar</span><span class="p">,</span> <span class="nx">middleVar</span><span class="p">,</span> <span class="nx">outerVar</span> <span class="p">};</span>
        <span class="p">};</span>
      <span class="p">}</span>
      
      <span class="k">return</span> <span class="nx">innerFunction</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">outerFunction</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// Advanced closure patterns</span>
  <span class="nx">createAdvancedClosure</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">privateCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">privateArray</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="c1">// Module pattern with closures</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">increment</span><span class="p">(</span><span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">privateCounter</span> <span class="o">+=</span> <span class="nx">amount</span><span class="p">;</span>
        <span class="nx">privateArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">privateCounter</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Method chaining</span>
      <span class="p">},</span>
      
      <span class="nx">decrement</span><span class="p">(</span><span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">privateCounter</span> <span class="o">-=</span> <span class="nx">amount</span><span class="p">;</span>
        <span class="nx">privateArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">privateCounter</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">getValue</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">privateCounter</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">getHistory</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[...</span><span class="nx">privateArray</span><span class="p">];</span> <span class="c1">// Return copy to prevent mutation</span>
      <span class="p">},</span>
      
      <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">privateCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">privateArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="c1">// Lazy evaluation with closures</span>
      <span class="nx">createLazyGetter</span><span class="p">(</span><span class="nx">computeFunc</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">cached</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">computed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">computed</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cached</span> <span class="o">=</span> <span class="nx">computeFunc</span><span class="p">(</span><span class="nx">privateCounter</span><span class="p">);</span>
            <span class="nx">computed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="nx">cached</span><span class="p">;</span>
        <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Temporal Dead Zone demonstration</span>
  <span class="nx">demonstrateTemporalDeadZone</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Before block</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// console.log(letVar); // ReferenceError: Cannot access before initialization</span>
    <span class="c1">// console.log(constVar); // ReferenceError: Cannot access before initialization</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">varVar</span><span class="p">);</span> <span class="c1">// undefined (hoisted but not initialized)</span>
    
    <span class="p">{</span>
      <span class="c1">// Temporal Dead Zone starts here for let and const</span>
      
      <span class="c1">// console.log(letVar); // ReferenceError</span>
      <span class="c1">// console.log(constVar); // ReferenceError</span>
      
      <span class="kd">let</span> <span class="nx">letVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">let value</span><span class="dl">'</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">constVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">const value</span><span class="dl">'</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">varVar</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">var value</span><span class="dl">'</span><span class="p">;</span>
      
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">({</span> <span class="nx">letVar</span><span class="p">,</span> <span class="nx">constVar</span><span class="p">,</span> <span class="nx">varVar</span> <span class="p">});</span>
    <span class="p">}</span>
    
    <span class="c1">// console.log(letVar); // ReferenceError: letVar is not defined</span>
    <span class="c1">// console.log(constVar); // ReferenceError: constVar is not defined</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">varVar</span><span class="p">);</span> <span class="c1">// 'var value' (function scoped)</span>
  <span class="p">}</span>

  <span class="c1">// Understanding 'this' binding in different contexts</span>
  <span class="nx">demonstrateThisBinding</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">regularFunction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Depends on how function is called</span>
    <span class="p">};</span>
    
    <span class="kd">const</span> <span class="nx">arrowFunction</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Lexically bound to enclosing scope</span>
    <span class="p">};</span>
    
    <span class="kd">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">method</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">,</span>
      <span class="na">arrowMethod</span><span class="p">:</span> <span class="nx">arrowFunction</span><span class="p">,</span>
      
      <span class="c1">// Method with explicit binding</span>
      <span class="na">boundMethod</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">.</span><span class="nx">bind</span><span class="p">({</span> <span class="na">bound</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}),</span>
      
      <span class="c1">// Method that returns bound function</span>
      <span class="nx">createBoundFunction</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="c1">// Different call contexts</span>
      <span class="na">directCall</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">(),</span> <span class="c1">// global object or undefined in strict mode</span>
      <span class="na">methodCall</span><span class="p">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">method</span><span class="p">(),</span> <span class="c1">// obj</span>
      <span class="na">arrowCall</span><span class="p">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">arrowMethod</span><span class="p">(),</span> <span class="c1">// lexical this (ExecutionContextDemo instance)</span>
      <span class="na">boundCall</span><span class="p">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">boundMethod</span><span class="p">(),</span> <span class="c1">// { bound: true }</span>
      
      <span class="c1">// Call/apply/bind</span>
      <span class="na">callExample</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span> <span class="na">called</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}),</span>
      <span class="na">applyExample</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">.</span><span class="nx">apply</span><span class="p">({</span> <span class="na">applied</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}),</span>
      <span class="na">bindExample</span><span class="p">:</span> <span class="nx">regularFunction</span><span class="p">.</span><span class="nx">bind</span><span class="p">({</span> <span class="na">bound</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})(),</span>
      
      <span class="c1">// Constructor context</span>
      <span class="na">constructorExample</span><span class="p">:</span> <span class="k">new</span> <span class="p">(</span><span class="kd">function</span> <span class="nx">Constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">constructed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="p">})()</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Advanced closure patterns for real-world scenarios</span>
<span class="kd">class</span> <span class="nx">AdvancedClosurePatterns</span> <span class="p">{</span>
  <span class="c1">// Memoization with closures</span>
  <span class="kd">static</span> <span class="nx">createMemoizer</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">maxCacheSize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">accessOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">return</span> <span class="kd">function</span> <span class="nx">memoized</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// Move to end (most recently used)</span>
        <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">accessOrder</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="nx">accessOrder</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nx">accessOrder</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      
      <span class="c1">// Implement LRU cache</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">.</span><span class="nx">size</span> <span class="o">&gt;=</span> <span class="nx">maxCacheSize</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">lru</span> <span class="o">=</span> <span class="nx">accessOrder</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
        <span class="nx">cache</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">lru</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">cache</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
      <span class="nx">accessOrder</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
      
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Debouncing with closures</span>
  <span class="kd">static</span> <span class="nx">createDebouncer</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">delay</span><span class="p">,</span> <span class="nx">immediate</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">timeoutId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">lastCallTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span> <span class="nx">debounced</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">callNow</span> <span class="o">=</span> <span class="nx">immediate</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">timeoutId</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      
      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutId</span><span class="p">);</span>
      
      <span class="nx">timeoutId</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">timeoutId</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">immediate</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span> <span class="nx">delay</span><span class="p">);</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">callNow</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">lastCallTime</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Throttling with closures</span>
  <span class="kd">static</span> <span class="nx">createThrottler</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">limit</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">inThrottle</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">lastFunc</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">lastRan</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    
    <span class="k">return</span> <span class="kd">function</span> <span class="nx">throttled</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inThrottle</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="nx">lastRan</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="nx">inThrottle</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">lastFunc</span><span class="p">);</span>
        <span class="nx">lastFunc</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">((</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">lastRan</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nx">limit</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
            <span class="nx">lastRan</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">},</span> <span class="nx">limit</span> <span class="o">-</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">lastRan</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// State machine with closures</span>
  <span class="kd">static</span> <span class="nx">createStateMachine</span><span class="p">(</span><span class="nx">initialState</span><span class="p">,</span> <span class="nx">transitions</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">currentState</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">stateHistory</span> <span class="o">=</span> <span class="p">[</span><span class="nx">initialState</span><span class="p">];</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">getCurrentState</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">currentState</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">getHistory</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[...</span><span class="nx">stateHistory</span><span class="p">];</span>
      <span class="p">},</span>
      
      <span class="nx">transition</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">possibleTransitions</span> <span class="o">=</span> <span class="nx">transitions</span><span class="p">[</span><span class="nx">currentState</span><span class="p">];</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">possibleTransitions</span> <span class="o">||</span> <span class="o">!</span><span class="nx">possibleTransitions</span><span class="p">[</span><span class="nx">action</span><span class="p">])</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Invalid transition: </span><span class="p">${</span><span class="nx">currentState</span><span class="p">}</span><span class="s2"> -&gt; </span><span class="p">${</span><span class="nx">action</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">possibleTransitions</span><span class="p">[</span><span class="nx">action</span><span class="p">];</span>
        <span class="nx">currentState</span> <span class="o">=</span> <span class="nx">newState</span><span class="p">;</span>
        <span class="nx">stateHistory</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
        
        <span class="k">return</span> <span class="nx">newState</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">canTransition</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">possibleTransitions</span> <span class="o">=</span> <span class="nx">transitions</span><span class="p">[</span><span class="nx">currentState</span><span class="p">];</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">possibleTransitions</span> <span class="o">&amp;&amp;</span> <span class="nx">possibleTransitions</span><span class="p">[</span><span class="nx">action</span><span class="p">]);</span>
      <span class="p">},</span>
      
      <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">currentState</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">;</span>
        <span class="nx">stateHistory</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">stateHistory</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="asynchronous-javascript-mastery">Asynchronous JavaScript Mastery</h2>

<h3 id="advanced-promise-patterns"><strong>Advanced Promise Patterns</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
</pre></td><td class="rouge-code"><pre><span class="c1">// Advanced promise patterns and error handling</span>
<span class="kd">class</span> <span class="nx">AdvancedPromisePatterns</span> <span class="p">{</span>
  <span class="c1">// Promise.all with individual error handling</span>
  <span class="kd">static</span> <span class="k">async</span> <span class="nx">allSettled</span><span class="p">(</span><span class="nx">promises</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">promises</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">results</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">fulfilled</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">const</span> <span class="nx">rejected</span> <span class="o">=</span> <span class="p">[];</span>
      
      <span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">result</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">fulfilled</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">fulfilled</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">index</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">value</span> <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">rejected</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">index</span><span class="p">,</span> <span class="na">reason</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">reason</span> <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">});</span>
      
      <span class="k">return</span> <span class="p">{</span> <span class="nx">fulfilled</span><span class="p">,</span> <span class="nx">rejected</span> <span class="p">};</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Promise with timeout</span>
  <span class="kd">static</span> <span class="nx">withTimeout</span><span class="p">(</span><span class="nx">promise</span><span class="p">,</span> <span class="nx">timeoutMs</span><span class="p">,</span> <span class="nx">timeoutMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Operation timed out</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
      <span class="nx">promise</span><span class="p">,</span>
      <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">_</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">timeoutMessage</span><span class="p">)),</span> <span class="nx">timeoutMs</span><span class="p">);</span>
      <span class="p">})</span>
    <span class="p">]);</span>
  <span class="p">}</span>

  <span class="c1">// Retry mechanism with exponential backoff</span>
  <span class="kd">static</span> <span class="k">async</span> <span class="nx">retryWithBackoff</span><span class="p">(</span>
    <span class="nx">operation</span><span class="p">,</span> 
    <span class="nx">maxRetries</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> 
    <span class="nx">baseDelay</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> 
    <span class="nx">maxDelay</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="nx">backoffFactor</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">lastError</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">attempt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">attempt</span> <span class="o">&lt;=</span> <span class="nx">maxRetries</span><span class="p">;</span> <span class="nx">attempt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">await</span> <span class="nx">operation</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">lastError</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">attempt</span> <span class="o">===</span> <span class="nx">maxRetries</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Operation failed after </span><span class="p">${</span><span class="nx">maxRetries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2"> attempts: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="kd">const</span> <span class="nx">delay</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">baseDelay</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">backoffFactor</span><span class="p">,</span> <span class="nx">attempt</span><span class="p">),</span> <span class="nx">maxDelay</span><span class="p">);</span>
        <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="nx">delay</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Circuit breaker pattern</span>
  <span class="kd">static</span> <span class="nx">createCircuitBreaker</span><span class="p">(</span><span class="nx">operation</span><span class="p">,</span> <span class="nx">threshold</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="mi">60000</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">failures</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">lastFailureTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">state</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CLOSED</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// CLOSED, OPEN, HALF_OPEN</span>
    
    <span class="k">return</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">circuitBreakerWrapper</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      
      <span class="c1">// Reset if timeout has passed</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">OPEN</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">now</span> <span class="o">-</span> <span class="nx">lastFailureTime</span> <span class="o">&gt;</span> <span class="nx">timeout</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">state</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">HALF_OPEN</span><span class="dl">'</span><span class="p">;</span>
        <span class="nx">failures</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">OPEN</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Circuit breaker is OPEN</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">operation</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
        
        <span class="c1">// Success - reset failure count</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">HALF_OPEN</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">state</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CLOSED</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">failures</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">failures</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">lastFailureTime</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">failures</span> <span class="o">&gt;=</span> <span class="nx">threshold</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">state</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">OPEN</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Promise queue for rate limiting</span>
  <span class="kd">static</span> <span class="nx">createPromiseQueue</span><span class="p">(</span><span class="nx">concurrency</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">queue</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">let</span> <span class="nx">running</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">async</span> <span class="kd">function</span> <span class="nx">process</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">running</span> <span class="o">&gt;=</span> <span class="nx">concurrency</span> <span class="o">||</span> <span class="nx">queue</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">running</span><span class="o">++</span><span class="p">;</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">operation</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">queue</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
      
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">operation</span><span class="p">();</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
        <span class="nx">running</span><span class="o">--</span><span class="p">;</span>
        <span class="nx">process</span><span class="p">();</span> <span class="c1">// Process next item</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">add</span><span class="p">(</span><span class="nx">operation</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="nx">operation</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span> <span class="p">});</span>
          <span class="nx">process</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">},</span>
      
      <span class="nx">clear</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">queue</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">size</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">queue</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="p">},</span>
      
      <span class="nx">isRunning</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">running</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Cancellable promises</span>
  <span class="kd">static</span> <span class="nx">createCancellablePromise</span><span class="p">(</span><span class="nx">operation</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">cancelled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">cancelResolve</span><span class="p">;</span>
    
    <span class="kd">const</span> <span class="nx">cancelPromise</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">cancelResolve</span> <span class="o">=</span> <span class="nx">resolve</span><span class="p">;</span>
    <span class="p">});</span>
    
    <span class="kd">const</span> <span class="nx">mainPromise</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
          <span class="nx">operation</span><span class="p">(),</span>
          <span class="nx">cancelPromise</span><span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Operation cancelled</span><span class="dl">'</span><span class="p">);</span>
          <span class="p">})</span>
        <span class="p">]);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cancelled</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cancelled</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">promise</span><span class="p">:</span> <span class="nx">mainPromise</span><span class="p">,</span>
      <span class="nx">cancel</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">cancelled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">cancelResolve</span><span class="p">();</span>
      <span class="p">},</span>
      <span class="nx">isCancelled</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">cancelled</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Utility methods</span>
  <span class="kd">static</span> <span class="nx">delay</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">ms</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="c1">// Progressive loading with promises</span>
  <span class="kd">static</span> <span class="k">async</span> <span class="nx">loadResourcesProgressively</span><span class="p">(</span><span class="nx">resources</span><span class="p">,</span> <span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">resources</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">resources</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="nx">result</span><span class="p">,</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span> <span class="p">});</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">onProgress</span><span class="p">({</span>
            <span class="na">completed</span><span class="p">:</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="na">total</span><span class="p">:</span> <span class="nx">resources</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
            <span class="na">percentage</span><span class="p">:</span> <span class="p">((</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nx">resources</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
            <span class="nx">result</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">error</span><span class="p">,</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span> <span class="p">});</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">onProgress</span><span class="p">({</span>
            <span class="na">completed</span><span class="p">:</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="na">total</span><span class="p">:</span> <span class="nx">resources</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
            <span class="na">percentage</span><span class="p">:</span> <span class="p">((</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nx">resources</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
            <span class="nx">error</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Advanced async/await patterns</span>
<span class="kd">class</span> <span class="nx">AsyncAwaitPatterns</span> <span class="p">{</span>
  <span class="c1">// Parallel execution with async/await</span>
  <span class="k">async</span> <span class="nx">executeInParallel</span><span class="p">(</span><span class="nx">operations</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">// Execute all operations in parallel</span>
      <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">operations</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">op</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">opStartTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">op</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">duration</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">opStartTime</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="p">{</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="na">success</span><span class="p">:</span> <span class="kc">true</span> <span class="p">};</span>
      <span class="p">}));</span>
      
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">results</span><span class="p">,</span>
        <span class="na">totalDuration</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span>
      <span class="p">};</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
        <span class="na">totalDuration</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// Sequential execution with async/await</span>
  <span class="k">async</span> <span class="nx">executeSequentially</span><span class="p">(</span><span class="nx">operations</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">operations</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">opStartTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">operations</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
        <span class="kd">const</span> <span class="nx">duration</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">opStartTime</span><span class="p">;</span>
        
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="na">success</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">duration</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">opStartTime</span><span class="p">;</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="na">success</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>
        
        <span class="c1">// Stop on first error</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">,</span>
      <span class="na">totalDuration</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">,</span>
      <span class="na">completed</span><span class="p">:</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">total</span><span class="p">:</span> <span class="nx">operations</span><span class="p">.</span><span class="nx">length</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Async iteration patterns</span>
  <span class="k">async</span> <span class="o">*</span><span class="nx">asyncGenerator</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Simulate async processing</span>
      <span class="k">await</span> <span class="nx">AdvancedPromisePatterns</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
      <span class="k">yield</span> <span class="nx">item</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">processAsyncIterable</span><span class="p">(</span><span class="nx">iterable</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">iterable</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Error handling patterns</span>
  <span class="k">async</span> <span class="nx">executeWithGracefulFailure</span><span class="p">(</span><span class="nx">operations</span><span class="p">,</span> <span class="p">{</span> 
    <span class="nx">continueOnError</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> 
    <span class="nx">maxErrors</span> <span class="o">=</span> <span class="kc">Infinity</span><span class="p">,</span>
    <span class="nx">errorHandler</span> <span class="o">=</span> <span class="kc">null</span> 
  <span class="p">}</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">errors</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">let</span> <span class="nx">errorCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">operations</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">operations</span><span class="p">[</span><span class="nx">i</span><span class="p">]();</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="na">success</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">errorCount</span><span class="o">++</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">errorInfo</span> <span class="o">=</span> <span class="p">{</span> <span class="na">index</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="na">success</span><span class="p">:</span> <span class="kc">false</span> <span class="p">};</span>
        
        <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">errorInfo</span><span class="p">);</span>
        <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">errorInfo</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">errorHandler</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">await</span> <span class="nx">errorHandler</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">continueOnError</span> <span class="o">||</span> <span class="nx">errorCount</span> <span class="o">&gt;=</span> <span class="nx">maxErrors</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">results</span><span class="p">,</span>
      <span class="nx">errors</span><span class="p">,</span>
      <span class="na">successCount</span><span class="p">:</span> <span class="nx">results</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">success</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span>
      <span class="nx">errorCount</span><span class="p">,</span>
      <span class="na">completed</span><span class="p">:</span> <span class="nx">results</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">total</span><span class="p">:</span> <span class="nx">operations</span><span class="p">.</span><span class="nx">length</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="event-loop--microtasks">Event Loop &amp; Microtasks</h2>

<h3 id="understanding-the-event-loop"><strong>Understanding the Event Loop</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
</pre></td><td class="rouge-code"><pre><span class="c1">// Event loop demonstration and microtask understanding</span>
<span class="kd">class</span> <span class="nx">EventLoopDemo</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">timers</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="p">}</span>

  <span class="c1">// Demonstrate event loop phases</span>
  <span class="nx">demonstrateEventLoop</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="c1">// 1. Synchronous code</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1: Synchronous start</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// 2. Macrotask (Timer)</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">6: setTimeout (macrotask)</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    
    <span class="c1">// 3. Microtask (Promise)</span>
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">4: Promise.then (microtask)</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="c1">// 4. Immediate microtask</span>
    <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">5: queueMicrotask</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="c1">// 5. More synchronous code</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">2: Synchronous middle</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// 6. Nested microtask</span>
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3: First Promise</span><span class="dl">'</span><span class="p">);</span>
      
      <span class="c1">// This microtask runs before macrotasks</span>
      <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3.5: Nested Promise (microtask)</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">});</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3: Synchronous end</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// Return promise that resolves after all tasks complete</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">);</span>
      <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Demonstrate microtask vs macrotask priority</span>
  <span class="nx">demonstratePriority</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="c1">// Schedule multiple macrotasks</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timeout 1</span><span class="dl">'</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timeout 2</span><span class="dl">'</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    
    <span class="c1">// Schedule multiple microtasks</span>
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Promise 1</span><span class="dl">'</span><span class="p">));</span>
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Promise 2</span><span class="dl">'</span><span class="p">));</span>
    
    <span class="c1">// Immediate execution</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sync code</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// More microtasks</span>
    <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Microtask 1</span><span class="dl">'</span><span class="p">));</span>
    <span class="nx">queueMicrotask</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Microtask 2</span><span class="dl">'</span><span class="p">));</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">),</span> <span class="mi">10</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Complex event loop scenario</span>
  <span class="nx">demonstrateComplexScenario</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">=== Start ===</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timer 1</span><span class="dl">'</span><span class="p">);</span>
      
      <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Promise in Timer 1</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">});</span>
      
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Nested Timer in Timer 1</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Promise 1</span><span class="dl">'</span><span class="p">);</span>
      
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timer in Promise 1</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
      
      <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">();</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Chained Promise 1</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Timer 2</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Promise 2</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">=== End Sync ===</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">),</span> <span class="mi">50</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Demonstrate blocking behavior</span>
  <span class="nx">demonstrateBlocking</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Before blocking operation</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// Simulate CPU-intensive task</span>
    <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Blocking loop</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">After blocking operation</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This timer was delayed by blocking</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
    
    <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This microtask runs immediately</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Non-blocking alternatives</span>
  <span class="nx">demonstrateNonBlocking</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span> <span class="o">=</span> <span class="p">[];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Before non-blocking operation</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// Break up work into chunks</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">performWorkInChunks</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Non-blocking work completed</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">This timer is not blocked</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">50</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">),</span> <span class="mi">200</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">performWorkInChunks</span><span class="p">(</span><span class="nx">totalWork</span><span class="p">,</span> <span class="nx">chunkSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">totalWork</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="nx">chunkSize</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Do chunk of work</span>
      <span class="kd">const</span> <span class="nx">end</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">chunkSize</span><span class="p">,</span> <span class="nx">totalWork</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">end</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Simulate work</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
      <span class="p">}</span>
      
      <span class="c1">// Yield control back to event loop</span>
      <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Processed </span><span class="p">${</span><span class="nx">i</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">totalWork</span><span class="p">}</span><span class="s2"> items`</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">performance</span><span class="p">.</span><span class="nx">now</span><span class="p">().</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">entry</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">timestamp</span><span class="p">}</span><span class="s2">ms: </span><span class="p">${</span><span class="nx">message</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">executionOrder</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Web Workers for true parallelism</span>
<span class="kd">class</span> <span class="nx">WebWorkerDemo</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">workers</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// Create and manage web workers</span>
  <span class="nx">createWorker</span><span class="p">(</span><span class="nx">script</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">script</span><span class="p">],</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/javascript</span><span class="dl">'</span> <span class="p">});</span>
    <span class="kd">const</span> <span class="nx">workerUrl</span> <span class="o">=</span> <span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">worker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Worker</span><span class="p">(</span><span class="nx">workerUrl</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">workerId</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mi">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">workerId</span><span class="p">,</span> <span class="nx">worker</span><span class="p">);</span>
    
    <span class="c1">// Cleanup</span>
    <span class="nx">worker</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">URL</span><span class="p">.</span><span class="nx">revokeObjectURL</span><span class="p">(</span><span class="nx">workerUrl</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">workerId</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="k">return</span> <span class="p">{</span> <span class="nx">worker</span><span class="p">,</span> <span class="nx">workerId</span> <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Heavy computation in web worker</span>
  <span class="nx">performHeavyComputation</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">workerScript</span> <span class="o">=</span> <span class="s2">`
      self.onmessage = function(e) {
        const { data, operation } = e.data;
        
        let result;
        const startTime = Date.now();
        
        switch(operation) {
          case 'fibonacci':
            result = fibonacci(data);
            break;
          case 'primes':
            result = findPrimes(data);
            break;
          case 'sort':
            result = data.sort((a, b) =&gt; a - b);
            break;
          default:
            result = data;
        }
        
        const duration = Date.now() - startTime;
        
        self.postMessage({ result, duration });
      };
      
      function fibonacci(n) {
        if (n &lt;= 1) return n;
        return fibonacci(n - 1) + fibonacci(n - 2);
      }
      
      function findPrimes(max) {
        const primes = [];
        for (let i = 2; i &lt;= max; i++) {
          let isPrime = true;
          for (let j = 2; j &lt;= Math.sqrt(i); j++) {
            if (i % j === 0) {
              isPrime = false;
              break;
            }
          }
          if (isPrime) primes.push(i);
        }
        return primes;
      }
    `</span><span class="p">;</span>
    
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">worker</span><span class="p">,</span> <span class="nx">workerId</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createWorker</span><span class="p">(</span><span class="nx">workerScript</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">worker</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">workerId</span><span class="p">);</span>
      <span class="p">};</span>
      
      <span class="nx">worker</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">workerId</span><span class="p">);</span>
      <span class="p">};</span>
      
      <span class="nx">worker</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// Cleanup all workers</span>
  <span class="nx">terminateAllWorkers</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">worker</span> <span class="o">=&gt;</span> <span class="nx">worker</span><span class="p">.</span><span class="nx">terminate</span><span class="p">());</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">workers</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="prototypal-inheritance-deep-dive">Prototypal Inheritance Deep Dive</h2>

<h3 id="advanced-prototype-patterns"><strong>Advanced Prototype Patterns</strong></h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
</pre></td><td class="rouge-code"><pre><span class="c1">// Understanding prototype chain and inheritance</span>
<span class="kd">class</span> <span class="nx">PrototypeDemo</span> <span class="p">{</span>
  <span class="c1">// Demonstrate prototype chain</span>
  <span class="kd">static</span> <span class="nx">demonstratePrototypeChain</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Create base object</span>
    <span class="kd">const</span> <span class="nx">animal</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Animal</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">breathe</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> is breathing`</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">// Create mammal that inherits from animal</span>
    <span class="kd">const</span> <span class="nx">mammal</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">animal</span><span class="p">);</span>
    <span class="nx">mammal</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Mammal</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">mammal</span><span class="p">.</span><span class="nx">warmBlooded</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">mammal</span><span class="p">.</span><span class="nx">nurse</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> is nursing`</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="c1">// Create dog that inherits from mammal</span>
    <span class="kd">const</span> <span class="nx">dog</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">mammal</span><span class="p">);</span>
    <span class="nx">dog</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Dog</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">dog</span><span class="p">.</span><span class="nx">bark</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> is barking`</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="c1">// Create specific dog instance</span>
    <span class="kd">const</span> <span class="nx">buddy</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">dog</span><span class="p">);</span>
    <span class="nx">buddy</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Buddy</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">buddy</span><span class="p">.</span><span class="nx">breed</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Golden Retriever</span><span class="dl">'</span><span class="p">;</span>
    
    <span class="c1">// Demonstrate prototype chain traversal</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Prototype chain for buddy:</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">current</span> <span class="o">=</span> <span class="nx">buddy</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">level</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Level </span><span class="p">${</span><span class="nx">level</span><span class="p">}</span><span class="s2">:`</span><span class="p">,</span> <span class="nx">current</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Own properties:</span><span class="dl">'</span><span class="p">,</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getOwnPropertyNames</span><span class="p">(</span><span class="nx">current</span><span class="p">));</span>
      <span class="nx">current</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
      <span class="nx">level</span><span class="o">++</span><span class="p">;</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="nx">level</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span> <span class="c1">// Prevent infinite loop</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">buddy</span><span class="p">,</span>
      <span class="na">chain</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">canBreathe</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">breathe</span><span class="p">(),</span>
        <span class="na">canNurse</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">nurse</span><span class="p">(),</span>
        <span class="na">canBark</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">bark</span><span class="p">(),</span>
        <span class="na">properties</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
          <span class="na">breed</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">breed</span><span class="p">,</span>
          <span class="na">type</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
          <span class="na">warmBlooded</span><span class="p">:</span> <span class="nx">buddy</span><span class="p">.</span><span class="nx">warmBlooded</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Classical inheritance patterns</span>
  <span class="kd">static</span> <span class="nx">demonstrateClassicalInheritance</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Constructor function pattern</span>
    <span class="kd">function</span> <span class="nx">Vehicle</span><span class="p">(</span><span class="nx">make</span><span class="p">,</span> <span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">make</span> <span class="o">=</span> <span class="nx">make</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nx">Vehicle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">accelerate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">+=</span> <span class="nx">amount</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="nx">Vehicle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">brake</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">speed</span> <span class="o">-</span> <span class="nx">amount</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="nx">Vehicle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">make</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">}</span><span class="s2"> going </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">speed</span><span class="p">}</span><span class="s2"> mph`</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="c1">// Inheritance with constructor functions</span>
    <span class="kd">function</span> <span class="nx">Car</span><span class="p">(</span><span class="nx">make</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">doors</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Call parent constructor</span>
      <span class="nx">Vehicle</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">make</span><span class="p">,</span> <span class="nx">model</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">doors</span> <span class="o">=</span> <span class="nx">doors</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// Set up prototype chain</span>
    <span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Vehicle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
    <span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Car</span><span class="p">;</span>
    
    <span class="c1">// Add car-specific methods</span>
    <span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">honk</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">make</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">}</span><span class="s2"> is honking!`</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="c1">// Override parent method</span>
    <span class="nx">Car</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getInfo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">make</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">}</span><span class="s2"> (</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">doors</span><span class="p">}</span><span class="s2"> doors) going </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">speed</span><span class="p">}</span><span class="s2"> mph`</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="kd">const</span> <span class="nx">myCar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">(</span><span class="dl">'</span><span class="s1">Toyota</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Camry</span><span class="dl">'</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">myCar</span><span class="p">,</span>
      <span class="na">demo</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">initial</span><span class="p">:</span> <span class="nx">myCar</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">(),</span>
        <span class="na">afterAccelerate</span><span class="p">:</span> <span class="nx">myCar</span><span class="p">.</span><span class="nx">accelerate</span><span class="p">(</span><span class="mi">30</span><span class="p">).</span><span class="nx">getInfo</span><span class="p">(),</span>
        <span class="na">afterBrake</span><span class="p">:</span> <span class="nx">myCar</span><span class="p">.</span><span class="nx">brake</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">getInfo</span><span class="p">(),</span>
        <span class="na">honk</span><span class="p">:</span> <span class="nx">myCar</span><span class="p">.</span><span class="nx">honk</span><span class="p">(),</span>
        <span class="na">instanceof</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">Car</span><span class="p">:</span> <span class="nx">myCar</span> <span class="k">instanceof</span> <span class="nx">Car</span><span class="p">,</span>
          <span class="na">Vehicle</span><span class="p">:</span> <span class="nx">myCar</span> <span class="k">instanceof</span> <span class="nx">Vehicle</span><span class="p">,</span>
          <span class="na">Object</span><span class="p">:</span> <span class="nx">myCar</span> <span class="k">instanceof</span> <span class="nb">Object</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Modern class syntax with private fields</span>
  <span class="kd">static</span> <span class="nx">demonstrateModernClasses</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="nx">Shape</span> <span class="p">{</span>
      <span class="err">#</span><span class="nx">id</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mi">36</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
      
      <span class="kd">constructor</span><span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">get</span> <span class="nx">id</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">id</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">area</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">area() must be implemented by subclass</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
      
      <span class="nx">getInfo</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">`</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> (</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">}</span><span class="s2">) - Area: </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">area</span><span class="p">()}</span><span class="s2">`</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">static</span> <span class="nx">isShape</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">Shape</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">class</span> <span class="nx">Circle</span> <span class="kd">extends</span> <span class="nx">Shape</span> <span class="p">{</span>
      <span class="err">#</span><span class="nx">radius</span><span class="p">;</span>
      
      <span class="kd">constructor</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">color</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">radius</span> <span class="o">=</span> <span class="nx">radius</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">get</span> <span class="nx">radius</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">radius</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">set</span> <span class="nx">radius</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Radius must be positive</span><span class="dl">'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">radius</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">area</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">circumference</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">radius</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">class</span> <span class="nx">Rectangle</span> <span class="kd">extends</span> <span class="nx">Shape</span> <span class="p">{</span>
      <span class="err">#</span><span class="nx">width</span><span class="p">;</span>
      <span class="err">#</span><span class="nx">height</span><span class="p">;</span>
      
      <span class="kd">constructor</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">color</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">get</span> <span class="nx">dimensions</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span> <span class="na">width</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">width</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">height</span> <span class="p">};</span>
      <span class="p">}</span>
      
      <span class="nx">area</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">width</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">height</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="nx">perimeter</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">width</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="err">#</span><span class="nx">height</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">const</span> <span class="nx">circle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Circle</span><span class="p">(</span><span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">rectangle</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Rectangle</span><span class="p">(</span><span class="dl">'</span><span class="s1">blue</span><span class="dl">'</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">circle</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">info</span><span class="p">:</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">(),</span>
        <span class="na">circumference</span><span class="p">:</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">circumference</span><span class="p">(),</span>
        <span class="na">id</span><span class="p">:</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">isShape</span><span class="p">:</span> <span class="nx">Shape</span><span class="p">.</span><span class="nx">isShape</span><span class="p">(</span><span class="nx">circle</span><span class="p">)</span>
      <span class="p">},</span>
      <span class="na">rectangle</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">info</span><span class="p">:</span> <span class="nx">rectangle</span><span class="p">.</span><span class="nx">getInfo</span><span class="p">(),</span>
        <span class="na">perimeter</span><span class="p">:</span> <span class="nx">rectangle</span><span class="p">.</span><span class="nx">perimeter</span><span class="p">(),</span>
        <span class="na">dimensions</span><span class="p">:</span> <span class="nx">rectangle</span><span class="p">.</span><span class="nx">dimensions</span><span class="p">,</span>
        <span class="na">isShape</span><span class="p">:</span> <span class="nx">Shape</span><span class="p">.</span><span class="nx">isShape</span><span class="p">(</span><span class="nx">rectangle</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// Mixin patterns</span>
  <span class="kd">static</span> <span class="nx">demonstrateMixins</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Mixin for event handling</span>
    <span class="kd">const</span> <span class="nx">EventMixin</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
      <span class="p">},</span>
      
      <span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">])</span> <span class="k">return</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span>
      
      <span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">])</span> <span class="k">return</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">callback</span> <span class="o">=&gt;</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">// Mixin for validation</span>
    <span class="kd">const</span> <span class="nx">ValidationMixin</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">addValidator</span><span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">validator</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_validators</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">[</span><span class="nx">field</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">[</span><span class="nx">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">[</span><span class="nx">field</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">validator</span><span class="p">);</span>
      <span class="p">},</span>
      
      <span class="nx">validate</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">)</span> <span class="k">return</span> <span class="p">{</span> <span class="na">valid</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">errors</span><span class="p">:</span> <span class="p">{}</span> <span class="p">};</span>
        
        <span class="kd">const</span> <span class="nx">errors</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="kd">let</span> <span class="nx">valid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">field</span><span class="p">,</span> <span class="nx">validators</span><span class="p">]</span> <span class="k">of</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_validators</span><span class="p">))</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">fieldErrors</span> <span class="o">=</span> <span class="p">[];</span>
          
          <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">validator</span> <span class="k">of</span> <span class="nx">validators</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">validator</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">field</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">fieldErrors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
              <span class="nx">valid</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          
          <span class="k">if</span> <span class="p">(</span><span class="nx">fieldErrors</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">errors</span><span class="p">[</span><span class="nx">field</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fieldErrors</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span> <span class="nx">valid</span><span class="p">,</span> <span class="nx">errors</span> <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="c1">// Combine mixins</span>
    <span class="kd">function</span> <span class="nx">createUser</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">name</span><span class="p">,</span>
        <span class="nx">email</span><span class="p">,</span>
        
        <span class="nx">setName</span><span class="p">(</span><span class="nx">newName</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">oldName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">newName</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">nameChanged</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">oldName</span><span class="p">,</span> <span class="nx">newName</span> <span class="p">});</span>
        <span class="p">},</span>
        
        <span class="nx">setEmail</span><span class="p">(</span><span class="nx">newEmail</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">validation</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span> <span class="na">email</span><span class="p">:</span> <span class="nx">newEmail</span> <span class="p">});</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">validation</span><span class="p">.</span><span class="nx">valid</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Invalid email: </span><span class="p">${</span><span class="nx">validation</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">email</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">, </span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
          <span class="p">}</span>
          
          <span class="kd">const</span> <span class="nx">oldEmail</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">newEmail</span><span class="p">;</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">emailChanged</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">oldEmail</span><span class="p">,</span> <span class="nx">newEmail</span> <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">};</span>
      
      <span class="c1">// Apply mixins</span>
      <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">EventMixin</span><span class="p">,</span> <span class="nx">ValidationMixin</span><span class="p">);</span>
      
      <span class="c1">// Add email validator</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">addValidator</span><span class="p">(</span><span class="dl">'</span><span class="s1">email</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">emailRegex</span> <span class="o">=</span> <span class="sr">/^</span><span class="se">[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+@</span><span class="se">[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+</span><span class="se">\.[^\s</span><span class="sr">@</span><span class="se">]</span><span class="sr">+$/</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">emailRegex</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">Invalid email format</span><span class="dl">'</span><span class="p">;</span>
      <span class="p">});</span>
      
      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">createUser</span><span class="p">(</span><span class="dl">'</span><span class="s1">John Doe</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">john@example.com</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="c1">// Set up event listeners</span>
    <span class="kd">const</span> <span class="nx">events</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">user</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">nameChanged</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">events</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`Name changed from </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">oldName</span><span class="p">}</span><span class="s2"> to </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">newName</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="nx">user</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">emailChanged</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">events</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`Email changed from </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">oldEmail</span><span class="p">}</span><span class="s2"> to </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">newEmail</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="c1">// Test the user object</span>
    <span class="nx">user</span><span class="p">.</span><span class="nx">setName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Jane Doe</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">user</span><span class="p">.</span><span class="nx">setEmail</span><span class="p">(</span><span class="dl">'</span><span class="s1">jane@example.com</span><span class="dl">'</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">user</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span>
      <span class="p">},</span>
      <span class="nx">events</span><span class="p">,</span>
      <span class="na">validation</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span> <span class="na">email</span><span class="p">:</span> <span class="dl">'</span><span class="s1">invalid-email</span><span class="dl">'</span> <span class="p">})</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This comprehensive guide covers the fundamental JavaScript concepts that are crucial for frontend interviews, providing both theoretical understanding and practical implementation examples that demonstrate mastery of the language.</p>

        </div>
    </article>
</div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Study Resources</h3>
                    <p>Comprehensive collection of frontend interview questions, coding challenges, and system design problems.</p>
                </div>
                <div class="footer-section">
                    <h3>Progress Tracking</h3>
                    <p>Monitor your learning journey with detailed progress indicators and completion status.</p>
                </div>
                <div class="footer-section">
                    <h3>Big Tech Ready</h3>
                    <p>Curated content specifically designed for interviews at Google, Meta, Amazon, Apple, and Netflix.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Frontend Interview Hub. Built for aspiring frontend engineers.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/assets/js/app.js"></script>
</body>
</html>